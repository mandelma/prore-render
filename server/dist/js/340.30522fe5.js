"use strict";(self["webpackChunkprore_mongo"]=self["webpackChunkprore_mongo"]||[]).push([[340],{5118:function(e,i,t){var a=t(3396);const s=({message:e})=>null===e?null:(0,a.Wm)("div",{className:"error"},[e]);i.Z=s},340:function(e,i,t){t.r(i),t.d(i,{default:function(){return D}});var a=t(3396),s=t(7139);const n=e=>((0,a.dD)("data-v-b19e6e0e"),e=e(),(0,a.Cn)(),e),l={key:0,class:"spinner-border",role:"status"},o=n((()=>(0,a._)("span",{class:"visually-hidden"},"Loading...",-1))),r=[o],u={key:0},d=n((()=>(0,a._)("br",null,null,-1))),g=n((()=>(0,a._)("br",null,null,-1))),c=n((()=>(0,a._)("br",null,null,-1))),h={key:0},m={key:0},k={key:1};function v(e,i,t,n,o,v){const p=(0,a.up)("MDBBtnClose"),w=(0,a.up)("month-converter"),b=(0,a.up)("warning-message"),f=(0,a.up)("error-message"),R=(0,a.up)("MDBIcon"),y=(0,a.up)("MDBBadge"),M=(0,a.up)("MDBCol"),_=(0,a.up)("MDBRow"),W=(0,a.up)("MDBTextarea"),C=(0,a.up)("MDBBtn"),B=(0,a.up)("MDBContainer");return o.fbc.ordered?((0,a.wg)(),(0,a.j4)(B,{key:1,style:{"padding-top":"50px"}},{default:(0,a.w5)((()=>[(0,a.Wm)(p,{style:{float:"right"},onClick:v.backFromFeedbackClient},null,8,["onClick"]),o.fbc?((0,a.wg)(),(0,a.iD)("h3",u,[(0,a.Uk)("Ajankohta: "),d,(0,a._)("b",null,[(0,a.Wm)(w,{num:o.fbc.onTime[0].month},null,8,["num"]),(0,a.Uk)(" -"+(0,s.zw)(o.fbc.onTime[0].day),1)])])):(0,a.kq)("",!0),(0,a._)("h3",null,[(0,a.Uk)("Tarjottu palvelu: "),g,(0,a._)("b",null,(0,s.zw)(o.fbc.header),1)]),(0,a._)("h4",null,[(0,a.Uk)("Yritys: "),c,(0,a.Uk)(),(0,a._)("b",null,(0,s.zw)(o.fbc.ordered[0].yritys),1)]),(0,a.Wm)(b,{message:o.rateWarning},null,8,["message"]),(0,a.Wm)(f,{message:o.ratingError},null,8,["message"]),(0,a.Wm)(_,null,{default:(0,a.w5)((()=>[(0,a.Wm)(M,{style:{padding:"20px"}},{default:(0,a.w5)((()=>[(0,a.Wm)(_,{class:"rating"},{default:(0,a.w5)((()=>[(0,a.Wm)(M,null,{default:(0,a.w5)((()=>[(0,a.Wm)(R,{style:{padding:"10px",cursor:"pointer"},i:"",class:"far fa-thumbs-up",size:"3x",onClick:v.ratePlus},null,8,["onClick"]),(0,a.Wm)(y,{color:"success",class:"translate-middle p-1",pill:"",notification:""},{default:(0,a.w5)((()=>[(0,a._)("h2",null,(0,s.zw)(o.positiveRating),1)])),_:1})])),_:1}),(0,a.Wm)(M,null,{default:(0,a.w5)((()=>[(0,a.Wm)(R,{style:{padding:"10px",cursor:"pointer"},i:"",class:"far fa-thumbs-up",size:"3x",onClick:v.rateMinus},null,8,["onClick"]),(0,a.Wm)(y,{color:"danger",class:"translate-middle p-1",pill:"",notification:""},{default:(0,a.w5)((()=>[(0,a._)("h2",null,(0,s.zw)(o.negativeRating),1)])),_:1})])),_:1})])),_:1}),o.isRatingGiven?((0,a.wg)(),(0,a.iD)("div",h,[o.isReview?((0,a.wg)(),(0,a.iD)("h2",k,"Arvostelee!")):((0,a.wg)(),(0,a.iD)("h2",m,"Kiitos palautteesta!")),o.isReview?((0,a.wg)(),(0,a.j4)(W,{key:2,style:{"margin-bottom":"20px"},label:"Message",rows:"4",modelValue:o.feedback,"onUpdate:modelValue":i[0]||(i[0]=e=>o.feedback=e)},null,8,["modelValue"])):(0,a.kq)("",!0),(0,a.Wm)(C,{color:"grey",size:"lg",onClick:i[1]||(i[1]=e=>o.isReview=!o.isReview)},{default:(0,a.w5)((()=>[(0,a.Uk)((0,s.zw)(o.isReview?"Poistu arvostelusta":"Kirjoittaa halutessasi arvostelu"),1)])),_:1})])):(0,a.kq)("",!0)])),_:1})])),_:1}),o.isRatingGiven?((0,a.wg)(),(0,a.j4)(C,{key:1,outline:"grey",size:"lg",block:"",onClick:i[2]||(i[2]=e=>v.reload())},{default:(0,a.w5)((()=>[(0,a.Uk)("Muokkaa antamasi palaute!")])),_:1})):(0,a.kq)("",!0),o.isRatingGiven?((0,a.wg)(),(0,a.j4)(C,{key:2,block:"",color:"success",size:"lg",onClick:v.confirmFeedback},{default:(0,a.w5)((()=>[(0,a.Uk)("Lähetää palaute")])),_:1},8,["onClick"])):(0,a.kq)("",!0)])),_:1})):((0,a.wg)(),(0,a.iD)("div",l,r))}t(7658);var p=t(4313),w=t(5253);const b=({message:e})=>null===e?null:(0,a.Wm)("div",{className:"warning"},[e]);var f=b,R=t(5118),y=t(5800),M=t(9398),_=t(4045),W={name:"Feedback",props:{},components:{monthConverter:w.Z,warningMessage:f,errorMessage:R.Z,MDBContainer:p.L5,MDBBtn:p.$v,MDBRow:p.uZ,MDBCol:p.TK,MDBIcon:p.vm,MDBBadge:p.m_,MDBTextarea:p.uj,MDBTable:p.re,MDBBtnClose:p.Ok},data(){return{user:null,fbc:{},isRatingGiven:!1,isReview:!1,ratedTimes:0,isRatedPos:!1,isRatedMinus:!1,positiveRating:0,negativeRating:0,feedback:"",rateWarning:null,ratingError:null}},methods:{reload(){location.reload()},async getClient(e){const i=await y.Z.getOwnBookings(e);console.log("booking client ");const t=i.find((e=>!0===e.isFeedbackClient));this.positiveRating=t.ordered[0].rating.positive,this.negativeRating=t.ordered[0].rating.negative,this.fbc=t},ratePlus(){this.isRated=!0,this.isRatedMinus?(console.log("Not, only one time is allowed!"),this.rateWarning="Arvostella saa vain kerran!",setTimeout((()=>{this.rateWarning=null}),3e3)):(this.ratedTimes+=1,1===this.ratedTimes?(this.positiveRating=this.positiveRating+1,this.isRatingGiven=!0):(console.log("Not, only one time is allowed!"),this.rateWarning="Arvostella saa vain kerran!",setTimeout((()=>{this.rateWarning=null}),3e3)),this.isRatedPlus=!0,this.isRatedMinus=!1)},rateMinus(){this.isRated=!0,this.isRatedPlus?(this.rateWarning="Arvostella saa vain kerran, negatiivisen tai positiivisen!",setTimeout((()=>{this.rateWarning=null}),3e3)):(this.ratedTimes+=1,1===this.ratedTimes?(this.negativeRating=this.negativeRating+1,this.isRatingGiven=!0):(this.rateWarning="Arvostella saa vain kerran, negatiivisen tai positiivisen!",setTimeout((()=>{this.rateWarning=null}),3e3)),this.isRatedPlus=!1,this.isRatedMinus=!0)},async confirmFeedback(){const e=this.fbc.ordered[0].id,i=new Date,t=(0,_.ZP)(i,"dd-mm-yyyy,  HH:MM"),a={pos:t+": "+this.feedback},s={neg:t+": "+this.feedback};this.feedback.length>0&&(this.isRatedPlus&&(await M.Z.addPositiveFeedback(e,a),this.feedback=""),this.isRatedMinus&&(await M.Z.addNegativeFeedback(e,s),this.feedback="")),this.isRatedPlus&&(await M.Z.setPositiveRating(e),this.$emit("isRated",this.fbc.id,"positiivista",this.fbc.ordered[0].yritys),this.$router.push("/")),this.isRatedMinus&&(await M.Z.setNegativeRating(e),this.$emit("isRated",this.fbc.id,"negatiivista",this.fbc.ordered[0].yritys),this.$router.push("/"))},backFromFeedbackClient(){this.$router.go(-1)}},mounted(){const e=window.localStorage.getItem("loggedAppUser");if(e){const i=JSON.parse(e);this.getClient(i.id)}else this.$router.push("/")}},C=t(89);const B=(0,C.Z)(W,[["render",v],["__scopeId","data-v-b19e6e0e"]]);var D=B}}]);
//# sourceMappingURL=340.30522fe5.js.map