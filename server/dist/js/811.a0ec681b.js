"use strict";(self["webpackChunkprore_mongo"]=self["webpackChunkprore_mongo"]||[]).push([[811],{3998:function(e,t){const l=[{label:"Hitsaaja",value:"1"},{label:"Putkimies",value:"2"},{label:"Sähkömies",value:"3"}],a=[{label:"Siivooja",value:"4"}],i=[{group:"Rakennus",options:l},{group:"Kiinteistöala",options:a}];t.Z=i},811:function(e,t,l){l.r(t),l.d(t,{default:function(){return R}});l(7658);var a=l(3396),i=l(9242),o=l(7139);const s=(0,a._)("h3",{style:{"margin-top":"10px"}},"Täytä alla oleva tilaus",-1),n=(0,a._)("h3",{style:{"margin-top":"20px","margin-bottom":"20px"}},"--- TAI ---",-1),d={key:0,style:{"text-align":"left",color:"deepskyblue"}},r={class:"ui form"},u={class:"field"},c=(0,a._)("option",{value:""},"Valitse ammattilainen",-1),g=["label"],p=["value"],m=["value"],h=(0,a._)("option",{value:""},"Valitse ammattilainen",-1),k=["label"],w=["value"],f=["value"],v=(0,a._)("p",{style:{"text-align":"left"}},"Missä ajalla haluaisit ammattilaista?",-1),b={style:{color:"#fff"}},y=["src"],D={key:1,for:"file-upload",class:"custom-file-upload"},_={key:0},I={key:1},x={class:"message-counter"};function B(e,t,l,B,M,C){const F=(0,a.up)("MDBBtnClose"),H=(0,a.up)("MDBCol"),V=(0,a.up)("MDBBtn"),S=(0,a.up)("MDBRow"),U=(0,a.up)("MDBInput"),W=(0,a.up)("VueDatePicker"),j=(0,a.up)("MDBTextarea"),z=(0,a.up)("MDBContainer");return(0,a.wg)(),(0,a.iD)("div",null,[(0,a.Wm)(z,{style:{"padding-top":"70px",position:"relative"}},{default:(0,a.w5)((()=>[(0,a.Wm)(F,{white:"",class:"close_btn",onClick:t[0]||(t[0]=t=>e.$router.go(-1))}),(0,a.Wm)(S,null,{default:(0,a.w5)((()=>[(0,a.Wm)(H,null,{default:(0,a.w5)((()=>[s])),_:1}),(0,a.Wm)(H,null,{default:(0,a.w5)((()=>[n])),_:1}),(0,a.Wm)(H,null,{default:(0,a.w5)((()=>[(0,a.Wm)(V,{outline:"success",block:"",size:"lg",onClick:t[1]||(t[1]=e=>this.$router.push("/recipient-public")),style:{"margin-top":"5px","margin-bottom":"20px"}},{default:(0,a.w5)((()=>[(0,a.Uk)("Etsi kartalta")])),_:1})])),_:1})])),_:1}),(0,a._)("form",{class:"g-3 needs-validation",novalidate:"",onSubmit:t[10]||(t[10]=(0,i.iM)(((...e)=>C.checkForm&&C.checkForm(...e)),["prevent"]))},[(0,a.Wm)(U,{counter:"",maxlength:30,label:"Anna otsikko",white:"",modelValue:M.header,"onUpdate:modelValue":t[2]||(t[2]=e=>M.header=e),id:"header",size:"lg",invalidFeedback:"Ole hyvä ja kirjoita otsikko.",validFeedback:"Ok!",required:"",wrapperClass:"mb-4"},null,8,["modelValue"]),l.recipientBookings.length>0?((0,a.wg)(),(0,a.iD)("p",d,"Osoite: "+(0,o.zw)(l.recipientBookings[0].address),1)):(0,a.kq)("",!0),(0,a.Wm)(U,{label:l.recipientBookings.length>0?"Anna toinen osoitteesi":"Anna osoite",white:"",modelValue:M.address,"onUpdate:modelValue":t[3]||(t[3]=e=>M.address=e),id:"osoite",size:"lg",invalidFeedback:"Ole hyvä ja kirjoita osoite.",validFeedback:"Ok!",required:"",wrapperClass:"mb-4"},null,8,["label","modelValue"]),(0,a._)("div",r,[(0,a._)("div",u,[B.isNotSelected?(0,a.wy)(((0,a.wg)(),(0,a.iD)("select",{key:0,id:"noSelected",style:{"border-color":"red",color:"red","margin-bottom":"20px","background-color":"#221a16"},"onUpdate:modelValue":t[4]||(t[4]=e=>M.professional=e),onChange:t[5]||(t[5]=e=>B.isNotSelected=!1)},[c,((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(M.prodata,(e=>((0,a.wg)(),(0,a.iD)(a.HY,null,[e.group?((0,a.wg)(),(0,a.iD)("optgroup",{label:e.group,key:e.group},[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(e.options,(e=>((0,a.wg)(),(0,a.iD)("option",{value:e.label,key:e.label},(0,o.zw)(e.label),9,p)))),128))],8,g)):((0,a.wg)(),(0,a.iD)("option",{value:e,key:e.value},(0,o.zw)(e.label),9,m))],64)))),256))],544)),[[i.bM,M.professional]]):(0,a.wy)(((0,a.wg)(),(0,a.iD)("select",{key:1,"onUpdate:modelValue":t[6]||(t[6]=e=>M.professional=e),style:{"margin-bottom":"20px","background-color":"#221a16",border:"1px solid #ddd",color:"#ddd"}},[h,((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(M.prodata,(e=>((0,a.wg)(),(0,a.iD)(a.HY,null,[e.group?((0,a.wg)(),(0,a.iD)("optgroup",{label:e.group,key:e.group},[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(e.options,(e=>((0,a.wg)(),(0,a.iD)("option",{value:e.label,key:e.label},(0,o.zw)(e.label),9,w)))),128))],8,k)):((0,a.wg)(),(0,a.iD)("option",{value:e,key:e.value},(0,o.zw)(e.label),9,f))],64)))),256))],512)),[[i.bM,M.professional]])])]),v,(0,a._)("div",b,[(0,a.Wm)(W,{style:{"margin-bottom":"20px"},modelValue:B.date,"onUpdate:modelValue":t[7]||(t[7]=e=>B.date=e),dark:"","min-date":new Date,onInternalModelChange:C.handleInternalDate,state:!M.isNoDate&&null},null,8,["modelValue","min-date","onInternalModelChange","state"])]),(0,a.Wm)(z,{style:{"margin-bottom":"20px"}},{default:(0,a.w5)((()=>[(0,a.Wm)(S,null,{default:(0,a.w5)((()=>[(0,a.Wm)(H,{md:"4"},{default:(0,a.w5)((()=>[B.showImage?((0,a.wg)(),(0,a.iD)("img",{key:0,src:B.showImage,style:{width:"200px","margin-bottom":"20px"},alt:"..."},null,8,y)):(0,a.kq)("",!0),B.isUploaded?(0,a.kq)("",!0):((0,a.wg)(),(0,a.iD)("label",D,[M.value?((0,a.wg)(),(0,a.iD)("span",_," Muokkaa kuva: "+(0,o.zw)(M.value.name),1)):((0,a.wg)(),(0,a.iD)("span",I,"Valitse kuva tehtävästä"))])),(0,a._)("input",{id:"file-upload",type:"file",onChange:t[8]||(t[8]=(...e)=>C.handleFileChange&&C.handleFileChange(...e))},null,32),B.isImageSelected?((0,a.wg)(),(0,a.j4)(V,{key:2,outline:"danger",size:"lg",block:"",onClick:C.removeFile},{default:(0,a.w5)((()=>[(0,a.Uk)("Poista valitsettu kuva")])),_:1},8,["onClick"])):(0,a.kq)("",!0),B.isImageSelected?((0,a.wg)(),(0,a.j4)(V,{key:3,outline:"success",size:"lg",block:"",style:{"margin-bottom":"10px"},onClick:C.uploadImage},{default:(0,a.w5)((()=>[(0,a.Uk)("Lataa valitsettu kuva")])),_:1},8,["onClick"])):(0,a.kq)("",!0)])),_:1}),(0,a.Wm)(H,{md:"8"},{default:(0,a.w5)((()=>[(0,a.Wm)(j,{maxlength:"70",label:"Tehtävän kuvaus...",white:"",rows:"3",modelValue:B.explanation,"onUpdate:modelValue":t[9]||(t[9]=e=>B.explanation=e),invalidFeedback:"Ole hyvä ja kirjoita tehtävän kuvaus.",validFeedback:"Ok!",required:""},null,8,["modelValue"]),(0,a._)("span",x,(0,o.zw)(B.explanation.length)+" / 70",1)])),_:1})])),_:1}),(0,a.Wm)(V,{outline:"success",size:"lg",block:"",onClick:C.addRecipient,style:{"margin-top":"5px","margin-bottom":"20px"},type:"submit"},{default:(0,a.w5)((()=>[(0,a.Uk)("Vahvista tilaus")])),_:1},8,["onClick"])])),_:1})],32)])),_:1})])}l(2062);var M=l(4912),C=l(4313),F=l(5800),H=l(8579),V=l(3998),S=l(68),U=l(4870),W={name:"recipient-form",props:{recipientBookings:Array},components:{MDBBtn:C.$v,MDBContainer:C.L5,MDBInput:C.u2,MDBRow:C.uZ,MDBCol:C.TK,MDBTextarea:C.uj,MDBBtnClose:C.Ok,VueDatePicker:M.Z},data(){return{recipientId:null,header:"",address:null,lat:null,lng:null,isNoDate:!1,professional:"",addFile:null,dateTest:null,calendarTooltips:[],value:null,aaa:"",file:null,f:null,prodata:V.Z}},setup(){const e=(0,U.iH)(null),t=(0,U.iH)(""),l=(0,U.iH)(!1),a=(0,U.iH)(null),i=(0,U.iH)(null),o=(0,U.iH)(!1),s=(0,U.iH)(!1),n=(0,U.iH)(!1);return{date:e,explanation:t,isImageSelected:l,imgId:a,showImage:i,isShowImage:o,isUploaded:s,isNotSelected:n}},computed:{currentRouteName(){return this.$route.name}},async mounted(){const e=window.localStorage.getItem("loggedAppUser");if(e){const t=JSON.parse(e);this.recipientId=t.id,console.log("User id in recipient: "+t.id)}const t={lat:50.064192,lng:-130.605469},l={north:t.lat+.1,south:t.lat-.1,east:t.lng+.1,west:t.lng-.1},a=document.getElementById("osoite"),i={bounds:l,componentRestrictions:{country:"fi"},fields:["address_components","geometry","icon","name","formatted_address"],strictBounds:!1},o=new google.maps.places.Autocomplete(a,i);o.addListener("place_changed",(()=>{let e=o.getPlace();this.lat=e.geometry.location.lat(),this.lng=e.geometry.location.lng(),this.address=e.formatted_address,console.log(e)}))},methods:{cancelRecipientForm(){this.$router.go(-1)},async findRecipients(){const e=await F.Z.getOwnBookings(this.recipientId);console.log("Recipients "+e.length)},async remFile(){await H.Z.remove("644cff805261bf7d9943c5da","644cff875261bf7d9943c5dd")},handleFileChange(e){try{const t=e.target.files[0];console.log("event target client ",e.target.files[0]),t&&(this.showImage=URL.createObjectURL(t),this.file=e.target.files[0])}catch(t){console.log("Error:",t)}this.value=e.target.files[0],e.target.files[0]?this.isImageSelected=!0:this.isImageSelected=!1},async uploadImage(){const e=new FormData;e.append("file",this.file,this.file.name);const t=await H.Z.create(e);t&&(this.imgId=t.imgCreated._id,this.file=null,this.isImageSelected=!1,this.isUploaded=!0)},removeFile(){this.value=null,this.isImageSelected=!1,this.showImage=null},formatDate(e=Date){return e?(0,S.Z)(e,"dd.MM.yyyy, HH:mm"):null},backToDashboard(){},getDate(){console.log("selected date: "+this.date.getDate())},handleInternalDate(){console.log("Handled"),this.isNoDate=!1},async addRecipient(){let e;if(null===this.address&&(this.address=this.recipientBookings[0].address,this.lat=this.recipientBookings[0].latitude,this.lng=this.recipientBookings[0].longitude),""===this.professional&&(this.isNotSelected=!0),this.date||(this.isNoDate=!0),this.date){let t=this.date.getFullYear(),l=this.date.getMonth(),a=this.date.getDate(),i=this.date.getHours(),o=this.date.getMinutes();const s=new Date(t,l,a,i,o).getTime();e={created:this.date,created_ms:s,header:this.header,address:this.address,latitude:this.lat,longitude:this.lng,professional:this.professional,year:this.date.getFullYear(),month:this.date.getMonth(),day:this.date.getDate(),hours:this.date.getHours(),minutes:this.date.getMinutes(),description:this.explanation,imageId:this.imgId}}if(this.header&&this.address&&this.professional&&this.date&&this.explanation){const t=await F.Z.addRecipient(this.recipientId,e);this.$emit("booking:update",t),console.log("Booking--- "+t),this.$router.push("/received")}else console.log("Something went wrong"),console.log("Aadress "+this.address),console.log("header "+this.header),console.log("Explanation "+this.explanation),console.log("Profession "+this.professional),console.log("Date "+this.date)},checkForm(e=Event){e.target.classList.add("was-validated")}}},j=l(89);const z=(0,j.Z)(W,[["render",B]]);var R=z}}]);
//# sourceMappingURL=811.a0ec681b.js.map