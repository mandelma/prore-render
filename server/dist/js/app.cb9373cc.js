(function(){var e={5253:function(e,t){"use strict";const s=({num:e})=>{let t="";switch(5===e&&(t="Mis siis"),e){case 0:t="Tammikuu";break;case 1:t="Helmikuu";break;case 2:t="Maaliskuu";break;case 3:t="Huhtikuu";break;case 4:t="Toukokuu";break;case 5:t="Kesäkuu";break;case 6:t="Heinäkuu";break;case 7:t="Elokuu";break;case 8:t="Syyskuu";break;case 9:t="Lokakuu";break;case 10:t="Maaliskuu";break;case 11:t="Joulukuu";break}return t};t.Z=s},8033:function(e,t,s){"use strict";var n=s(3396);const o=({message:e})=>null===e?null:(0,n.Wm)("div",{className:"success"},[e]);t.Z=o},3635:function(e,t,s){"use strict";var n=s(9242),o=s(3396),i=s(7139);const a={style:{"font-size":"12px",padding:"5px"}},r=["src"],l={style:{"font-size":"12px",padding:"5px"}},c={class:"pill"},u=["src"],d=(0,o._)("p",{class:"user"},"Log out",-1);function g(e,t,n,g,m,p){const h=(0,o.up)("MDBNavbarBrand"),f=(0,o.up)("router-link"),k=(0,o.up)("MDBNavbarNav"),v=(0,o.up)("MDBNavbarItem"),w=(0,o.up)("MDBIcon"),b=(0,o.up)("MDBBadge"),y=(0,o.up)("MDBDropdownToggle"),B=(0,o.up)("MDBDropdownItem"),D=(0,o.up)("MDBDropdownMenu"),I=(0,o.up)("MDBDropdown"),U=(0,o.up)("month-converter"),C=(0,o.up)("MDBNavbar"),S=(0,o.up)("Notifications"),M=(0,o.up)("success-message"),_=(0,o.up)("router-view");return(0,o.wg)(),(0,o.iD)(o.HY,null,[(0,o.Wm)(C,{size:"large",position:"top",container:"",expand:"xl",bg:"light",class:"d-flex justify-content-between"},{default:(0,o.w5)((()=>[(0,o.Wm)(f,{to:"/",onClick:p.onPressedLogoBtn},{default:(0,o.w5)((()=>[(0,o.Wm)(h,null,{default:(0,o.w5)((()=>[(0,o.Uk)(" Prokeikkatori ")])),_:1})])),_:1},8,["onClick"]),void 0!==m.loggedUser.token&&m.userIsProvider?((0,o.wg)(),(0,o.j4)(k,{key:0,left:"",class:"mb-2 mb-lg-0"})):(0,o.kq)("",!0),void 0===m.loggedUser.token?((0,o.wg)(),(0,o.j4)(k,{key:1,right:"",class:"mb-2 mb-lg-0 d-flex flex-row"},{default:(0,o.w5)((()=>[(0,o.Wm)(v,null,{default:(0,o.w5)((()=>[(0,o.Wm)(f,{to:"/login",onClick:t[0]||(t[0]=e=>g.collapse7=!1)},{default:(0,o.w5)((()=>[(0,o.Uk)("Kirjaudu")])),_:1})])),_:1})])),_:1})):((0,o.wg)(),(0,o.j4)(k,{key:2,right:"",class:"mb-2 mb-lg-0 d-flex flex-row"},{default:(0,o.w5)((()=>[m.chatParticipants.length>0?((0,o.wg)(),(0,o.j4)(I,{key:0,modelValue:g.dropDownChat,"onUpdate:modelValue":t[2]||(t[2]=e=>g.dropDownChat=e),style:{padding:"10px"}},{default:(0,o.w5)((()=>[(0,o.Wm)(y,{tag:"a",class:"nav-link",style:{padding:"20px"},onClick:t[1]||(t[1]=e=>g.dropDownChat=!g.dropDownChat)},{default:(0,o.w5)((()=>[(0,o.Wm)(w,{icon:"comments",size:"2x"}),m.newMessageList.length>0?((0,o.wg)(),(0,o.j4)(b,{key:0,class:"translate-middle p-1",pill:"",notification:"",color:"danger"},{default:(0,o.w5)((()=>[(0,o._)("span",a,(0,i.zw)(m.newMessageList.length),1)])),_:1})):(0,o.kq)("",!0)])),_:1}),(0,o.Wm)(D,null,{default:(0,o.w5)((()=>[(0,o._)("div",null,[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(m.chatParticipants,((e,t)=>((0,o.wg)(),(0,o.j4)(B,{href:"#",key:t},{default:(0,o.w5)((()=>[(0,o.Wm)(f,{to:"/chat",onClick:t=>p.updateRoom(e),style:{"font-size":"17px"},class:(0,i.C_)({"new-message":m.newMessageList.some((t=>t.userID===e.userID))})},{default:(0,o.w5)((()=>[(0,o.Uk)((0,i.zw)(m.newMessageList.some((t=>t.userID===e.userID))?e.name+"  !":e.name),1)])),_:2},1032,["onClick","class"])])),_:2},1024)))),128))])])),_:1})])),_:1},8,["modelValue"])):(0,o.kq)("",!0),m.recipientCompletedBookings.length>0?((0,o.wg)(),(0,o.j4)(I,{key:1,modelValue:g.dropDownfeedback,"onUpdate:modelValue":t[4]||(t[4]=e=>g.dropDownfeedback=e),style:{padding:"5px"}},{default:(0,o.w5)((()=>[(0,o.Wm)(y,{tag:"a",class:"nav-link",style:{padding:"20px"},onClick:t[3]||(t[3]=e=>g.dropDownfeedback=!g.dropDownfeedback)},{default:(0,o.w5)((()=>[(0,o._)("img",{style:{width:"45px"},src:s(5840),alt:"palaute"},null,8,r),(0,o.Wm)(b,{class:"translate-middle p-1",pill:"",notification:"",color:"danger"},{default:(0,o.w5)((()=>[(0,o._)("span",l,(0,i.zw)(m.recipientCompletedBookings.length),1)])),_:1})])),_:1}),(0,o.Wm)(D,null,{default:(0,o.w5)((()=>[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(m.recipientCompletedBookings,((e,t)=>((0,o.wg)(),(0,o.j4)(B,{href:"#",key:t},{default:(0,o.w5)((()=>[(0,o.Wm)(f,{to:"/feedback",onClick:t=>p.handleFeedbackClient(e)},{default:(0,o.w5)((()=>[(0,o.Wm)(U,{num:e.onTime[0].month},null,8,["num"]),(0,o.Uk)(" /"+(0,i.zw)(e.onTime[0].day)+" -"+(0,i.zw)(e.ordered[0].yritys)+" : "+(0,i.zw)(e.header),1)])),_:2},1032,["onClick"])])),_:2},1024)))),128))])),_:1})])),_:1},8,["modelValue"])):(0,o.kq)("",!0),m.providerBookings.length>0?((0,o.wg)(),(0,o.j4)(v,{key:2,to:"/notification",class:"me-3 me-lg-0",linkClass:"link-secondary",style:{padding:"10px"}},{default:(0,o.w5)((()=>[(0,o.Wm)(w,{icon:"bell",size:"2x",disabled:!0,onClick:p.handleNotifications},null,8,["onClick"]),m.notSeenClientBookings.length>0?((0,o.wg)(),(0,o.j4)(b,{key:0,notification:"",color:"danger",class:"translate-middle p-1",onClick:p.handleNotifications,pill:""},{default:(0,o.w5)((()=>[(0,o._)("span",c,(0,i.zw)(m.notSeenClientBookings.length),1)])),_:1},8,["onClick"])):((0,o.wg)(),(0,o.j4)(b,{key:1,notification:"",color:"danger",class:"translate-middle p-2",pill:""}))])),_:1})):(0,o.kq)("",!0),(0,o.Wm)(I,{modelValue:g.dropdownUser,"onUpdate:modelValue":t[6]||(t[6]=e=>g.dropdownUser=e),style:{padding:"10px"},onClick:p.onPressedUserIcon},{default:(0,o.w5)((()=>[(0,o.Wm)(y,{tag:"a",class:"nav-link",onClick:t[5]||(t[5]=e=>g.dropdownUser=!g.dropdownUser)},{default:(0,o.w5)((()=>[(0,o._)("img",{style:{width:"50px",height:"50px",border:"solid grey","border-radius":"50%"},src:m.showAvatar?m.showAvatar:s(2519)(`./${m.avatar.name}`),alt:"user_avatar"},null,8,u)])),_:1}),(0,o.Wm)(D,null,{default:(0,o.w5)((()=>[m.userIsProvider||m.recipientBookings.length>0?((0,o.wg)(),(0,o.j4)(B,{key:0,href:"#"},{default:(0,o.w5)((()=>[(0,o.Wm)(f,{to:"/profile",class:"user"},{default:(0,o.w5)((()=>[(0,o.Uk)(" Omat tiedot ")])),_:1})])),_:1})):(0,o.kq)("",!0),m.recipientBookings.length>0?((0,o.wg)(),(0,o.j4)(B,{key:1,href:"#"},{default:(0,o.w5)((()=>[(0,o.Wm)(f,{to:"/history",class:"user"},{default:(0,o.w5)((()=>[(0,o.Uk)(" Historia ")])),_:1})])),_:1})):(0,o.kq)("",!0),m.userIsProvider?((0,o.wg)(),(0,o.j4)(B,{key:2,href:"#"},{default:(0,o.w5)((()=>[(0,o.Wm)(f,{to:"/pay-plan",class:"user"},{default:(0,o.w5)((()=>[(0,o.Uk)(" Laskutus ")])),_:1})])),_:1})):(0,o.kq)("",!0),(0,o.Wm)(B,{href:"#"},{default:(0,o.w5)((()=>[(0,o.Wm)(f,{to:"/rules",class:"user"},{default:(0,o.w5)((()=>[(0,o.Uk)(" Säännöt ")])),_:1})])),_:1}),(0,o.Wm)(B,{href:"#",onClick:p.handleLogOut},{default:(0,o.w5)((()=>[d])),_:1},8,["onClick"])])),_:1})])),_:1},8,["modelValue","onClick"])])),_:1}))])),_:1}),m.isNotification?((0,o.wg)(),(0,o.j4)(S,{key:0,"onExit:notifications":p.handleExitNotifications,"onUpdate:status":p.handleStatusUpdate,bookings:m.providerBookings},null,8,["onExit:notifications","onUpdate:status","bookings"])):(0,o.kq)("",!0),(0,o.Wm)(M,{style:{padding:"20px"},message:m.ratingResult},null,8,["message"]),(0,o.Wm)(_,{test:p.test,"onLogin:data":p.handleLogin,"onRegister:data":p.createUser,userIsProvider:m.userIsProvider,loggedInUser:m.loggedUser,recipientBookings:m.recipientBookings,confirmedBookingsByClient:m.clientAcceptedBookings,confirmedBookingsByProvider:m.providerAcceptedBookings,"onBooking:update":p.handleRecipientBookingsUpdate,"onExit:notifications":p.handleExitNotifications,"onUpdate:status":p.handleStatusUpdate,"onRemove:booking":p.handleRemoveBooking,"onActivate:bell":p.handleActivateBell,"onDeactivate:bell":p.handleDeActivateBell,bookings:m.providerBookings,bookingsConfirmed:m.providerBookingsHistory,recipientConfirmedBookings:m.recipientCompletedBookings,feedbackClient:m.feedbackClient,onIsRated:p.handleRated,onBackFromFeedback:e.handleBackFromFeedbackClient,"onTo:app":p.fromFinal,onFinalinfo:p.fromFinal,onChatCredentials:p.handleChat,chatusers:m.users,activeUser:m.activeUser,messages:m.conversation,newMessageRoom:m.newMessageRoom,provider:m.userIsProvider,recipient:m.recipientBookings,"onSelect:user":p.onSelectUser,onNoSelected:p.noSelectUser,selecteduser:m.selectedUser,"onOn:message":p.handleMessage,onOtherUser:e.otherUser,onBookingWaitingProBack:p.handleBookingWaitingProBackBtn,onUpdateAvatar:p.handleUpdateAvatar,onRemoveAvatar:p.handleRemoveAvatar,"recipient-test":m.recipientTest,onSetNavbarChatUser:p.handleSetNavbarChatUser,onSetNavbarFeedbackNotification:p.handleSetNavbarFeedback,wentOut:p.wentOut},null,8,["test","onLogin:data","onRegister:data","userIsProvider","loggedInUser","recipientBookings","confirmedBookingsByClient","confirmedBookingsByProvider","onBooking:update","onExit:notifications","onUpdate:status","onRemove:booking","onActivate:bell","onDeactivate:bell","bookings","bookingsConfirmed","recipientConfirmedBookings","feedbackClient","onIsRated","onBackFromFeedback","onTo:app","onFinalinfo","onChatCredentials","chatusers","activeUser","messages","newMessageRoom","provider","recipient","onSelect:user","onNoSelected","selecteduser","onOn:message","onOtherUser","onBookingWaitingProBack","onUpdateAvatar","onRemoveAvatar","recipient-test","onSetNavbarChatUser","onSetNavbarFeedbackNotification","wentOut"])],64)}s(7658);var m=s(3109),p=s(1478),h=s(9398),f=s(5800),k=s(6823);const v=s(7218),w="/api/chatmessages",b=()=>{const e=v.get(w);return e.data},y=(e,t)=>{const s=v.put(`${w}/${e}`,t);return s.data};var B={getMessages:b,editStatus:y},D=s(5253),I=s(8033);const U=async()=>{const e=window.localStorage.getItem("loggedAppUser");if(e){console.log("Tooooken 0 "+e);const t=JSON.parse(e).token,s=await k.Z.verifyToken(t);return!s}};var C={validation:U},S=s(7416),M=s(4837),_=s(4313),x=s(4870),$=s(4058);const P=e=>{e.hasNewMessages=!1,e.messages=[]};var Z={name:"App",props:{},components:{User:S.Z,MessagePanel:M.Z,Notifications:m["default"],monthConverter:D.Z,successMessage:I.Z,MDBNavbar:_.A0,MDBCollapse:_.Eq,MDBNavbarItem:_.V$,MDBNavbarBrand:_.JI,MDBNavbarNav:_.T2,MDBNavbarToggler:_.$Y,MDBBadge:_.m_,MDBIcon:_.vm,MDBBtn:_.$v,MDBDropdown:_.H6,MDBDropdownToggle:_.CU,MDBDropdownMenu:_.Ed,MDBDropdownItem:_.i2},data(){return{chatParticipants:[],test:!1,recipientTest:null,credit:0,testDialog:["eka","toka","pipi"],counter:null,user:null,isNewMessage:!0,messageInfo:"",newMessageList:[],feedbackClient:{},ratingResult:null,newMessageRoom:"",tu:[],roomroom:"",userSocketID:"",info:"",users:[],currentRoom:"",messages:[],conversation:[],selectedUser:null,activeUser:null,msg:"",isBell:!1,loggedUser:{},recipientBookings:[],clientAcceptedBookings:[],providerAcceptedBookings:[],userIsProvider:null,providerBookings:[],providerBookingsHistory:[],recipientCompletedBookings:[],isNotification:!1,notSeenClientBookings:[],avatar:{name:"avatar.png"},showAvatar:null,newMessage:"",otheruser:{}}},created(){},async mounted(){this.validateToken();const e=window.localStorage.getItem("loggedAppUser");if(e){const t=JSON.parse(e);this.user=t;const s=t.username,n=t.id;this.currentRoom=t.username+t.id,this.joinServer(s,n)}},setup(){const e=(0,x.iH)(!1),t=(0,x.iH)(!1),s=(0,x.iH)(!1),n=(0,x.iH)(!1),o=(0,x.iH)(!1),i=(0,x.iH)(!1);return{collapse7:e,dropDownDialog:t,dropDownChat:s,dropdownUser:n,dropdownBell:o,dropDownfeedback:i}},methods:{wentOut(){console.log("Went................")},isSameId(e,t){return e.value===t.value},comp(){console.log("Comparing"),console.log("xxx--xxx "+this.chatParticipants.map((e=>e.name))),console.log("yyyy---yyyy "+this.newMessageList.map((e=>e.userID)));const e=[{value:"4a55eff3-1e0d-4a81-9105-3ddd7521d642",display:"Jamsheer"},{value:"644838b3-604d-4899-8b78-09e4799f586f",display:"Muhammed"},{value:"b6ee537a-375c-45bd-b9d4-4dd84a75041d",display:"Ravi"},{value:"e97339e1-939d-47ab-974c-1b68c9cfb536",display:"Ajmal"},{value:"a63a6f77-c637-454e-abf2-dfb9b543af6c",display:"Ryan"}],t=[{value:"4a55eff3-1e0d-4a81-9105-3ddd7521d642",display:"Jamsheer",$$hashKey:"008"},{value:"644838b3-604d-4899-8b78-09e4799f586f",display:"Muhammed",$$hashKey:"009"},{value:"b6ee537a-375c-45bd-b9d4-4dd84a75041d",display:"Ravi",$$hashKey:"00A"},{value:"e97339e1-939d-47ab-974c-1b68c9cfb536",display:"Ajmal",$$hashKey:"00B"}],s=e.filter((({value:e})=>t.some((({value:t})=>t===e))));console.log("results "+s.length),e.forEach(((e,t)=>{}))},startChat(){$.Z.emit("join all rooms")},chat(){console.log("Clicked to chat")},handleUpdateAvatar(e){console.log("Avatar in app is------------- "+e),this.showAvatar=e},handleRemoveAvatar(){this.avatar={name:"avatar.png"},this.showAvatar=null},handleChat(e){console.log("Chat data: "+e.room+" "+e.userID+" "+e.username),this.roomroom=e.room,this.currentRoom=e.room,console.log("Tuba "+this.roomroom),$.Z.emit("update room",e.room)},fromFinal(e){this.info=e,console.log("Data from final in app: "+e)},submit(e,t,s){console.log("What===");let n={userID:e,username:t,room:s};$.Z.emit("new chat user",n)},joinServer:function(e,t){console.log("Joining server: "+e+" ja id: "+t),$.Z.on("get socketID",(e=>{console.log("user socket id "+e),this.userSocketID=e})),$.Z.on("get current credentials",(()=>{$.Z.emit("current credentials",{room:this.currentRoom,userID:t,username:e})})),$.Z.on("loggedIn",(e=>{this.users=[],e.users.forEach((e=>{for(let t=0;t<this.users.length;t++){const s=this.users[t];if(s.userID===e.userID)return void(s.connected=e.connected)}e.self=e.userID===this.loggedUser.id,e.self||(this.activeUser=e),P(e),e.messages=[],this.users.push(e)})),this.users.sort(((e,t)=>e.self?-1:t.self?1:e.username<t.username?-1:e.username>t.username?1:0)),console.log("Room users: "+e.users.map((e=>e.username)))})),this.listen()},listen:function(){$.Z.on("user info",(e=>{})),$.Z.on("init new messages",(e=>{e.forEach((e=>{"unsent"===e.status&&(console.log("You got a new message "+e.content),this.newMessageList.push(e))}))})),$.Z.on("userOnline",(e=>{this.users=[],$.Z.on("get socketID",(e=>{console.log("user socket id "+e),this.userSocketId=e})),e.users.forEach((e=>{for(let t=0;t<this.users.length;t++){const s=this.users[t];if(s.userID===e.userID)return s.connected=e.connected,void console.log("xxxxxxxxxxxxxxxxxxxxxxxxxxxx")}e.self=e.userID===this.loggedUser.id,e.self||(this.selectedUser=e),this.initReactiveProperties(e),e.messages=[],this.users.push(e)})),this.users.sort(((e,t)=>e.self?-1:t.self?1:e.username<t.username?-1:e.username>t.username?1:0))})),$.Z.on("userLeft",((e,t,s)=>{console.log("User left "+e,t,s);for(let n=0;n<this.users.length;n++){const t=this.users[n];if(t.userID===e){t.connected=!1;break}}})),$.Z.on("new message",(e=>{this.newMessageRoom=e.room,console.log("Current room "+this.currentRoom),console.log("Data room "+e.room),null!==this.selectedUser&&this.selectedUser.room===e.room||this.newMessageList.some((t=>t.username===e.username))||(this.newMessageList.push(e),console.log("Neeeeew messageeeee "))})),$.Z.on("accept provider",(({id:e,booking:t})=>{this.providerBookings.push(t),this.notSeenClientBookings.push(t)})),$.Z.on("accept recipient",(({id:e,booking:t})=>{const s=this.recipientBookings.find((e=>e.id===t.id));console.log("FoundbOject status = "+s.header+" "+s.status),s.status="confirmed",console.log("FoundObject status after = "+s.header+" "+s.status),this.recipientBookings=this.recipientBookings.filter((e=>e.id!==t.id)),this.providerAcceptedBookings.push(s)})),$.Z.emit("online",this.currentRoom),$.Z.on("messages",(e=>{this.conversation=e.msg})),$.Z.on("private message",(({content:e,username:t,date:s,from:n,to:o})=>{this.test=!0,$.Z.on("messages",(e=>{this.conversation=e.msg}));for(let i=0;i<this.users.length;i++){const a=this.users[i],r=this.userSocketId===n;if(a.userID===(r?o:n)){this.conversation.push({content:e,username:t,date:s,userID:a.userID,fromSelf:r}),a.messages.push({content:e,date:s,fromSelf:r}),a!==this.selectedUser&&(a.hasNewMessages=!0,this.messageSeen=!0);break}}}))},initReactiveProperties(e){e.hasNewMessages=!1,e.messages=[]},onSelectUser(e){e.self||(this.selectedUser=e),console.log("----------Tuleb läbi--------"+e.username),this.isNewMessage=!1,e.hasNewMessages=!1,this.messageInfo=""},noSelectUser(){this.selectedUser=null},handleMessage(e,t){this.conversation.push({content:e,username:this.loggedUser.username,date:t,user:this.loggedUser.username,userID:this.loggedUser.id}),$.Z.emit("private message",{content:e,date:t,to:this.selectedUser.userID})},handleProviderActionConfirm(){},updateUserRoom(e){console.log("Message is "+e.id);for(let t=0;t<this.users.length;t++){let e=this.users[t];e.self||(this.selectedUser=e)}e.inline||B.editStatus(e.id,{status:"sent"}),this.newMessageList=this.newMessageList.filter((t=>t.id!==e.id)),$.Z.emit("update room",e.room)},async handleFeedbackClient(e){console.log("Feedback client is "+e.id),this.feedbackClient=e;const t={isFeedbackClient:!0},s=await f.Z.feedbackClient(e.id,t);console.log("Feedback "+s)},handleRated(e,t,s){this.recipientCompletedBookings=this.recipientCompletedBookings.filter((t=>t.id!==e)),this.ratingResult=`Olet antanut ${t} palautetta yritykselle - ${s}`,setTimeout((()=>{this.ratingResult=null}),3e3)},onPressedLogoBtn(){this.selectedUser=null},onPressedUserIcon(){this.selectedUser=null},updateRoom(e){this.newMessageList.length,this.newMessageList.forEach((t=>{t.inline||B.editStatus(t.id,{status:"sent"}),this.newMessageList=this.newMessageList.filter((t=>t.userID!==e.userID))})),$.Z.emit("update room",e.room)},handleNewMessageNotification(){$.Z.emit("update room",this.newMessageRoom)},handleActivateBell(e){console.log("Bell bell bell "+e)},handleDeActivateBell(){},profile(){this.$router.push("/profile"),console.log("Pressed profile")},history(){this.$router.push("/history")},renderPage(){this.$router.push({path:"/chat"}).then((()=>{this.$router.go()}))},renderDialogPage(){this.$router.push({path:"/dialog"}).then((()=>{this.$router.go()}))},reload:()=>{(void 0).isRouterAlive=!1,setTimeout((()=>{(void 0).isRouterAlive=!0}),0)},async getUsers(){this.users=await p.Z.getAll()},async createUser(e){console.log("User name is here: "+e.username),this.submit(e.id,e.username,e.username+e.id),window.localStorage.setItem("loggedAppUser",JSON.stringify(e)),this.loggedUser=e,window.location.replace("/")},async handleLogin(e){console.log("userdata: "+e.username),window.localStorage.setItem("loggedAppUser",JSON.stringify(e)),this.loggedUser=e,this.validateToken();e.username,e.id;this.$route.query.redirect?this.$router.push(this.$route.query.redirect):window.location.replace("/")},handleLogOut(){window.localStorage.removeItem("loggedAppUser"),this.loginUser="",this.loggedUser="",this.selectedUser=null,$.Z.emit("user leave"),this.$router.push("/")},handleSetNavbarChatUser(e){console.log("Navbar chat user username "+e.name),this.chatParticipants.some((t=>t.userID===e.userID))||this.chatParticipants.push(e)},handleSetNavbarFeedback(e){console.log("Feedback booking "+e.header),this.recipientCompletedBookings.push(e)},async handleProvider(){this.chatParticipants=[],this.userIsProvider=await h.Z.getProvider(this.loggedUser.id),this.userIsProvider&&(this.userIsProvider.user.avatar?(console.log("provider user avatar is "+this.userIsProvider.user.avatar.name),this.avatar=this.userIsProvider.user.avatar):console.log("No avatar is included"),console.log("User credit "+this.userIsProvider.credit),this.credit=this.userIsProvider.credit,this.providerBookings=this.userIsProvider.booking.filter((e=>"confirmed"!==e.status&&"waiting"!==e.status&&"completed"!==e.status)),this.providerBookingsHistory=this.userIsProvider.booking.filter((e=>"confirmed"===e.status)),this.userIsProvider.room.forEach((e=>{this.chatParticipants.some((t=>t.userID===e.userID))||this.chatParticipants.push({status:"pro",userID:e.userID,name:e.client,room:e.room})}))),this.notSeenClientBookings=this.providerBookings.filter((e=>"notSeen"===e.status)),this.providerBookings.forEach((e=>{e.status})),console.log("xxxxxxxxxxx len "+this.notSeenClientBookings.length)},async handleRecipientBookings(){this.chatParticipants=[];let e=await f.Z.getOwnBookings(this.loggedUser.id);if(e.length>0){e[0].user.avatar&&(this.avatar=e[0].user.avatar),this.providerAcceptedBookings=e.filter((e=>"confirmed"===e.status)),this.clientAcceptedBookings=e.filter((e=>"notSeen"===e.status||"seen"===e.status)),this.recipientCompletedBookings=e.filter((e=>"completed"===e.status));let t=e.filter((e=>"completed"!==e.status));this.recipientBookings=e.filter((e=>"confirmed"!==e.status&&"completed"!==e.status)),t.forEach((e=>{if(e.ordered.length>0){let t=e.ordered[0].user.username;console.log("Pro "+t),this.chatParticipants.some((t=>t.userID===e.ordered[0].user.id))||this.chatParticipants.push({status:"client",userID:e.ordered[0].user.id,name:e.ordered[0].yritys,room:e.ordered[0].room[0].room})}}))}},handleRecipientBookingsUpdate(e){this.recipientBookings=this.recipientBookings.concat(e)},handleNotifications(){this.$router.push("/notification")},handleBookingWaitingProBackBtn(){this.selectedUser=null},handleExitNotifications(e){console.log("State is: "+e),this.isNotification=e},handleStatusUpdate(e){this.notSeenClientBookings=this.notSeenClientBookings.filter((t=>t.id!==e?t:null)),this.handleProvider()},handleRemoveBooking(e){console.log("Handling remove booking..."+e),this.providerBookings=this.providerBookings.filter((t=>t.id!==e))},test(){console.log("xxxx "+C)},async validateToken(){const e=window.localStorage.getItem("loggedAppUser");if(e){const t=JSON.parse(e),s=await k.Z.verifyToken(t.token);"token expired"===s.result?(window.localStorage.removeItem("loggedAppUser"),this.loggedUser="",this.selectedUser=null,$.Z.emit("user leave")):(this.loggedUser=t,console.log("Loged, logged user "+this.loggedUser.username),this.handleRecipientBookings(),this.handleProvider())}},runEveryMinite(){alert("The minute has passed!!")}},beforeUnmount(){$.Z.emit("user leave"),this.selectedUser=null},unmounted(){},computed:{isValid(){return this.msg.length>0}}},O=s(89);const N=(0,O.Z)(Z,[["render",g]]);var A=N,j=s(2483);const R=[{path:"/admin",name:"admin-panel",component:()=>s.e(373).then(s.bind(s,7373))},{path:"/",name:"dash-board",component:()=>s.e(744).then(s.bind(s,6744))},{path:"/register",name:"app-register",component:()=>s.e(798).then(s.bind(s,4798))},{path:"/login",name:"login-register",component:()=>s.e(434).then(s.bind(s,7434))},{path:"/profile",name:"user-profile",component:()=>s.e(127).then(s.bind(s,1127))},{path:"/pay-plan",name:"pay-plan",component:()=>s.e(737).then(s.bind(s,1737))},{path:"/rules",name:"rules",component:()=>s.e(837).then(s.bind(s,7837))},{path:"/recipient-public",name:"recipient-public",component:()=>Promise.all([s.e(161),s.e(8)]).then(s.bind(s,2008))},{path:"/recipient-form",name:"recipient-form",component:()=>s.e(276).then(s.bind(s,8276)),props:!0,beforeEnter:async(e,t,s)=>{const n=window.localStorage.getItem("loggedAppUser"),o=JSON.parse(n),i=await f.Z.getOwnBookings(o.id);if(i.length>0)return s("/received");s()},meta:{requiresAuth:!0}},{path:"/received",name:"recipient-panel",component:()=>Promise.all([s.e(422),s.e(482)]).then(s.bind(s,2740))},{path:"/recipient-result",name:"recipient-result",component:()=>Promise.all([s.e(422),s.e(466)]).then(s.bind(s,5422))},{path:"/received-final/:data",name:"recipient-final",component:()=>s.e(165).then(s.bind(s,2165)),props:!0},{path:"/rf",name:"r-form",component:()=>s.e(276).then(s.bind(s,8276))},{path:"/provider-public",name:"provider-public",component:()=>Promise.all([s.e(161),s.e(598)]).then(s.bind(s,7598)),beforeEnter:async(e,t,s)=>{const n=window.localStorage.getItem("loggedAppUser");if(!n)return s();{const e=JSON.parse(n),t=await h.Z.getProvider(e.id);if(t)return s("/provider-panel");s()}}},{path:"/provider-form",name:"provider-form",component:()=>Promise.all([s.e(161),s.e(414)]).then(s.bind(s,1414)),beforeEnter:async(e,t,s)=>{const n=window.localStorage.getItem("loggedAppUser"),o=JSON.parse(n),i=await h.Z.getProvider(o.id);if(i)return s("/provider-panel");s()}},{path:"/provider-panel",name:"provider-panel",component:()=>s.e(216).then(s.bind(s,6216)),props:!0},{path:"/location",name:"user-location",component:()=>Promise.all([s.e(161),s.e(320)]).then(s.bind(s,6320))},{path:"/notification",name:"client-notifications",component:()=>Promise.resolve().then(s.bind(s,3109))},{path:"/chat",name:"live-chat",component:()=>Promise.resolve().then(s.bind(s,17))},{path:"/history",name:"user-history",component:()=>s.e(351).then(s.bind(s,4351))},{path:"/feedback",name:"Feedback",component:()=>s.e(136).then(s.bind(s,8136))}],T=["recipient-form","provider-form"],E=(0,j.p7)({history:(0,j.r5)(),routes:R});E.beforeEach((async(e,t,s)=>{const n=window.localStorage.getItem("loggedAppUser");if(n){JSON.parse(n)}const o=T.includes(e.name);o&&!n?s({path:"/login",query:{redirect:e.fullPath}}):s()}));var W=E,L=s(4912),F=s(3852);(0,n.ri)(A).component("VueDatePicker",L.Z),(0,n.ri)(A).use(W).use(F.ZP).mount("#app")},6823:function(e,t,s){"use strict";const n=s(7218),o="/api/login",i=async e=>{const t=await n.post(o,e);return t.data},a=async e=>{const t=await n.post(`${o}/${e}`);return t.data};t.Z={login:i,verifyToken:a}},9398:function(e,t,s){"use strict";const n=s(7218),o="/api/providers",i=async()=>{const e=await n.get(o);return e.data},a=async e=>{const t=await n.get(`${o}/${e}`);return t.data},r=async e=>{const t=await n.get(`${o}/${e}/by-provider-id`);return t.data},l=async e=>{const t=await n.post(`${o}/profession`,e);return t.data},c=async(e,t)=>{const s=await n.post(`${o}/${e}`,t);return s.data},u=async(e,t)=>{const s=await n.post(`${o}/${e}/addRoom`,t);return s.data},d=async(e,t)=>{const s=await n.put(`${o}/${e}/editAddress`,t);return s.data},g=async(e,t)=>{const s=await n.put(`${o}/${e}/editProfession`,t);return s.data},m=async(e,t)=>{const s=await n.post(`${o}/${e}/addProfession`,t);return s.data},p=async(e,t)=>{const s=await n.put(`${o}/${e}/removeProfession`,t);return s.data},h=async(e,t)=>{const s=await n.post(`${o}/${e}/addRecipient/${t}`);return s.data},f=async(e,t)=>{const s=await n.put(`${o}/${e}`,t);return s.data},k=async(e,t)=>{const s=await n.delete(`${o}/${e}/recipient/${t}`);return s.data},v=async e=>{const t=await n.put(`${o}/${e}/rating-plus`);return t.data},w=async e=>{const t=await n.put(`${o}/${e}/rating-minus`);return t.data},b=async(e,t)=>{const s=await n.put(`${o}/${e}/rating-pos`,t);return s.data},y=async(e,t)=>{const s=await n.put(`${o}/${e}/rating-neg`,t);return s.data};t.Z={getProviders:i,getProvider:a,getProvByProvId:r,getProvidersMatchingByProfession:l,addProvider:c,updateProvider:f,addRoom:u,editAddress:d,editProfession:g,additionalProfession:m,removeProfession:p,addProviderBooking:h,removeProviderBooking:k,setPositiveRating:v,setNegativeRating:w,addPositiveFeedback:b,addNegativeFeedback:y}},5800:function(e,t,s){"use strict";const n=s(7218),o="/api/recipients",i=async()=>{const e=await n.get(o);return e.data},a=async e=>{const t=await n.get(`${o}/user/${e}`);return t.data},r=async e=>{const t=await n.get(`${o}/booking/${e}`);return t.data},l=async(e,t)=>{const s=await n.post(`${o}/${e}`,t);return s.data},c=async(e,t)=>{const s=await n.put(`${o}/${e}`,t);return s.data},u=async(e,t)=>{const s=await n.put(`${o}/${e}/editBookingAddress`,t);return s.data},d=async(e,t)=>{const s=await n.put(`${o}/${e}/description`,t);return s.data},g=async(e,t)=>{const s=await n.post(`${o}/${e}/addOrdered/${t}`);return s.data},m=async(e,t)=>{const s=await n.put(`${o}/${e}`,t);return s.data},p=async(e,t)=>{const s=await n.put(`${o}/${e}/updateDate`,t);return s.data},h=async(e,t)=>{const s=await n.post(`${o}/${e}/addImage/${t}`);return s.data},f=async(e,t)=>{const s=await n.delete(`${o}/${e}/image/${t}`);return s.data},k=async(e,t)=>{const s=await n.put(`${o}/client/${e}`,t);return s.data},v=async e=>{await n.delete(`${o}/${e}`)};t.Z={getRecipients:i,getOwnBookings:a,getBookingById:r,addRecipient:l,updateRecipient:c,editBookingAddress:u,editDescription:d,addProviderData:g,addProviderID:m,newDate:p,addImage:h,removeImage:f,feedbackClient:k,removeBooking:v}},1478:function(e,t,s){"use strict";const n=s(7218),o="/api/users",i=async()=>{const e=await n.get(o);return e.data},a=async e=>{const t=await n.post(`${o}`,e);return t.data},r=async e=>{const t=await n.put(`${o}/${e}/removeAvatar`,{avatar:{}});return t.data};t.Z={getAll:i,addUser:a,removeAvatar:r}},4058:function(e,t,s){"use strict";var n=s(2066);const o="https://line-app-pro.onrender.com/",i={"force new connection":!0,reconnectionAttempts:"Infinity",timeout:1e4,transports:["websocket"]},a=n.io.connect(o,i);a.onAny(((e,...t)=>{console.log(e,t)})),t.Z=a},4837:function(e,t,s){"use strict";s.d(t,{Z:function(){return x}});var n=s(3396),o=s(7139),i=s(9242);const a=e=>((0,n.dD)("data-v-630c16aa"),e=e(),(0,n.Cn)(),e),r={key:0,class:"panel"},l={class:"messages",ref:"chatArea"},c={class:"inner",ref:"refscrollHeight"},u={class:"messagesBody"},d={key:0,class:"messageRow"},g={class:"displayName"},m=a((()=>(0,n._)("i",{class:"fas fa-user-circle"},null,-1))),p={class:"messageBlue"},h={class:"messageContent"},f={class:"messageTimeStampRight"},k={key:1,class:"messageRowRight"},v={class:"messageOrange"},w={class:"messageContent"},b={class:"messageTimeStampRight"},y=["disabled"],B=a((()=>(0,n._)("i",{class:"fas fa-arrow-right"},null,-1)));function D(e,t,s,a,D,I){const U=(0,n.up)("MDBIcon");return D.userIn?((0,n.wg)(),(0,n.iD)("div",r,[(0,n._)("div",l,[(0,n._)("div",c,[(0,n._)("div",null,[(0,n._)("div",null,[(0,n._)("div",u,[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(s.messages,((e,t)=>((0,n.wg)(),(0,n.iD)("div",{key:t},[e.userID!==D.userIn.id?((0,n.wg)(),(0,n.iD)("div",d,[(0,n._)("div",null,[(0,n._)("div",g,[(0,n.Wm)(U,{size:"2x"},{default:(0,n.w5)((()=>[m])),_:1}),(0,n.Uk)(" "+(0,o.zw)(e.username),1)]),(0,n._)("div",p,[(0,n._)("div",null,[(0,n._)("p",h,(0,o.zw)(e.content),1)]),(0,n._)("div",f,(0,o.zw)(e.date),1)])])])):((0,n.wg)(),(0,n.iD)("div",k,[(0,n._)("div",v,[(0,n._)("p",w,(0,o.zw)(e.content),1),(0,n._)("div",b,(0,o.zw)(e.date),1)])]))])))),128))])])])],512)],512),(0,n._)("form",{onSubmit:t[1]||(t[1]=(0,i.iM)(((...e)=>I.onSubmit&&I.onSubmit(...e)),["prevent"]))},[(0,n.wy)((0,n._)("textarea",{"onUpdate:modelValue":t[0]||(t[0]=e=>D.msg=e),rows:"2",placeholder:"Kirjoita viesti..."},null,512),[[i.nr,D.msg]]),(0,n._)("button",{disabled:!I.isValid,class:"send"},[(0,n.Wm)(U,null,{default:(0,n.w5)((()=>[B])),_:1})],8,y)],32)])):(0,n.kq)("",!0)}var I=s(4313),U=s(4045),C=s(4870),S={name:"MessagePanel",components:{MDBIcon:I.vm},props:{test:Boolean,user:Object,messages:Array,initMessages:Array},data(){return{userIn:null,msg:""}},setup(){let e=(0,C.iH)(null),t=(0,C.iH)(null);const s=()=>{(0,n.Y3)((()=>{e.value.scrollTo({behavior:"smooth",top:t.value.clientHeight})}))};return(0,n.ic)(s),{update:s,chatArea:e,refscrollHeight:t}},watch:{messages:async function(){console.log("Watching..."),await this.scrollToEnd()}},mounted(){const e=window.localStorage.getItem("loggedAppUser");if(e){const t=JSON.parse(e);this.userIn=t}},methods:{async onSubmit(){const e=new Date;this.$emit("new:message",this.msg,(0,U.ZP)(e,"dd-mm-yyyy,  HH:MM")),this.msg=""},displaySender(e,t){return 0===t||this.user.messages[t-1].fromSelf!==this.user.messages[t].fromSelf},async scrollToEnd(){try{if(this.messages&&this.messages.length>0){console.log("Is in end ------------ "+this.messages.length);const e=await this.messages[this.messages.length-1].id;document.getElementById(e).scrollIntoView({block:"start"})}}catch(e){console.log(e)}}},computed:{isValid(){return this.msg.length>0}}},M=s(89);const _=(0,M.Z)(S,[["render",D],["__scopeId","data-v-630c16aa"]]);var x=_},7416:function(e,t,s){"use strict";s.d(t,{Z:function(){return B}});var n=s(3396),o=s(7139);const i={class:"description"},a={key:0,class:"name"},r={key:0,class:"new-messages"},l={key:1,class:"status"};function c(e,t,s,c,u,d){const g=(0,n.up)("status-icon"),m=(0,n.up)("MDBBtnClose");return(0,n.wg)(),(0,n.iD)(n.HY,null,[s.user.self?(0,n.kq)("",!0):((0,n.wg)(),(0,n.iD)("div",{key:0,class:(0,o.C_)(["user",{selected:s.selected}]),onClick:t[0]||(t[0]=(...e)=>d.onClick&&d.onClick(...e))},[(0,n._)("div",i,[s.user.self?(0,n.kq)("",!0):((0,n.wg)(),(0,n.iD)("div",a,[s.user.hasNewMessages?((0,n.wg)(),(0,n.iD)("div",r,"!")):(0,n.kq)("",!0),(0,n.Uk)((0,o.zw)(d.status),1)])),s.user.self?(0,n.kq)("",!0):((0,n.wg)(),(0,n.iD)("div",l,[(0,n.Wm)(g,{user:s.user,connected:s.user.connected},null,8,["user","connected"])]))])],2)),!s.user.self&&s.selected?((0,n.wg)(),(0,n.j4)(m,{key:1,onClick:d.setUserNotSelected,style:{float:"right"}},null,8,["onClick"])):(0,n.kq)("",!0)],64)}var u=s(4313);const d=e=>((0,n.dD)("data-v-6e2b2b6c"),e=e(),(0,n.Cn)(),e),g=d((()=>(0,n._)("div",null,null,-1))),m={style:{"font-size":"18px"}},p=d((()=>(0,n._)("i",{class:"fas fa-user-circle"},null,-1)));function h(e,t,s,i,a,r){const l=(0,n.up)("MDBIcon");return(0,n.wg)(),(0,n.iD)(n.HY,null,[g,(0,n._)("p",m,[(0,n.Wm)(l,{size:"2x"},{default:(0,n.w5)((()=>[p])),_:1}),(0,n.Uk)(" "+(0,o.zw)(s.user.username)+" ",1),(0,n._)("i",{class:(0,o.C_)(["icon",{connected:s.connected}]),style:{padding:"10px","margin-left":"10px"}},null,2)])],64)}var f={name:"StatusIcon",components:{MDBIcon:u.vm},props:{connected:Boolean,user:Object},data(){return{avatar:null,chatavatar:null}},methods:{},async mounted(){}},k=s(89);const v=(0,k.Z)(f,[["render",h],["__scopeId","data-v-6e2b2b6c"]]);var w=v,b={name:"chat-user",components:{MDBBtnClose:u.Ok,StatusIcon:w},props:{user:Object,firstUser:String,selected:Boolean},data(){return{isChatOpen:!1}},methods:{onClick(){this.$emit("select")},setUserNotSelected(){this.$emit("noSelected")}},computed:{status(){return this.user.connected?"Aloita chattailu":"Olen offline-tilassa Jätä viesti"}}};const y=(0,k.Z)(b,[["render",c],["__scopeId","data-v-734bb4ec"]]);var B=y},17:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return g}});var n=s(3396);function o(e,t,s,o,i,a){const r=(0,n.up)("User"),l=(0,n.up)("MessagePanel"),c=(0,n.up)("MDBContainer");return(0,n.wg)(),(0,n.j4)(c,{style:{"padding-top":"25px"}},{default:(0,n.w5)((()=>[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(s.chatusers,((e,t)=>((0,n.wg)(),(0,n.iD)("div",{key:t},[(0,n.Wm)(r,{user:e,selected:s.selecteduser===e,onNoSelected:a.noSelected,onSelect:t=>a.selectUser(e)},null,8,["user","selected","onNoSelected","onSelect"])])))),128)),s.selecteduser?((0,n.wg)(),(0,n.j4)(l,{key:0,test:s.test,user:i.selectedUser,messages:s.messages,"onNew:message":a.onMessage},null,8,["test","user","messages","onNew:message"])):(0,n.kq)("",!0)])),_:1})}var i=s(4313),a=s(7416),r=s(4837),l=s(4058),c={name:"live-chat",props:{test:Boolean,selecteduser:null,chatusers:Array,messages:Array,newMessageRoom:String,loggedInUser:Object,bookings:Array,bookingsHistory:Array,un:String,ri:String},components:{User:a.Z,MessagePanel:r.Z,MDBContainer:i.L5},data(){return{tabFocus:!1,user:{},selectedUser:null,users:[],msg:"",userId:null,username:"",room:"",count:0}},created(){this.detectFocusOut()},watch:{tabFocus(e){console.log("New value:",e)}},methods:{detectFocusOut(){let e=!1;const t=t=>{if({focus:1,pageshow:1}[t.type]){if(e)return;this.tabFocus=!0,e=!0,this.$emit("wentOut")}else e&&(this.tabFocus=!this.tabFocus,e=!1)};window.addEventListener("focus",t),window.addEventListener("blur",t),window.addEventListener("pageshow",t),window.addEventListener("pagehide",t)},sendMessage:function(){""!==this.msg&&(l.Z.emit("msg",this.msg),this.msg="")},startChat(){let e="userdialog",t="eka";l.Z.emit("credentials",{userID:this.loggedUser.id,username:t,room:e})},submit(){},selectUser(e){this.$emit("select:user",e),this.selectedUser=e},noSelected(){this.$emit("noSelected")},onMessage(e,t){this.$emit("on:message",e,t)},renderChat(){this.count++},newChat(){console.log("Aaaaaaaa");let e="alla",t="tuba";this.usernameAlreadySelected=!0,l.Z.auth={username:e,room:t},l.Z.connect()},onUsernameSelection(e,t){console.log("Aaaaaaaa"),this.username=e,this.room=t,this.usernameAlreadySelected=!0,l.Z.auth={username:e,room:t},l.Z.connect()},updateRoom(){l.Z.emit("updateRoom","uus-tuba"),l.Z.on("get room users",(e=>{this.users=e})),this.socketResetTest()},removeChatUser(){console.log("Remove chat user"),l.Z.emit("unsubscribe"),window.localStorage.removeItem("sessionID"),l.Z.on("get room users",(e=>{this.users=e})),location.reload()}},computed:{isValid(){return this.msg.length>0}},mounted(){},unmounted(){"/chat"!==this.currentRouteName&&(console.log("Ei ole see router"),this.noSelected())}},u=s(89);const d=(0,u.Z)(c,[["render",o],["__scopeId","data-v-8ab05a10"]]);var g=d},3109:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return L}});var n=s(3396),o=s(7139);const i=e=>((0,n.dD)("data-v-30ecc3fc"),e=e(),(0,n.Cn)(),e),a={key:0,class:"spinner-border",role:"status"},r=i((()=>(0,n._)("span",{class:"visually-hidden"},"Loading...",-1))),l=[r],c={key:1},u=["onClick"],d=["onClick"];function g(e,t,s,i,r,g){const m=(0,n.up)("monthConverter"),p=(0,n.up)("MDBCol"),h=(0,n.up)("Booking"),f=(0,n.up)("MDBRow"),k=(0,n.up)("MDBContainer");return(0,n.wg)(),(0,n.iD)("div",null,[(0,n.Wm)(k,{style:{"margin-top":"100px"}},{default:(0,n.w5)((()=>[0===r.bookings.length?((0,n.wg)(),(0,n.iD)("div",a,l)):((0,n.wg)(),(0,n.iD)("div",c,[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(r.bookings,((e,t)=>((0,n.wg)(),(0,n.j4)(f,{key:t,style:{"margin-bottom":"10px"}},{default:(0,n.w5)((()=>[(0,n.Wm)(p,{style:{border:"1px solid black",padding:"20px","font-size":"18px"},sm:"4",onClick:s=>g.handleOpenBooking(e,t),class:(0,o.C_)([{activeHeader:t===r.bookingIndex&&r.isBooking}])},{default:(0,n.w5)((()=>["notSeen"===e.status?((0,n.wg)(),(0,n.iD)("b",{key:0,onClick:t=>g.messageSeen(e)},[(0,n.Uk)(" ("),(0,n._)("b",null,(0,o.zw)(e.user.username),1),(0,n.Uk)(") "),(0,n.Wm)(m,{num:e.onTime[0].month},null,8,["num"]),(0,n.Uk)(" "+(0,o.zw)(e.onTime[0].day)+" "+(0,o.zw)(e.onTime[0].year)+" - "+(0,o.zw)(e.header),1)],8,u)):((0,n.wg)(),(0,n.iD)("p",{key:1,onClick:t=>g.messageSeen(e)},[(0,n.Uk)(" ("),(0,n._)("b",null,(0,o.zw)(e.user.username),1),(0,n.Uk)(") "),(0,n.Wm)(m,{num:e.onTime[0].month},null,8,["num"]),(0,n.Uk)(" "+(0,o.zw)(e.onTime[0].day)+" "+(0,o.zw)(e.onTime[0].year)+" - "+(0,o.zw)(e.header),1)],8,d))])),_:2},1032,["onClick","class"]),(0,n.Wm)(p,{sm:"8"},{default:(0,n.w5)((()=>[r.isBooking&&t===r.bookingIndex?((0,n.wg)(),(0,n.j4)(h,{key:0,booking:e,chatusers:s.chatusers,messages:s.messages,"onSelect:user":g.selectUser,onNoSelected:g.noSelected,selecteduser:s.selecteduser,"onOn:message":g.onMessage,"onClose:booking":g.handleCloseBooking,"onConfirm:booking":g.handleConfirmBooking},null,8,["booking","chatusers","messages","onSelect:user","onNoSelected","selecteduser","onOn:message","onClose:booking","onConfirm:booking"])):(0,n.kq)("",!0)])),_:2},1024)])),_:2},1024)))),128))]))])),_:1})])}s(7658);var m=s(4313),p=s(4870),h=s(2043),f=s(5253),k=s(5800),v=s(9398),w=s(7416),b=s(4837);function y(e,t,s,o,i,a){const r=(0,n.up)("user"),l=(0,n.up)("message-panel");return(0,n.wg)(),(0,n.iD)("div",null,[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(i.users,(t=>((0,n.wg)(),(0,n.iD)("div",{key:t.id,style:{width:"300px",margin:"auto","margin-bottom":"5px","border-radius":"5px"}},[(0,n._)("p",null,[t.self?(0,n.kq)("",!0):((0,n.wg)(),(0,n.j4)(r,{key:0,user:t,firstUser:e.userFirst,selected:i.selectedUser===t,onSelect:e=>a.onSelectUser(t)},null,8,["user","firstUser","selected","onSelect"]))])])))),128)),i.selectedUser?((0,n.wg)(),(0,n.j4)(l,{key:0,user:i.selectedUser,initMessages:i.initMessages,"onNew:message":a.onMessage},null,8,["user","initMessages","onNew:message"])):(0,n.kq)("",!0)])}var B=s(4058),D={name:"chat-io",props:{me:Object,uname:String,rm:String,isUserRemoved:Boolean},components:{User:w.Z,MessagePanel:b.Z},data(){return{selectedUser:null,users:[],room:"",firstUser:"",user:!0,initMessages:{}}},methods:{onMessage(e,t){this.selectedUser&&(console.log("Selected user: "+this.selectedUser.username),B.Z.emit("private message",{content:e,date:t,to:this.selectedUser.userID}),this.selectedUser.messages.push({content:e,date:t,fromSelf:!0}))},onSelectUser(e){e.self||(this.selectedUser=e),e.hasNewMessages=!1}},mounted(){B.Z.on("init messages",(e=>{this.initMessages=e.messages}))},beforeMount(){},created(){B.Z.on("init messages",(e=>{this.initMessages=e.messages})),B.Z.on("connect",(()=>{this.users.forEach((e=>{e.self&&(e.connected=!0)}))})),B.Z.on("disconnect",(()=>{this.users.forEach((e=>{e.self&&(e.connected=!1)}))}));const e=e=>{this.initMessages.length>0&&(console.log("Room vvvvvv"+this.initMessages[0].room),this.room=this.initMessages[0].room),e.room===this.room?e.messages=this.initMessages:e.messages=[],e.hasNewMessages=!1};B.Z.on("get room users",(t=>{console.log("Room users: "+t.users.map((e=>e.username))),t.users.forEach((t=>{for(let e=0;e<this.users.length;e++){const s=this.users[e];if(s.userID===t.userID)return void(s.connected=t.connected)}t.self=t.userID===B.Z.userID,e(t),this.users.push(t)})),this.users.sort(((e,t)=>e.self?-1:t.self?1:e.username<t.username?-1:e.username>t.username?1:0))})),B.Z.on("get updated room users",(t=>{this.users=[],t.users.forEach((t=>{for(let e=0;e<this.users.length;e++){const s=this.users[e];if(s.userID===t.userID)return void(s.connected=t.connected)}t.self=t.userID===B.Z.userID,t.self||(this.selectedUser=t),e(t),this.users.push(t)})),this.users.sort(((e,t)=>e.self?-1:t.self?1:e.username<t.username?-1:e.username>t.username?1:0))})),B.Z.on("user connected",(t=>{for(let e=0;e<this.users.length;e++){const s=this.users[e];if(s.userID===t.userID)return void(s.connected=!0)}e(t),this.users.push(t)})),B.Z.on("user disconnected",(e=>{for(let t=0;t<this.users.length;t++){const s=this.users[t];if(s.userID===e){s.connected=!1;break}}})),B.Z.on("private message",(({content:e,date:t,from:s,to:n})=>{for(let o=0;o<this.users.length;o++){const i=this.users[o],a=B.Z.userID===s;if(i.userID===(a?n:s)){i.messages.push({content:e,date:t,fromSelf:a}),i!==this.selectedUser&&(i.hasNewMessages=!0);break}}}))},unmounted(){B.Z.off("connect"),B.Z.off("disconnect"),B.Z.off("users"),B.Z.off("user connected"),B.Z.off("user disconnected"),B.Z.off("private message")}},I=s(89);const U=(0,I.Z)(D,[["render",y],["__scopeId","data-v-4a92ac8e"]]);var C=U,S=s(17);const M=e=>((0,n.dD)("data-v-970eeaa2"),e=e(),(0,n.Cn)(),e),_={style:{border:"solid blue"}},x={key:0},$=["src"],P=M((()=>(0,n._)("tr",null,[(0,n._)("td")],-1))),Z=M((()=>(0,n._)("tr",null,[(0,n._)("td")],-1)));function O(e,t,s,i,a,r){const l=(0,n.up)("MDBBtnClose"),c=(0,n.up)("MDBBtn"),u=(0,n.up)("live-chat"),d=(0,n.up)("MDBTable");return(0,n.wg)(),(0,n.iD)(n.HY,null,[(0,n.Wm)(d,{borderless:"",style:{"font-size":"18px","text-align":"center"}},{default:(0,n.w5)((()=>[(0,n._)("tbody",null,[(0,n._)("tr",null,[(0,n._)("td",null,[(0,n.Uk)((0,o.zw)(s.booking.address)+" ",1),(0,n.Wm)(l,{class:"closeData",onClick:r.closeBooking},null,8,["onClick"])])]),(0,n._)("tr",null,[(0,n._)("td",_,(0,o.zw)(s.booking.description),1)]),(0,n._)("tr",null,[s.booking.image?((0,n.wg)(),(0,n.iD)("td",x,[a.isImageOpen?(0,n.kq)("",!0):((0,n.wg)(),(0,n.j4)(c,{key:0,outline:"success",onClick:t[0]||(t[0]=e=>r.openImagePanel(s.booking.image))},{default:(0,n.w5)((()=>[(0,n.Uk)(" Open image ")])),_:1})),(0,n._)("div",null,[a.isOpenImage?((0,n.wg)(),(0,n.iD)("img",{key:0,id:"img",class:"loading",src:a.srcImg,alt:"kuva"},null,8,$)):(0,n.kq)("",!0),a.isImageOpen?((0,n.wg)(),(0,n.j4)(c,{key:1,outline:"secondary",onClick:r.closeImagePanel},{default:(0,n.w5)((()=>[(0,n.Uk)(" Close image ")])),_:1},8,["onClick"])):(0,n.kq)("",!0)])])):(0,n.kq)("",!0)]),P,Z,(0,n._)("tr",null,[(0,n._)("td",null,[(0,n.Wm)(u,{chatusers:s.chatusers,messages:s.messages,"onSelect:user":r.selectUser,onNoSelected:r.noSelected,selecteduser:s.selecteduser,"onOn:message":r.onMessage},null,8,["chatusers","messages","onSelect:user","onNoSelected","selecteduser","onOn:message"])])])])])),_:1}),(0,n.Wm)(c,{block:"",outline:"success",onClick:t[1]||(t[1]=e=>r.confirmBooking(s.booking))},{default:(0,n.w5)((()=>[(0,n.Uk)(" Kinnita tellimus ")])),_:1})],64)}var N={name:"Booking",props:{booking:Object,selecteduser:null,chatusers:Array,messages:Array},components:{LiveChat:S["default"],MDBTable:m.re,MDBBtn:m.$v,MDBBtnClose:m.Ok},data(){return{isOpenImage:!1,isImageOpen:!1,srcImg:""}},mounted(){},methods:{getBooking(e){console.log("Booking user "+e.booking.id)},selectUser(e){this.$emit("select:user",e)},noSelected(){this.$emit("noSelected")},onMessage(e,t){this.$emit("on:message",e,t)},openImagePanel(e){this.isOpenImage=!0,this.srcImg=s(7752)(`./${e.map((e=>e.name))}`),""!==this.srcImg&&(this.isImageOpen=!0)},closeImagePanel(){this.isOpenImage=!1,this.isImageOpen=!1},confirmBooking(e){this.$emit("confirm:booking",e)},closeBooking(){this.$emit("close:booking"),this.noSelected()}}};const A=(0,I.Z)(N,[["render",O],["__scopeId","data-v-970eeaa2"]]);var j=A,R=s(376),T=s(6849),E={name:"client-notifications",props:{chatusers:Array,activeUser:null,selecteduser:null,messages:Array,loggedInUser:Object,userIsProvider:Object,room:String},components:{User:w.Z,MessagePanel:b.Z,PulseLoader:h.Z,monthConverter:f.Z,TabView:R.Z,TabPanel:T.Z,chatContent:C,liveChat:S["default"],Booking:j,MDBContainer:m.L5,MDBRow:m.uZ,MDBCol:m.TK,MDBListGroup:m.d8,MDBListGroupItem:m.FQ,MDBTabs:m.zk,MDBTabNav:m.JH,MDBTabItem:m.kX,MDBTabContent:m.oJ,MDBTabPane:m._I,MDBTable:m.re,MDBBtnClose:m.Ok,MDBBtn:m.$v},setup(){const e=(0,p.iH)("null");return{activeTabId4:e}},data(){return{selectedUser:null,userIn:null,bookings:[],isBooking:!1,bookingID:null,pressed:!1,bookingIndex:null,booking:{},currentRoom:"",bookingDate:null,isSeen:!1,isOpenImage:!1,isImageOpen:!1,srcImg:"",isChatOpen:!1,isRenderData:!1,loading:!1,id:null,un:"sanna",ri:"",room:"",isChat:!1,isPressedOpenChat:!1,isPressedContactToUser:!1,isConnection:!1,isPressedFinal:!1,count:0}},mounted(){const e=window.localStorage.getItem("loggedAppUser");if(e){const t=JSON.parse(e);this.userIn=t,this.handleBookings()}else this.$router.push("/")},methods:{avajauuenda(){this.isChat=!0,this.count++},selectUser(e){this.$emit("select:user",e)},noSelected(){this.$emit("noSelected")},onMessage(e,t){this.$emit("on:message",e,t)},renderComponent(){this.isChat=!0,B.Z.on("get updated room users",(e=>{console.log("xx-notification "+e.users.length),e.users.length>1&&(this.isTwoUsersOnline=!0)}))},async handleBookings(){const e=await v.Z.getProvider(this.userIn.id);e&&(this.bookings=e.booking.filter((e=>"confirmed"!==e.status&&"waiting"!==e.status&&"completed"!==e.status)))},createBookingDate(){this.bookingDate=22},handleOpenBooking(e,t){document.getElementById("header");console.log("Booking user id: "+e.user.id),this.bookingIndex=t,this.isBooking=!0,this.booking=e},handleCloseBooking(){this.isBooking=!1},messageSeen(e){this.isSeen=!0,this.ri=this.userIsProvider.yritys+e.user.username,console.log("Ri means: "+this.ri),this.room=this.userIsProvider.yritys+e.user.username,console.log("Room in notifications "+this.room);const t=this.userIn.username,s=(this.ri,{room:this.room,userID:this.userIn.id,username:t});this.$emit("chatCredentials",s),B.Z.emit("room users count"),B.Z.on("get room users count",(e=>{console.log("Can we get users data from backend here??? "+e.users.length)})),this.id=e.id,this.editStatus(e.id,"seen")},async editStatus(e,t){const s={status:t},n=await k.Z.updateRecipient(e,s);console.log("Is status updated: "+n.status),this.$emit("update:status",e)},openImagePanel(e){this.isOpenImage=!0,this.srcImg=s(3866)(`./${e.map((e=>e.name))}`),""!==this.srcImg&&(this.isImageOpen=!0)},handleConfirmBooking(e){console.log("confirmed booking id "+e.id),console.log("Confirmed booking user id "+e.user.id),this.editStatus(e.id,"confirmed"),this.$emit("remove:booking",e.id),this.isBooking=!1,B.Z.emit("accept recipient",{id:e.user.id,booking:e}),this.bookings=this.bookings.filter((t=>t.id!==e.id)),this.bookings.length<1&&this.$router.go(-1)},closeImagePanel(){this.isOpenImage=!1,this.isImageOpen=!1},exitFromNotificationData(){location.reload()}}};const W=(0,I.Z)(E,[["render",g],["__scopeId","data-v-30ecc3fc"]]);var L=W},2519:function(e,t,s){var n={"./avatar.png":1900,"./jane_doe.png":9197};function o(e){var t=i(e);return s(t)}function i(e){if(!s.o(n,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return n[e]}o.keys=function(){return Object.keys(n)},o.resolve=i,e.exports=o,o.id=2519},7752:function(e,t,s){var n={"./avatar/avatar.png":1900,"./avatar/jane_doe.png":9197,"./file-1705838505965-moon.jpg":2186,"./file-1705839224490-Punane_puudutus.jpg":6645,"./file-1706203283611-saturn1.jpg":5615};function o(e){var t=i(e);return s(t)}function i(e){if(!s.o(n,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return n[e]}o.keys=function(){return Object.keys(n)},o.resolve=i,e.exports=o,o.id=7752},3866:function(e,t,s){var n={"./file-1701851803193-jul.jpg":3718,"./file-1701861866893-jul-1.jpg":4923,"./file-1701862621258-jul-2.jpg":3659,"./file-1704111100142-jul.jpg":1818};function o(e){var t=i(e);return s(t)}function i(e){if(!s.o(n,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return n[e]}o.keys=function(){return Object.keys(n)},o.resolve=i,e.exports=o,o.id=3866},1900:function(e,t,s){"use strict";e.exports=s.p+"img/avatar.db2f8c83.png"},9197:function(e,t,s){"use strict";e.exports=s.p+"img/jane_doe.f446515f.png"},2186:function(e,t,s){"use strict";e.exports=s.p+"img/file-1705838505965-moon.ce208c8c.jpg"},6645:function(e,t,s){"use strict";e.exports=s.p+"img/file-1705839224490-Punane_puudutus.e851d5b8.jpg"},5615:function(e,t,s){"use strict";e.exports=s.p+"img/file-1706203283611-saturn1.b62bc39c.jpg"},3718:function(e,t,s){"use strict";e.exports=s.p+"img/file-1701851803193-jul.ca147627.jpg"},4923:function(e,t,s){"use strict";e.exports=s.p+"img/file-1701861866893-jul-1.a1cfb29d.jpg"},3659:function(e,t,s){"use strict";e.exports=s.p+"img/file-1701862621258-jul-2.4f493041.jpg"},1818:function(e,t,s){"use strict";e.exports=s.p+"img/file-1704111100142-jul.ca147627.jpg"},5840:function(e,t,s){"use strict";e.exports=s.p+"img/palaute.ef0be53c.png"}},t={};function s(n){var o=t[n];if(void 0!==o)return o.exports;var i=t[n]={exports:{}};return e[n].call(i.exports,i,i.exports,s),i.exports}s.m=e,function(){var e=[];s.O=function(t,n,o,i){if(!n){var a=1/0;for(u=0;u<e.length;u++){n=e[u][0],o=e[u][1],i=e[u][2];for(var r=!0,l=0;l<n.length;l++)(!1&i||a>=i)&&Object.keys(s.O).every((function(e){return s.O[e](n[l])}))?n.splice(l--,1):(r=!1,i<a&&(a=i));if(r){e.splice(u--,1);var c=o();void 0!==c&&(t=c)}}return t}i=i||0;for(var u=e.length;u>0&&e[u-1][2]>i;u--)e[u]=e[u-1];e[u]=[n,o,i]}}(),function(){s.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return s.d(t,{a:t}),t}}(),function(){s.d=function(e,t){for(var n in t)s.o(t,n)&&!s.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})}}(),function(){s.f={},s.e=function(e){return Promise.all(Object.keys(s.f).reduce((function(t,n){return s.f[n](e,t),t}),[]))}}(),function(){s.u=function(e){return"js/"+e+"."+{8:"2058578d",127:"e504d663",136:"c150b49c",161:"dd6cffa5",165:"4b23217b",216:"d4a39043",276:"5647e6a4",320:"8a16beec",351:"bbbacaeb",373:"f3135b18",414:"c1d33dca",422:"507eb2ee",434:"eca60a04",466:"f3d6e6ef",482:"81212a82",598:"da7353ba",737:"fba0e867",744:"c8e42266",798:"18019ae2",837:"1e90a0db"}[e]+".js"}}(),function(){s.miniCssF=function(e){return"css/"+e+"."+{8:"ef752f69",127:"3c7b97b2",136:"2da4f385",216:"7be57e44",276:"ae4e2ff7",320:"f6eab601",414:"fa61a020",434:"2de0ab82",466:"b467b210",482:"267fd6dc",598:"131eb3b8",737:"2922bd17",744:"47315c52",798:"4683883a"}[e]+".css"}}(),function(){s.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){var e={},t="prore-mongo:";s.l=function(n,o,i,a){if(e[n])e[n].push(o);else{var r,l;if(void 0!==i)for(var c=document.getElementsByTagName("script"),u=0;u<c.length;u++){var d=c[u];if(d.getAttribute("src")==n||d.getAttribute("data-webpack")==t+i){r=d;break}}r||(l=!0,r=document.createElement("script"),r.charset="utf-8",r.timeout=120,s.nc&&r.setAttribute("nonce",s.nc),r.setAttribute("data-webpack",t+i),r.src=n),e[n]=[o];var g=function(t,s){r.onerror=r.onload=null,clearTimeout(m);var o=e[n];if(delete e[n],r.parentNode&&r.parentNode.removeChild(r),o&&o.forEach((function(e){return e(s)})),t)return t(s)},m=setTimeout(g.bind(null,void 0,{type:"timeout",target:r}),12e4);r.onerror=g.bind(null,r.onerror),r.onload=g.bind(null,r.onload),l&&document.head.appendChild(r)}}}(),function(){s.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){s.p=""}(),function(){if("undefined"!==typeof document){var e=function(e,t,s,n,o){var i=document.createElement("link");i.rel="stylesheet",i.type="text/css";var a=function(s){if(i.onerror=i.onload=null,"load"===s.type)n();else{var a=s&&("load"===s.type?"missing":s.type),r=s&&s.target&&s.target.href||t,l=new Error("Loading CSS chunk "+e+" failed.\n("+r+")");l.code="CSS_CHUNK_LOAD_FAILED",l.type=a,l.request=r,i.parentNode&&i.parentNode.removeChild(i),o(l)}};return i.onerror=i.onload=a,i.href=t,s?s.parentNode.insertBefore(i,s.nextSibling):document.head.appendChild(i),i},t=function(e,t){for(var s=document.getElementsByTagName("link"),n=0;n<s.length;n++){var o=s[n],i=o.getAttribute("data-href")||o.getAttribute("href");if("stylesheet"===o.rel&&(i===e||i===t))return o}var a=document.getElementsByTagName("style");for(n=0;n<a.length;n++){o=a[n],i=o.getAttribute("data-href");if(i===e||i===t)return o}},n=function(n){return new Promise((function(o,i){var a=s.miniCssF(n),r=s.p+a;if(t(a,r))return o();e(n,r,null,o,i)}))},o={143:0};s.f.miniCss=function(e,t){var s={8:1,127:1,136:1,216:1,276:1,320:1,414:1,434:1,466:1,482:1,598:1,737:1,744:1,798:1};o[e]?t.push(o[e]):0!==o[e]&&s[e]&&t.push(o[e]=n(e).then((function(){o[e]=0}),(function(t){throw delete o[e],t})))}}}(),function(){var e={143:0};s.f.j=function(t,n){var o=s.o(e,t)?e[t]:void 0;if(0!==o)if(o)n.push(o[2]);else if(466!=t){var i=new Promise((function(s,n){o=e[t]=[s,n]}));n.push(o[2]=i);var a=s.p+s.u(t),r=new Error,l=function(n){if(s.o(e,t)&&(o=e[t],0!==o&&(e[t]=void 0),o)){var i=n&&("load"===n.type?"missing":n.type),a=n&&n.target&&n.target.src;r.message="Loading chunk "+t+" failed.\n("+i+": "+a+")",r.name="ChunkLoadError",r.type=i,r.request=a,o[1](r)}};s.l(a,l,"chunk-"+t,t)}else e[t]=0},s.O.j=function(t){return 0===e[t]};var t=function(t,n){var o,i,a=n[0],r=n[1],l=n[2],c=0;if(a.some((function(t){return 0!==e[t]}))){for(o in r)s.o(r,o)&&(s.m[o]=r[o]);if(l)var u=l(s)}for(t&&t(n);c<a.length;c++)i=a[c],s.o(e,i)&&e[i]&&e[i][0](),e[i]=0;return s.O(u)},n=self["webpackChunkprore_mongo"]=self["webpackChunkprore_mongo"]||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))}();var n=s.O(void 0,[998],(function(){return s(3635)}));n=s.O(n)})();
//# sourceMappingURL=app.cb9373cc.js.map