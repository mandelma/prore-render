"use strict";(self["webpackChunkprore_mongo"]=self["webpackChunkprore_mongo"]||[]).push([[60],{4482:function(e,t,i){var a=i(6768);const s=({message:e})=>null===e?null:(0,a.bF)("div",{className:"error"},[e,(0,a.bF)("img",{className:"errorImg",alt:"error",src:i(1644)},null)]);t.A=s},6060:function(e,t,i){i.r(t),i.d(t,{default:function(){return _}});var a=i(6768),s=i(4232);const n={style:{display:"flex","justify-content":"right",padding:"13px"}},o={style:{"font-size":"16px"}},l={style:{"min-width":"33px"}},r={style:{"min-width":"33px"}},u=["src"],g={key:0},d={key:0},c={key:1},h={style:{color:"deepskyblue"}};function m(e,t,m,p,v,k){const b=(0,a.g2)("MDBBtnClose"),f=(0,a.g2)("MDBCol"),R=(0,a.g2)("MDBRow"),y=(0,a.g2)("warning-message"),M=(0,a.g2)("error-message"),w=(0,a.g2)("MDBIcon"),C=(0,a.g2)("MDBBadge"),F=(0,a.g2)("MDBTextarea"),_=(0,a.g2)("MDBBtn"),B=(0,a.g2)("MDBContainer");return(0,a.uX)(),(0,a.Wv)(B,{style:{"padding-top":"70px"}},{default:(0,a.k6)((()=>[(0,a.Lk)("div",n,[(0,a.bF)(b,{white:"",onClick:k.backFromFeedbackClient},null,8,["onClick"])]),(0,a.bF)(R,{style:{"padding-bottom":"20px"}},{default:(0,a.k6)((()=>[(0,a.bF)(f),(0,a.bF)(f,null,{default:(0,a.k6)((()=>[(0,a.Lk)("p",o,[(0,a.Lk)("b",null,(0,s.v_)(m.customer.company),1),t[3]||(t[3]=(0,a.eW)(" odottaa palautetta tarjoamastaan palvelusta ")),(0,a.Lk)("b",null,' "'+(0,s.v_)(m.customer.header)+'" - '+(0,s.v_)(m.customer.date),1)])])),_:1})])),_:1}),(0,a.bF)(y,{message:v.rateWarning},null,8,["message"]),(0,a.bF)(M,{message:v.ratingError},null,8,["message"]),t[7]||(t[7]=(0,a.Lk)("h3",null,"Voit antaa palautetta painamalla valitsemasi kuvaketta!",-1)),(0,a.bF)(R,{style:{position:"relative"}},{default:(0,a.k6)((()=>[(0,a.bF)(f,{style:{padding:"20px"}},{default:(0,a.k6)((()=>[(0,a.bF)(R,{class:"rating"},{default:(0,a.k6)((()=>[(0,a.bF)(f,null,{default:(0,a.k6)((()=>[(0,a.bF)(w,{style:{padding:"10px",cursor:"pointer"},i:"",class:"fas fa-smile",size:"3x",onClick:k.ratePlus},null,8,["onClick"]),(0,a.bF)(C,{color:"success",class:"translate-middle p-1",pill:"",notification:""},{default:(0,a.k6)((()=>[(0,a.Lk)("h2",l,(0,s.v_)(v.positiveRating),1)])),_:1})])),_:1}),(0,a.bF)(f,null,{default:(0,a.k6)((()=>[(0,a.bF)(w,{style:{padding:"10px",cursor:"pointer"},class:"far fa-frown",size:"3x",onClick:k.rateMinus},null,8,["onClick"]),(0,a.bF)(C,{color:"danger",class:"translate-middle p-1",pill:"",notification:""},{default:(0,a.k6)((()=>[(0,a.Lk)("h3",r,(0,s.v_)(v.negativeRating),1)])),_:1})])),_:1}),(0,a.bF)(f,null,{default:(0,a.k6)((()=>[(0,a.Lk)("img",{style:{width:"300px"},src:i(9728),alt:"rating-time"},null,8,u)])),_:1})])),_:1}),v.isRatingGiven?((0,a.uX)(),(0,a.CE)("div",g,[v.isReview?((0,a.uX)(),(0,a.CE)("h2",c,"Arvostelee!")):((0,a.uX)(),(0,a.CE)("h2",d,"Kiitos palautteesta!")),v.isReview?((0,a.uX)(),(0,a.Wv)(F,{key:2,white:"",style:{"margin-bottom":"20px"},label:"Message",rows:"4",modelValue:v.feedback,"onUpdate:modelValue":t[0]||(t[0]=e=>v.feedback=e)},null,8,["modelValue"])):(0,a.Q3)("",!0),(0,a.bF)(_,{outline:"info",size:"lg",onClick:t[1]||(t[1]=e=>v.isReview=!v.isReview)},{default:(0,a.k6)((()=>[(0,a.Lk)("p",h,(0,s.v_)(v.isReview?"Poistu arvostelusta":"Kirjoittaa halutessasi arvostelu"),1)])),_:1})])):(0,a.Q3)("",!0)])),_:1})])),_:1}),v.isRatingGiven?(0,a.Q3)("",!0):((0,a.uX)(),(0,a.Wv)(_,{key:0,block:"",outline:"danger",size:"sm",onClick:k.noRatingToConfirm},{default:(0,a.k6)((()=>t[4]||(t[4]=[(0,a.eW)("En haluaa antaa palautetta!")]))),_:1},8,["onClick"])),v.isRatingGiven?((0,a.uX)(),(0,a.Wv)(_,{key:1,outline:"info",size:"lg",block:"",onClick:t[2]||(t[2]=e=>k.reload())},{default:(0,a.k6)((()=>t[5]||(t[5]=[(0,a.eW)("Muokkaa antamasi palautesi!")]))),_:1})):(0,a.Q3)("",!0),v.isRatingGiven?((0,a.uX)(),(0,a.Wv)(_,{key:2,style:{"margin-bottom":"20px"},block:"",color:"success",size:"lg",onClick:k.confirmFeedback},{default:(0,a.k6)((()=>t[6]||(t[6]=[(0,a.eW)("Lähettää palaute")]))),_:1},8,["onClick"])):(0,a.Q3)("",!0)])),_:1})}i(4114);var p=i(5846),v=i(6765);const k=({message:e})=>null===e?null:(0,a.bF)("div",{className:"warning"},[e]);var b=k,f=i(4482),R=(i(407),i(1769)),y=i(5862),M=i(2815),w={name:"Feedback",props:{customer:Object},components:{monthConverter:v.A,warningMessage:b,errorMessage:f.A,MDBContainer:p.Dj,MDBBtn:p.al,MDBRow:p.gU,MDBCol:p.m6,MDBIcon:p.$u,MDBBadge:p.nf,MDBTextarea:p.QP,MDBTable:p.EU,MDBBtnClose:p.uR},data(){return{author:null,fbc:{},isRatingGiven:!1,isReview:!1,ratedTimes:0,isRatedPos:!1,isRatedMinus:!1,positiveRating:0,negativeRating:0,feedback:"",rateWarning:null,ratingError:null}},methods:{reload(){location.reload()},async getClient(e){const t=await y.A.getClientHistory(),i=t.find((e=>"no rated"===e.status));this.positiveRating=i.rating.positive,this.negativeRating=i.rating.negative,this.fbc=i},ratePlus(){this.isRated=!0,console.log("Pos rating before "+this.positiveRating),this.isRatedMinus?(console.log("Not, only one time is allowed!"),this.rateWarning="Arvostella saa vain kerran!",setTimeout((()=>{this.rateWarning=null}),3e3)):(this.ratedTimes+=1,1===this.ratedTimes?(this.positiveRating=this.positiveRating+1,console.log("Pos rating after "+this.positiveRating),this.isRatingGiven=!0):(console.log("Not, only one time is allowed!"),this.rateWarning="Arvostella saa vain kerran!",setTimeout((()=>{this.rateWarning=null}),3e3)),this.isRatedPlus=!0,this.isRatedMinus=!1)},rateMinus(){this.isRated=!0,this.isRatedPlus?(this.rateWarning="Arvostella saa vain kerran, negatiivisen tai positiivisen!",setTimeout((()=>{this.rateWarning=null}),3e3)):(this.ratedTimes+=1,1===this.ratedTimes?(this.negativeRating=this.negativeRating+1,this.isRatingGiven=!0):(this.rateWarning="Arvostella saa vain kerran, negatiivisen tai positiivisen!",setTimeout((()=>{this.rateWarning=null}),3e3)),this.isRatedPlus=!1,this.isRatedMinus=!0)},async confirmFeedback(){const e=this.customer.proID,t=new Date,i=(0,M.Ay)(t,"dd-mm-yyyy,  HH:MM"),a={pos:i+": ( "+this.author.username+" ) "+this.feedback},s={neg:i+": ( "+this.author.username+" ) "+this.feedback};this.feedback.length>0&&(this.isRatedPlus&&(await R.A.addPositiveFeedback(e,a),this.feedback=""),this.isRatedMinus&&(await R.A.addNegativeFeedback(e,s),this.feedback="")),this.isRatedPlus&&(await R.A.setPositiveRating(e),this.$emit("isRated",this.customer.proID,"positiivista",this.customer.company),this.$router.go(-1)),this.isRatedMinus&&(await R.A.setNegativeRating(e),this.$emit("isRated",this.customer.proID,"negatiivista",this.customer.company),this.$router.go(-1))},noRatingToConfirm(){this.$emit("isRated",this.customer.proID,"no-rating",this.customer.company),this.$router.go(-1)},backFromFeedbackClient(){this.$router.go(-1)}},mounted(){const e=window.localStorage.getItem("loggedAppUser");if(e){const t=JSON.parse(e);this.author=t,this.positiveRating=this.customer.rating.positive,this.negativeRating=this.customer.rating.negative}else this.$router.push("/")}},C=i(1241);const F=(0,C.A)(w,[["render",m],["__scopeId","data-v-34d845ab"]]);var _=F},1644:function(e,t,i){e.exports=i.p+"img/error.9510853e.png"},9728:function(e,t,i){e.exports=i.p+"img/is_feedback.77929104.png"}}]);
//# sourceMappingURL=60.ea7cb4f4.js.map