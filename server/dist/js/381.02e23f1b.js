"use strict";(self["webpackChunkprore_mongo"]=self["webpackChunkprore_mongo"]||[]).push([[381],{3249:function(e,t,i){const s=i(7218),o="/api/offers",n=async()=>{const e=await s.get(o);return e.data},r=async e=>{const t=await s.post(`${o}`,e);return t.data},a=async(e,t)=>{const i=await s.post(`${o}/${e}`,t);return i.data},l=async(e,t)=>{const i=await s.delete(`${o}/${e}/timeoffer/${t}`);return i.data},d=async(e,t)=>{const i=await s.put(`${o}/${e}`,t);return i.data};t["Z"]={getOffers:n,addFirstOffer:r,addAdditionalOffer:a,removeTimeOffer:l,updateOffer:d}},9381:function(e,t,i){i.r(t),i.d(t,{default:function(){return x}});var s=i(3396),o=i(7139);const n=(0,s._)("h1",{style:{"margin-top":"50px","margin-bottom":"50px"}},"TMI:n hallintapaneeli...",-1),r=["onClick"],a=(0,s._)("i",{class:"fas fa-edit"},null,-1),l=(0,s._)("i",{class:"fas fa-times"},null,-1);function d(e,t,i,d,m,u){const c=(0,s.up)("MDBIcon"),h=(0,s.up)("VueDatePicker"),p=(0,s.up)("MDBCol"),g=(0,s.up)("editPrice"),f=(0,s.up)("errorNotification"),k=(0,s.up)("successNotification"),v=(0,s.up)("MDBBtn"),T=(0,s.up)("MDBTable"),w=(0,s.up)("MDBRow"),D=(0,s.up)("MDBContainer");return(0,s.wg)(),(0,s.iD)("div",null,[n,(0,s.Wm)(D,null,{default:(0,s.w5)((()=>[(0,s.Wm)(w,null,{default:(0,s.w5)((()=>[(0,s.Wm)(p,null,{default:(0,s.w5)((()=>[(0,s.Wm)(h,{style:{"margin-bottom":"50px"},range:"",modelValue:d.date,"onUpdate:modelValue":[t[0]||(t[0]=e=>d.date=e),u.handleDate],inline:"","min-date":new Date,markers:d.markers,"month-change-on-scroll":!1},{"marker-tooltip":(0,s.w5)((({tooltip:e})=>[(0,s.Wm)(h,{modelValue:d.times[e.index],"onUpdate:modelValue":[t=>d.times[e.index]=t,u.handleTime],range:"","time-picker":"","min-time":{hours:d.times[e.index][0].hours,minutes:d.times[e.index][0].minutes},"minutes-grid-increment":"10",onOpen:t=>u.alertFn(e.index)},{trigger:(0,s.w5)((()=>[(0,s._)("div",{onClick:t=>u.test(e.index),style:{cursor:"pointer"}},[(0,s.Uk)((0,o.zw)(d.times[e.index][0].hours>=10?d.times[e.index][0].hours:"0"+d.times[e.index][0].hours)+" : "+(0,o.zw)(d.times[e.index][0].minutes>=10?d.times[e.index][0].minutes:"0"+d.times[e.index][0].minutes)+" - "+(0,o.zw)(d.times[e.index][1].hours>=10?d.times[e.index][1].hours:"0"+d.times[e.index][1].hours)+" : "+(0,o.zw)(d.times[e.index][1].minutes>=10?d.times[e.index][1].minutes:"0"+d.times[e.index][1].minutes)+"     ",1),(0,s.Wm)(c,null,{default:(0,s.w5)((()=>[a])),_:1})],8,r)])),_:2},1032,["modelValue","onUpdate:modelValue","min-time","onOpen"]),(0,s.Uk)("    "),(0,s.Wm)(c,{onClick:t=>u.delTimeRange(e.timeId)},{default:(0,s.w5)((()=>[l])),_:2},1032,["onClick"])])),_:1},8,["modelValue","onUpdate:modelValue","min-date","markers"])])),_:1}),d.isEditPrice?((0,s.wg)(),(0,s.j4)(p,{key:0},{default:(0,s.w5)((()=>[(0,s.Wm)(g,{"onCancel:editPrice":u.cancelEditPrice,"onSave:editedPrice":u.saveEditedPrice},null,8,["onCancel:editPrice","onSave:editedPrice"])])),_:1})):((0,s.wg)(),(0,s.j4)(p,{key:1},{default:(0,s.w5)((()=>[(0,s._)("h2",null,(0,o.zw)(d.provider.yritys)+":",1),(0,s.Wm)(f,{message:d.errorMessage},null,8,["message"]),(0,s.Wm)(k,{message:d.successMessage},null,8,["message"]),(0,s.Wm)(T,{borderless:"",style:{"font-size":"18px","text-align":"left"}},{default:(0,s.w5)((()=>[(0,s._)("tbody",null,[(0,s._)("tr",null,[(0,s._)("td",null,(0,o.zw)(d.provider.address),1),(0,s._)("td",null,[(0,s.Wm)(v,{outline:"info",block:"",size:"lg",onClick:e.editAddress},{default:(0,s.w5)((()=>[(0,s.Uk)("Muokkaa osoitetta")])),_:1},8,["onClick"])])]),(0,s._)("tr",null,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(d.provider.profession,((e,t)=>((0,s.wg)(),(0,s.iD)("td",{key:t},(0,o.zw)(e),1)))),128)),(0,s._)("td",null,[(0,s.Wm)(v,{outline:"info",block:"",size:"lg",onClick:e.editProfession},{default:(0,s.w5)((()=>[(0,s.Uk)("Muokkaa ammattia")])),_:1},8,["onClick"])])]),(0,s._)("tr",null,[(0,s._)("td",null,(0,o.zw)(d.provider.priceByHour)+" Euroa ",1),(0,s._)("td",null,[(0,s.Wm)(v,{outline:"info",block:"",size:"lg",onClick:u.editPrice},{default:(0,s.w5)((()=>[(0,s.Uk)("Muokkaa tuntihinta")])),_:1},8,["onClick"])])])])])),_:1})])),_:1}))])),_:1})])),_:1})])}i(7658);var m=i(6691),u=i(9398);const c=(0,s._)("h1",null,"Editing price",-1);function h(e,t,i,o,n,r){const a=(0,s.up)("MDBInput"),l=(0,s.up)("MDBBtn"),d=(0,s.up)("MDBContainer");return(0,s.wg)(),(0,s.j4)(d,null,{default:(0,s.w5)((()=>[c,(0,s.Wm)(a,{label:"Tuntihinta",modelValue:o.price,"onUpdate:modelValue":t[0]||(t[0]=e=>o.price=e),wrapperClass:"mb-4"},null,8,["modelValue"]),(0,s.Wm)(l,{outline:"success",block:"",size:"lg",onClick:r.handleEditPrice},{default:(0,s.w5)((()=>[(0,s.Uk)("Kinnita")])),_:1},8,["onClick"]),(0,s.Wm)(l,{outline:"danger",block:"",size:"lg",onClick:r.cancelEdit},{default:(0,s.w5)((()=>[(0,s.Uk)("Poistu")])),_:1},8,["onClick"])])),_:1})}var p=i(4313),g=i(4870),f={name:"edit-price",setup(){const e=(0,g.iH)(null);return{price:e}},components:{MDBContainer:p.L5,MDBBtn:p.$v,MDBInput:p.u2},data(){return{errorMessage:null}},methods:{handleEditPrice(){this.$emit("save:editedPrice",this.price)},cancelEdit(){this.$emit("cancel:editPrice",!1),this.errorMessage="Here is some error!"}}},k=i(89);const v=(0,k.Z)(f,[["render",h]]);var T=v;const w=({message:e})=>null===e?null:(0,s.Wm)("div",{className:"error"},[e]);var D=w;const M=({message:e})=>null===e?null:(0,s.Wm)("div",{className:"success"},[e]);var y=M,_=i(5174),P=i(3249),C={name:"Provider-panel",components:{errorNotification:D,successNotification:y,editPrice:T,MDBContainer:p.L5,MDBIcon:p.vm,MDBRow:p.uZ,MDBCol:p.TK,MDBTable:p.re,MDBBtn:p.$v,VueDatePicker:m.Z},data(){return{testi:{}}},setup(){const e=(0,g.iH)(null),t=(0,g.iH)(!1),i=(0,g.iH)(null),s=(0,g.iH)(null),o=(0,g.iH)(null),n=(0,g.iH)([]),r=(0,g.iH)([]),a=(0,g.iH)(!1),l=(0,g.iH)([]),d=(0,g.iH)({}),m=(0,g.iH)([]),u=(0,g.iH)({}),c=(0,g.iH)(""),h=(0,g.iH)({}),p=(0,g.iH)([]),f=(0,g.iH)(null),k=(0,g.iH)(null);return{datee:e,isEditPrice:t,clearTime:i,dateTest:s,date:o,markers:n,contents:r,isContents:a,markedDays:l,time:d,times:m,datetime:u,userId:c,provider:h,providerTimes:p,errorMessage:f,successMessage:k}},mounted(){const e=window.localStorage.getItem("loggedAppUser");if(e){const t=JSON.parse(e);this.userId=t.id}this.providerData()},methods:{editPrice(){this.isEditPrice=!0},async saveEditedPrice(e){console.log("New price is: "+e);const t={priceByHour:e},i=await u.Z.updateProvider(this.provider.id,t);i&&(this.provider.priceByHour=e,this.isEditPrice=!1,this.successMessage="Tuntihinta on muokattu!",setTimeout((()=>{this.successMessage=null}),2e3))},cancelEditPrice(e){this.isEditPrice=e},removeExpiredDateTime(){this.providerTimes.forEach((e=>{e.monthFrom===(new Date).getMonth()&&e.dayFrom<(new Date).getDate()&&(console.log("Times what to remove: "+e.id),this.delTimeRange(e.id))}))},async editTimeTest(){const e={hoursFrom:1};await P.Z.updateOffer("6431407f53469b1f48eeb2f0",e)},async delTimeRange(e){const t=await P.Z.removeTimeOffer(this.provider.id,e);console.log("Is time removed? "+t.id),console.log("Aga id argumendina? "+e),this.providerTimes=this.providerTimes.filter((t=>t.id!==e)),this.times=[],this.markers=[],this.providerTimes.forEach((e=>{this.initializeTime(e)})),this.providerTimes.forEach((e=>{console.log("Provider times: "+e.dayFrom),this.setTimeMarkers(e)}))},onTimePickerOpen(){console.log("Timepicker opened")},alertFn(e){console.log("Opened "+e)},onClose(){console.log("On close...")},async handleDate(){console.log("Date handled!");const e={monthFrom:this.date[0].getMonth(),dayFrom:this.date[0].getDate(),hoursFrom:this.date[0].getHours(),minutesFrom:this.date[0].getMinutes(),monthTo:this.date[1].getMonth(),dayTo:this.date[1].getDate(),hoursTo:this.date[1].getHours(),minutesTo:this.date[1].getMinutes()},t=await P.Z.addAdditionalOffer(this.provider.id,e);this.providerTimes=this.providerTimes.concat(t),this.times=[],this.markers=[],this.providerTimes.forEach((e=>{this.initializeTime(e)})),this.providerTimes.forEach((e=>{console.log("Provider times: "+e.hoursFrom),this.setTimeMarkers(e)}))},handleTime(){console.log("Time is handled")},setMarkedDay(e){const t=e-(new Date).getDate();this.markedDays.push(e),console.log("Day to set_ "+t)},cancelTime(){console.log("Time cancelled!")},async addAvailableDate(){const e={monthFrom:this.date[0].getMonth(),dayFrom:this.date[0].getDate(),hoursFrom:this.date[0].getHours(),minutesFrom:this.date[0].getMinutes(),monthTo:this.date[1].getMonth(),dayTo:this.date[1].getDate(),hoursTo:this.date[1].getHours(),minutesTo:this.date[1].getMinutes()},t=await P.Z.addAdditionalOffer(this.provider.id,e);console.log("Saved? "+t)},initializeMarkers(e){this.contents.length>0&&this.markers.push({date:(0,_.Z)(new Date,e),type:"line",color:"orange",tooltip:this.contents})},setTimeMarkers(e){let t=null;this.contents=[],t=e.dayFrom-(new Date).getDate();let i=[];this.times.forEach(((s,o)=>{s[0].day===e.dayFrom&&(i=i.concat(e.id),this.contents.push({text:"Muokka",index:o,timeId:this.providerTimes[o].id,hFrom:s[0].hours,mFrom:s[0].minutes,hTo:s[1].hours,mTo:s[1].minutes,color:"orange"}),this.markers.push({date:(0,_.Z)(new Date,t),type:"line",color:"orange",tooltip:this.contents}))}))},async providerData(){console.log("User id in provider panel: "+this.userId);const e=await u.Z.getProvider(this.userId);e&&(this.provider=e,this.providerTimes=e.timeoffer,this.times=[],this.providerTimes.forEach((e=>{this.initializeTime(e)})),this.providerTimes.forEach((e=>{this.setTimeMarkers(e)}))),console.log("Saadud pakkuja: "+this.provider.id)},initializeTime(e){let t=[];t.push({day:e.dayFrom,hours:e.hoursFrom,minutes:e.minutesFrom},{day:e.dayTo,hours:e.hoursTo,minutes:e.minutesTo}),this.times.push(t)},test(e){console.log("What ever: "+e)}}};const H=(0,k.Z)(C,[["render",d]]);var x=H}}]);
//# sourceMappingURL=381.02e23f1b.js.map