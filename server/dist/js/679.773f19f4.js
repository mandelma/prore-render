"use strict";(self["webpackChunkprore_mongo"]=self["webpackChunkprore_mongo"]||[]).push([[679],{8405:function(e,i){const t=(e,i)=>{const t=new Date(e.y,e.m,e.d,e.hour,e.min),o=new Date(i.y,i.m,i.d,i.hour,i.min);return o>=t},o=(e,i,t)=>{const o=new Date(i.y,i.m,i.d,i.hour,i.min),s=new Date(t.y,t.m,t.d,t.hour,t.min);return e>=o&&e<s};i.A={compare:t,providerMatchingForClient:o}},5607:function(e,i,t){var o=t(6768);let s="";const a=()=>{var e=new google.maps.LatLng(60.233093,24.7531362),i=new google.maps.LatLng(60.2767265,24.8575089),t=new google.maps.DistanceMatrixService;t.getDistanceMatrix({origins:[e],destinations:[i],travelMode:"DRIVING",unitSystem:google.maps.UnitSystem.METRIC,durationInTraffic:!0,avoidHighways:!1,avoidTolls:!1},n)},n=(e,i)=>{if(i===google.maps.DistanceMatrixStatus.OK&&"OK"===i)return console.log("Distance "+e.rows[0].elements[0].distance.text),s=e.rows[0].elements[0].distance.text,"aaaaaaaaaaaaa";console.log("Error:",i),alert(i)},l=()=>(console.log("Is it working??"+s),(0,o.bF)("div",null,[(0,o.eW)("Hiiii")])),d=()=>{var e=new google.maps.LatLng(60.233093,24.7531362),i=new google.maps.LatLng(60.2767265,24.8575089);return(google.maps.geometry.spherical.computeDistanceBetween(e,i)/1e3).toFixed(2)};i.A={distance:a,test:l,theDist:d}},3060:function(e,i,t){t.r(i),t.d(i,{default:function(){return H}});var o=t(6768),s=t(4232),a=t(5130);const n={style:{display:"flex","justify-content":"right",padding:"20px"}},l={key:0,class:"expired_date"},d={key:0},r={key:1},g={key:0},c={key:0},u={key:1},h={key:0},m={key:1},k=["src","alt"],p={key:1,class:"edit-panel"},f=["onChange"],b={for:"file-upload",class:"custom-file-upload"},v={key:0},y={key:1},D=["src"],I={key:1,class:"add-panel"},C={for:"file-upload-x",class:"custom-file-upload"},_={key:0},A={key:1},w=["src"],E={key:0},P={class:"ui large form"},F={class:"field"},x={style:{"font-size":"14px"}},L={style:{"font-size":"14px"}},M={style:{"font-size":"14px"}},B={key:1};function S(e,i,S,X,U,W){const R=(0,o.g2)("recipientFinal"),T=(0,o.g2)("MDBContainer"),O=(0,o.g2)("MDBBtnClose"),z=(0,o.g2)("successMessage"),$=(0,o.g2)("MDBTextarea"),Q=(0,o.g2)("MDBCol"),V=(0,o.g2)("MDBRow"),j=(0,o.g2)("MDBBtn"),N=(0,o.g2)("VueDatePicker"),J=(0,o.g2)("MDBTable"),Y=(0,o.g2)("MDBBadge");return U.isProviderSelected?((0,o.uX)(),(0,o.Wv)(T,{key:0},{default:(0,o.k6)((()=>[(0,o.bF)(R,{"onCansel:final":W.handleCanselFinal,"onProvider:ordered":W.orderSuccess,test:S.test,provider:U.selectedProvider,offer:U.offer,proSlides:U.proSlides,room:U.room,available:U.availability,booking:S.booking,chatusers:S.chatusers,initialize_chat:e.handleInitializeChat,selecteduser:S.selecteduser,messages:S.messages,onMessage:W.onMessage,onSelect:W.selectUser,onNoSelect:W.noSelectUser,onJoin_chat_panel:W.handleJoinChatPanel},null,8,["onCansel:final","onProvider:ordered","test","provider","offer","proSlides","room","available","booking","chatusers","initialize_chat","selecteduser","messages","onMessage","onSelect","onNoSelect","onJoin_chat_panel"])])),_:1})):((0,o.uX)(),(0,o.Wv)(T,{key:1},{default:(0,o.k6)((()=>[(0,o.Lk)("div",n,[(0,o.bF)(O,{white:"",style:{cursor:"pointer"},onClick:W.canselResult},null,8,["onClick"])]),(0,o.Lk)("h2",null,"Tarvin tässä osaaja - "+(0,s.v_)(S.line),1),S.booking.created_ms-(new Date).getTime()<=0&&S.booking.offers.length<1?((0,o.uX)(),(0,o.CE)("h5",l," Päivämäärä on vanhentunut. Muokkaa päivämäärä tai poista tilaus! ")):(0,o.Q3)("",!0),(0,o.bF)(z,{message:U.orderMessage},null,8,["message"]),(0,o.bF)(V,{style:{"margin-top":"50px"}},{default:(0,o.k6)((()=>[(0,o.bF)(Q,null,{default:(0,o.k6)((()=>[(0,o.bF)(J,{border:"primary",style:{"font-size":"18px",color:"#dddddd","text-align":"left"}},{default:(0,o.k6)((()=>[(0,o.Lk)("tbody",null,[(0,o.Lk)("tr",null,[U.isEditDescription?((0,o.uX)(),(0,o.CE)("td",r,[(0,o.bF)(V,null,{default:(0,o.k6)((()=>[(0,o.bF)(Q,null,{default:(0,o.k6)((()=>[(0,o.bF)($,{label:"Muokkaa tehtävän kuvausta...",white:"",rows:"4",modelValue:U.description,"onUpdate:modelValue":i[0]||(i[0]=e=>U.description=e),style:{"font-size":"14px",padding:"20px"}},null,8,["modelValue"])])),_:1}),(0,o.bF)(Q,{col:"1"},{default:(0,o.k6)((()=>[(0,o.bF)(O,{white:"",onClick:i[1]||(i[1]=e=>U.isEditDescription=!1),style:{float:"right",cursor:"pointer"}})])),_:1})])),_:1})])):((0,o.uX)(),(0,o.CE)("td",d,(0,s.v_)(S.booking.description),1))]),S.booking.offers.length<1?((0,o.uX)(),(0,o.CE)("tr",g,[U.isEditDescription?((0,o.uX)(),(0,o.CE)("td",u,[(0,o.bF)(j,{outline:"info",block:"",size:"lg",onClick:W.saveEditedDescription},{default:(0,o.k6)((()=>i[8]||(i[8]=[(0,o.eW)("Tallenna tehtävän kuvaus")]))),_:1},8,["onClick"])])):((0,o.uX)(),(0,o.CE)("td",c,[(0,o.bF)(j,{outline:"info",block:"",size:"lg",onClick:W.pressedEditDescription},{default:(0,o.k6)((()=>i[7]||(i[7]=[(0,o.eW)("Muokkaa tehtävän kuvausta")]))),_:1},8,["onClick"])]))])):(0,o.Q3)("",!0),(0,o.Lk)("tr",null,[U.isEditDate?((0,o.uX)(),(0,o.CE)("td",m,[(0,o.bF)(V,null,{default:(0,o.k6)((()=>[(0,o.bF)(Q,{col:"8"},{default:(0,o.k6)((()=>[(0,o.Lk)("h3",{class:(0,s.C4)({expired_date:S.booking.created_ms-(new Date).getTime()<=0})},(0,s.v_)(U.bookingDateToDisplay),3),(0,o.bF)(N,{style:{"margin-bottom":"20px"},dark:"",modelValue:U.bookingDate,"onUpdate:modelValue":i[2]||(i[2]=e=>U.bookingDate=e),"min-date":new Date,placeholder:"Valitse sopivaa aika...",onInternalModelChange:W.handleInternalDate,state:!e.isNoDate&&null},null,8,["modelValue","min-date","onInternalModelChange","state"])])),_:1}),(0,o.bF)(Q,{col:"4"},{default:(0,o.k6)((()=>[(0,o.bF)(O,{white:"",onClick:i[3]||(i[3]=e=>U.isEditDate=!1),style:{float:"right",cursor:"pointer"}})])),_:1})])),_:1})])):((0,o.uX)(),(0,o.CE)("td",h,[(0,o.Lk)("h3",{class:(0,s.C4)({expired_date:S.booking.created_ms-(new Date).getTime()<=0&&S.booking.offers.length<1})},(0,s.v_)(U.bookingDateToDisplay),3),S.booking.offers.length<1?((0,o.uX)(),(0,o.Wv)(j,{key:0,block:"",size:"lg",outline:"info",onClick:W.editDate},{default:(0,o.k6)((()=>[(0,o.Lk)("span",{class:(0,s.C4)({expired_warning:S.booking.created_ms-(new Date).getTime()<=0})},"Muokkaa päivämäärä",2)])),_:1},8,["onClick"])):(0,o.Q3)("",!0)]))])])])),_:1}),((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(S.images,((e,a)=>((0,o.uX)(),(0,o.CE)("div",{key:a},[(0,o.Lk)("img",{class:"loading",style:{width:"100%"},src:e.blob?e.blob:t(9298)(`./${e.name}`),alt:e.name},null,8,k),U.isEditPanel?(0,o.Q3)("",!0):((0,o.uX)(),(0,o.Wv)(j,{key:0,block:"",outline:"success",onClick:e=>W.pressEditPanel(a)},{default:(0,o.k6)((()=>i[9]||(i[9]=[(0,o.eW)("Muokkaa kuva")]))),_:2},1032,["onClick"])),U.isEditPanel&&U.imageIndex===a?((0,o.uX)(),(0,o.CE)("div",p,[S.booking.offers.length<1?((0,o.uX)(),(0,o.Wv)(V,{key:0},{default:(0,o.k6)((()=>[(0,o.bF)(Q,null,{default:(0,o.k6)((()=>[U.value?(0,o.Q3)("",!0):((0,o.uX)(),(0,o.Wv)(O,{key:0,white:"",class:"close-btn",style:{float:"right"},onClick:W.closeEditPanel},null,8,["onClick"])),(0,o.Lk)("input",{id:"file-upload",type:"file",onChange:e=>W.handleFileChange(e,a)},null,40,f),(0,o.Lk)("label",b,[U.value?((0,o.uX)(),(0,o.CE)("span",v," Muokka tehtävän kuvausta: "+(0,s.v_)(U.value.name),1)):((0,o.uX)(),(0,o.CE)("span",y,"Valitse uusi kuva tehtävästä"))]),U.isEditImage?((0,o.uX)(),(0,o.Wv)(j,{key:1,block:"",color:"success",onClick:e=>W.uploadEditedImage(a)},{default:(0,o.k6)((()=>i[10]||(i[10]=[(0,o.eW)("Upload edited image")]))),_:2},1032,["onClick"])):(0,o.Q3)("",!0),(0,o.bF)(j,{class:"btn",block:"",size:"lg",color:"danger",onClick:e=>W.removeImg(a)},{default:(0,o.k6)((()=>i[11]||(i[11]=[(0,o.eW)("Poista kuva")]))),_:2},1032,["onClick"])])),_:2},1024),U.value?((0,o.uX)(),(0,o.Wv)(Q,{key:0},{default:(0,o.k6)((()=>[(0,o.bF)(O,{white:"",class:"close-btn",style:{float:"right"},onClick:W.closeEditPanel},null,8,["onClick"]),(0,o.Lk)("img",{style:{width:"100px","padding-top":"20px"},src:this.showImage,alt:"addEdit"},null,8,D)])),_:1})):(0,o.Q3)("",!0)])),_:2},1024)):(0,o.Q3)("",!0)])):(0,o.Q3)("",!0)])))),128)),!U.isPressedAddlmage&S.booking.offers.length<1?((0,o.uX)(),(0,o.Wv)(j,{key:0,block:"",color:"primary",onClick:W.pressedAddImage},{default:(0,o.k6)((()=>i[12]||(i[12]=[(0,o.eW)("Lisää uusi kuva tehtävästä")]))),_:1},8,["onClick"])):(0,o.Q3)("",!0),U.isPressedAddlmage&&U.isAddImagePanel?((0,o.uX)(),(0,o.CE)("div",I,[(0,o.bF)(V,null,{default:(0,o.k6)((()=>[(0,o.bF)(Q,null,{default:(0,o.k6)((()=>[U.value?(0,o.Q3)("",!0):((0,o.uX)(),(0,o.Wv)(O,{key:0,white:"",class:"close-btn",onClick:W.closeAddPanel},null,8,["onClick"])),(0,o.Lk)("input",{id:"file-upload-x",type:"file",onChange:i[4]||(i[4]=i=>W.handleFileChange(i,e.i))},null,32),(0,o.Lk)("label",C,[U.value?((0,o.uX)(),(0,o.CE)("span",_," Muokka tehtävän kuvausta: "+(0,s.v_)(U.value.name)+" + ",1)):((0,o.uX)(),(0,o.CE)("span",A,"Valitse lisää kuva tehtävästä"))]),U.isAddImage?((0,o.uX)(),(0,o.Wv)(j,{key:1,block:"",outline:"primary",onClick:W.addAdditionalImage},{default:(0,o.k6)((()=>i[13]||(i[13]=[(0,o.eW)("Tallenna kuva")]))),_:1},8,["onClick"])):(0,o.Q3)("",!0)])),_:1}),U.value?((0,o.uX)(),(0,o.Wv)(Q,{key:0},{default:(0,o.k6)((()=>[(0,o.bF)(O,{class:"close-btn",white:"",onClick:W.closeAddPanel},null,8,["onClick"]),(0,o.Lk)("img",{style:{width:"100px"},src:this.showImage,alt:"addShow"},null,8,w)])),_:1})):(0,o.Q3)("",!0)])),_:1})])):(0,o.Q3)("",!0)])),_:1}),(0,o.bF)(Q,{lg:"6"},{default:(0,o.k6)((()=>[S.booking_offers.length>0?((0,o.uX)(),(0,o.CE)("div",E,[(0,o.Lk)("div",P,[(0,o.Lk)("div",F,[i[15]||(i[15]=(0,o.Lk)("h3",{style:{"margin-bottom":"20px"}},"Tarjoukset",-1)),(0,o.bo)((0,o.Lk)("select",{style:{padding:"20px","background-color":"#3c3535",color:"lightgrey","font-size":"18px"},id:"listOfProviders","onUpdate:modelValue":i[5]||(i[5]=e=>U.filterResult=e),onClick:i[6]||(i[6]=(...e)=>W.addFilter&&W.addFilter(...e))},i[14]||(i[14]=[(0,o.Lk)("option",{value:""},"Suodata...",-1),(0,o.Lk)("option",{value:"distance"},"Etäisyyden mukaan - lähin ensin",-1),(0,o.Lk)("option",{value:"rating"},"positiivisen palauteen mukaan",-1)]),512),[[a.u1,U.filterResult]])])]),i[21]||(i[21]=(0,o.Lk)("br",null,null,-1)),(0,o.bF)(J,{style:{"font-size":"18px","text-align":"center",position:"relative"}},{default:(0,o.k6)((()=>[(0,o.Lk)("tbody",null,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(S.booking_offers,(e=>((0,o.uX)(),(0,o.CE)("tr",{key:e.id},[(0,o.Lk)("td",null,[(0,o.bF)(j,{class:"provider-selection",outline:"info",size:"lg",onClick:i=>W.getProviderInfo(e.provider,e,"orange")},{default:(0,o.k6)((()=>[(0,o.eW)((0,s.v_)(e.provider.yritys)+" ",1),i[16]||(i[16]=(0,o.Lk)("br",null,null,-1)),(0,o.Lk)("span",x,"Etäisyys: "+(0,s.v_)(e.distance)+" km",1),i[17]||(i[17]=(0,o.Lk)("br",null,null,-1))])),_:2},1032,["onClick"]),e.isNewOffer?((0,o.uX)(),(0,o.Wv)(Y,{key:0,color:"danger",class:"translate-middle p-4",pill:"",notification:""},{default:(0,o.k6)((()=>[(0,o.Lk)("span",L,[i[18]||(i[18]=(0,o.eW)(" uusi! ")),i[19]||(i[19]=(0,o.Lk)("br",null,null,-1)),(0,o.eW)((0,s.v_)(e.price)+" eur ",1)])])),_:2},1024)):((0,o.uX)(),(0,o.Wv)(Y,{key:1,color:"info",class:"translate-middle p-4",pill:"",notification:""},{default:(0,o.k6)((()=>[(0,o.Lk)("span",M,(0,s.v_)(e.price)+" eur ",1)])),_:2},1024))])])))),128)),i[20]||(i[20]=(0,o.Lk)("tr",null,null,-1))])])),_:1})])):((0,o.uX)(),(0,o.CE)("div",B,i[22]||(i[22]=[(0,o.Lk)("h2",{style:{width:"100%"}},"Odotetaan tarjouksia...",-1)])))])),_:1}),(0,o.bF)(j,{block:"",outline:"danger",size:"lg",onClick:W.removeOfferedBookings},{default:(0,o.k6)((()=>i[23]||(i[23]=[(0,o.eW)("Poista tilaus")]))),_:1},8,["onClick"])])),_:1})])),_:1}))}t(4114),t(4603),t(7566),t(8721);var X=t(5846),U=t(8405),W=t(4214),R=t(7337),T=t(5607),O=t(1769),z=t(2456),$=t(4474),Q=t(8068),V=t(407),j=t(1690),N={name:"recipient-panel-result",props:{test:Boolean,chatusers:Array,selecteduser:null,messages:Array,loggedInUser:Object,booking:null,booking_offers:[],images:Array,bookingTime:null,providers:Array,confirmedBookings:Array,line:String},data(){return{offer:null,chatUser:null,count:0,datetime:U.A,distance:T.A,selectedProvider:null,proSlides:[],isProviderSelected:!1,availability:"",orderMessage:null,isOrdered:!1,isEditDescription:!1,description:this.booking.description,isEditDate:!1,bookingDate:null,bookingDateToDisplay:this.booking.date,isAddFirstImage:!1,isPressedAddlmage:!1,isAddImage:!1,isAddImagePanel:!1,isEditImage:!1,isUploadImage:!1,isUploaded:!1,isImageCreated:!1,isAddNewImage:!1,isEditPanel:!1,value:null,imageIndex:0,file:null,isImageSelected:!1,isAdditionalImageSelected:!1,showImage:null,tempImages:[],imagesx:[],imagesxxx:[],room:"",roomUserCount:0,filterResult:""}},components:{successMessage:R.A,VueDatePicker:Q.A,dist:T.A,recipientFinal:W["default"],MDBBtn:X.al,MDBBtnClose:X.uR,MDBContainer:X.Dj,MDBTable:X.EU,MDBRow:X.gU,MDBCol:X.m6,MDBTextarea:X.QP,MDBIcon:X.$u,MDBBadge:X.nf},methods:{editDate(){this.isEditDate=!0},async handleInternalDate(){if(this.bookingDate){console.log("new date: "+new Date(this.bookingDate).getTime()),this.bookingDateToDisplay=this.bookingDate.getMonth()+1+"/"+this.bookingDate.getDate()+"/"+this.bookingDate.getFullYear(),console.log("eeeeee "+(this.bookingDate.getMonth()+1)+"/"+this.bookingDate.getDate()+"/"+this.bookingDate.getFullYear());const e=new Date(this.bookingDate).getTime();await V.A.newDate(this.booking.id,{year:this.bookingDate.getFullYear(),month:this.bookingDate.getMonth(),day:this.bookingDate.getDate(),hours:this.bookingDate.getHours(),minutes:this.bookingDate.getMinutes(),date_ms:e});const i={year:this.bookingDate.getFullYear(),month:this.bookingDate.getMonth(),day:this.bookingDate.getDate(),hours:this.bookingDate.getHours(),minutes:this.bookingDate.getMinutes()};this.$emit("updateBookingDate",this.booking,i)}console.log("Date is handled")},handleFileChange(e,i){console.log("i in file change "+i),this.imageIndex=i;try{const i=e.target.files[0];if(console.log("event target client ",e.target.files[0]),i){const t=URL.createObjectURL(i);this.tempImages.push(t),this.showImage=URL.createObjectURL(i),this.file=e.target.files[0],this.isAddImage=!0,this.isEditImage=!0}}catch(t){console.log("Error:",t)}this.value=e.target.files[0]},pressedAddImage(){this.isAddImage=!1,this.isEditImage=!1,this.isEditPanel=!1,this.isPressedAddlmage=!0,this.isAddImagePanel=!0},async addImage(){},pressEditPanel(e){this.isEditImage=!1,this.value=null,this.imageIndex=e,this.isEditPanel=!0,this.isAddImagePanel=!1},closeEditPanel(){this.isAddImagePanel=!1,this.isEditPanel=!1,this.isEditImage=!1,this.value=null},closeAddPanel(){this.isAddImagePanel=!1,this.isPressedAddlmage=!1,this.value=null},async uploadEditedImage(e,i){console.log("Edited image index is: "+e),this.isEditPanel=!1,this.isEditImage=!1;const t=new FormData;t.append("file",this.file,this.file.name),console.log("Image id "+this.images[e]._id);const o=await $.A.updateImage(this.images[e]._id,t);o&&(this.images[this.imageIndex]={_id:this.images[e]._id,blob:this.showImage},this.images.forEach((e=>{console.log("Image name "+e._id)})),console.log("New image id is "+o._id),this.imgId=o._id,this.file=null,this.isEditPanel=!1)},async addAdditionalImage(){this.value=null,this.isAddImagePanel=!1,this.isAddImage=!1,this.isPressedAddlmage=!1;const e=new FormData;e.append("file",this.file,this.file.name);const i=await $.A.create(e);if(await V.A.addImage(this.booking.id,i.imgCreated._id),i){const e={_id:i.imgCreated._id,blob:this.showImage};this.$emit("addImage",e,this.booking.id)}},async removeImg(e){this.images[e].blob||console.log("removed image is blob"),console.log("removable image id is "+this.images[e]._id),await V.A.removeImage(this.booking.id,this.images[e]._id),await $.A.remove(this.images[e]._id,this.booking.id),this.$emit("removeImage",e),this.isEditPanel=!1},getDistance(){console.log("sss "+T.A.test())},selectUser(e){this.$emit("select",e)},noSelectUser(){this.$emit("noSelect")},onMessage(e,i){this.$emit("message",e,i)},handleJoinChatPanel(){console.log("Final info in result pressed "),this.$emit("joinChatPanel",this.room)},async pressAddFirstImage(){this.isAddFirstImage=!0,this.imageIndex=0},pressAdditionalImage(e){this.isAddImage=!0,this.imageIndex=this.images.length,console.log("Images index = "+this.imageIndex),this.isAddImage=!0},async uploadFirstImage(e){const i=new FormData;this.isUploadImage=!0,this.imageIndex=0,i.append("file",this.file,this.file.name);const t=await $.A.create(i);if(await V.A.addImage(this.booking.id,t.imgCreated._id),t){this.file=null;const e={_id:t.imgCreated._id,image:t.imgCreated.image,name:t.imgCreated.name};this.$emit("addImage",e),this.imageIndex=0,this.isImageSelected=!1,this.isUploaded=!0}},async uploadAdditionalImage(){this.isAdditionalImageSelected=!1,this.isAddImage=!1,this.value=null,console.log("Image index index "+this.imageIndex);const e=new FormData;this.isUploadImage=!0,this.isUploaded=!0,e.append("file",this.file,this.file.name);const i=await $.A.create(e);if(await V.A.addImage(this.booking.id,i.imgCreated._id),i){this.file=null;const e={_id:i.imgCreated._id,image:i.imgCreated.image,name:i.imgCreated.name};this.$emit("addImage",e),this.isImageSelected=!1,this.isUploaded=!0}},pressedEditDescription(){this.isEditDescription=!0,console.log("Descripton: "+this.description)},saveEditedDescription(){this.isEditDescription=!1;const e={description:this.description};this.$emit("editDescription",this.description),V.A.editDescription(this.booking.id,e)},cancelEditDescription(){console.log("Is here something happening??")},providerGetBooking(e,i){console.log("Sended to user id... "+e),j.A.emit("accept provider",{id:e,booking:i})},async orderSuccess(e){if(this.booking.isIncludeOffers){this.canselResult(),this.$emit("offer_confirmed",this.booking);const i=await O.A.getProvByProvId(e.id);console.log("Offer confirmation user id "+i.user.id);this.selectedProvider.id;await V.A.updateRecipient(this.booking.id,{status:"confirmed"});this.booking.id;console.log("Username here???? "+this.booking.user.username);let t=[],o=[];this.booking&&(t=this.booking.offers);let s={};for(let e in t)console.log("Offer maker id "+t[e].provider.user.id),t[e].provider.user!==i.user.id?(o=o.concat(t[e]),await O.A.removeProviderBooking(t[e].provider.id,this.booking.id)):s=t[e];j.A.emit("confirm offer",i.user.id,this.booking,s),await z.A.deleteBookingOffers(this.booking.id),j.A.emit("deal done notification",o,this.booking,s)}else{this.isProviderSelected=!1,console.log("Provider id "+e.id),console.log("Recpient id: "+this.booking.id);this.selectedProvider.id;await V.A.addProviderData(this.booking.id,this.selectedProvider.id);await V.A.updateRecipient(this.booking.id,{status:"notSeen"});const i=this.booking.id,t=await O.A.addProviderBooking(e.id,i);if("Recipient is added!"===t){const i={status:"",userID:e.user.id,name:e.user.username,room:this.room};this.$emit("client:confirmed_provider",e.id,this.booking,i),this.roomToDb(e.id,{userID:this.booking.user.id,client:this.booking.user.username,room:this.room});const t=e.user.id;j.A.emit("accept provider",{id:t,booking:this.booking})}this.handleJoinChatPanel()}},async orderSuccess_standing(e){this.isProviderSelected=!1,console.log("Provider id "+e.id),console.log("Recpient id: "+this.booking.id),this.canselResult(),this.$emit("offer_confirmed",this.booking);this.selectedProvider.id,await V.A.updateRecipient(this.booking.id,{status:"confirmed"}),this.booking.id},getProviderInfo(e,i,o){this.proSlides=[],this.offer=i,this.selectedProvider=e,this.booking.isIncludeOffers&&i.isNewOffer&&this.$emit("editBookingOfferStatus",i),e.reference.forEach((e=>{this.proSlides=[...this.proSlides,{id:e.id,size:"1400-933",src:t(3906)(`./${e.name}`),thumb:t(3906)(`./${e.name}`),subHtml:'<div class="lightGallery-captions">\n                <h2>Terve</h2>\n\n            </div>"'}]})),this.availability=o,this.isProviderSelected=!0;let s="",a="";this.chatUser&&(a=this.chatUser.username,s=e.yritys+a,this.room=s)},async roomToDb(e,i){await O.A.addRoom(e,i)},addFilter(){const e=document.getElementById("listOfProviders");e.addEventListener("change",(e=>{console.log("Filtered provider: "+e.target.value),this.$emit("filter_provider",e.target.value)}))},handleCanselFinal(e){this.isProviderSelected=e},canselResult(){this.$emit("cansel:result",!1)},async removeOfferedBookings(){if(!0===confirm("Oletko varmaa, että haluat poistaa tilauksen!?")){this.booking.ordered.map((e=>{console.log("Ord "+e.user.id)}));const e=await V.A.getBookingById(this.booking.id),i=e.user.username;let t=[],o=[];console.log("booking username is "+e.user.username),console.log("You pressed OK!");let s=[],a=[],n=[];this.booking&&(n=this.booking.ordered,s=this.booking.offers),console.log("All matched providers length "+n.length);for(let l in n)console.log("zzzz "+n[l].user.id),console.log("Room ------ "+n[l].yritys+i),t=[...t,{id:n[l].user.id,room:n[l].yritys+i}],await O.A.removeProviderBooking(n[l].id,this.booking.id);for(let l in s)o=[...o,s[l].yritys+i],a=a.concat({id:s[l].provider.user,room:s[l].room}),await O.A.removeProviderBooking(s[l].provider.id,this.booking.id);j.A.emit("notice about cansel order",t,a,this.booking),this.$emit("removeOfferedBooking",this.booking.id,t)}else console.log("You canceled!");this.images.forEach((e=>{console.log("Images ## "+e._id),$.A.cleanAllRecipientImages(e._id)}))}},async mounted(){const e=window.localStorage.getItem("loggedAppUser");if(e){const i=JSON.parse(e);this.chatUser=i}}},J=t(1241);const Y=(0,J.A)(N,[["render",S],["__scopeId","data-v-0979271c"]]);var H=Y}}]);
//# sourceMappingURL=679.773f19f4.js.map