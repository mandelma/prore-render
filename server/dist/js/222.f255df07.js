"use strict";(self["webpackChunkprore_mongo"]=self["webpackChunkprore_mongo"]||[]).push([[222],{2222:function(e,t,l){l.r(t),l.d(t,{default:function(){return V}});l(7658);var s=l(3396),n=l(7139);const i=e=>((0,s.dD)("data-v-a875f7ec"),e=e(),(0,s.Cn)(),e),a={key:0,class:"spinner-border",role:"status"},d=i((()=>(0,s._)("span",{class:"visually-hidden"},"Loading...",-1))),r=[d],o={key:1},u=i((()=>(0,s._)("i",{class:"fas fa-user"},null,-1))),g={style:{border:"solid blue",float:"right",padding:"10px",width:"100%"}},c={key:0,class:"spinner-border",role:"status"},m=i((()=>(0,s._)("span",{class:"visually-hidden"},"Loading...",-1))),p=[m],f={key:1},h={key:0},_={key:1},w=i((()=>(0,s._)("td",null," Etunimi: ",-1))),D=i((()=>(0,s._)("td",null," Sukunimi: ",-1))),k=i((()=>(0,s._)("td",null," Käyttäjätunnus: ",-1))),y=i((()=>(0,s._)("td",null," Osoite: ",-1))),B=i((()=>(0,s._)("tr",null,[(0,s._)("td",null," Sähköposti "),(0,s._)("td",null," test.test@test.ee ")],-1))),v={colspan:"2"};function P(e,t,l,i,d,m){const P=(0,s.up)("MDBIcon"),U=(0,s.up)("MDBCol"),b=(0,s.up)("MDBRow"),M=(0,s.up)("MDBBtn"),I=(0,s.up)("MDBTable"),E=(0,s.up)("edit-profile"),C=(0,s.up)("MDBContainer");return(0,s.wg)(),(0,s.iD)(s.HY,null,[(0,s.Wm)(C,{style:{"margin-top":"50px"}},{default:(0,s.w5)((()=>[d.pro.yritys&&d.client?((0,s.wg)(),(0,s.iD)("div",o,[(0,s.Wm)(b,null,{default:(0,s.w5)((()=>[(0,s.Wm)(U,null,{default:(0,s.w5)((()=>[(0,s.Wm)(U,{lg:"6"},{default:(0,s.w5)((()=>[(0,s.Wm)(b,null,{default:(0,s.w5)((()=>[(0,s.Wm)(U,null,{default:(0,s.w5)((()=>[(0,s.Wm)(P,{size:"5x",style:{padding:"20px 0"}},{default:(0,s.w5)((()=>[u])),_:1})])),_:1}),(0,s.Wm)(U,null,{default:(0,s.w5)((()=>[(0,s._)("div",g,[d.pro?((0,s.wg)(),(0,s.iD)("div",f,[d.pro?((0,s.wg)(),(0,s.iD)("h3",h,"TMI "+(0,n.zw)(d.pro.yritys),1)):(0,s.kq)("",!0),d.client?((0,s.wg)(),(0,s.iD)("h3",_,"Sinulla on varauksia ("+(0,n.zw)(d.client.length)+")",1)):(0,s.kq)("",!0)])):((0,s.wg)(),(0,s.iD)("div",c,p))])])),_:1})])),_:1})])),_:1})])),_:1}),(0,s.Wm)(U,{lg:"8"},{default:(0,s.w5)((()=>[d.isPressedEditProfile?((0,s.wg)(),(0,s.j4)(E,{key:1,loggedInUser:l.loggedInUser,userData:d.userData,onGoBackFromEditProfile:m.handleCloseEditProfile,onSaveAddress:m.handleSaveAddress},null,8,["loggedInUser","userData","onGoBackFromEditProfile","onSaveAddress"])):((0,s.wg)(),(0,s.j4)(I,{key:0,borderless:"",style:{"font-size":"14px","text-align":"left"}},{default:(0,s.w5)((()=>[(0,s._)("tbody",null,[(0,s._)("tr",null,[w,(0,s._)("td",null,(0,n.zw)(d.userData.firstName),1)]),(0,s._)("tr",null,[D,(0,s._)("td",null,(0,n.zw)(l.loggedInUser.lastName),1)]),(0,s._)("tr",null,[k,(0,s._)("td",null,(0,n.zw)(l.loggedInUser.username),1)]),(0,s._)("tr",null,[y,(0,s._)("td",null,(0,n.zw)(d.userData.address),1)]),B,(0,s._)("tr",null,[(0,s._)("td",v,[(0,s.Wm)(M,{block:"",size:"lg",color:"success",onClick:m.pressedEditProfile},{default:(0,s.w5)((()=>[(0,s.Uk)("Muokkaa tiotosi")])),_:1},8,["onClick"])])])])])),_:1}))])),_:1})])),_:1})])):((0,s.wg)(),(0,s.iD)("div",a,r))])),_:1}),(0,s._)("div",null,[(0,s.Wm)(C,null,{default:(0,s.w5)((()=>[(0,s.Wm)(M,{outline:"danger",block:"",size:"lg",onClick:t[0]||(t[0]=t=>e.$router.push("/"))},{default:(0,s.w5)((()=>[(0,s.Uk)("Poistu sivulta")])),_:1})])),_:1})])],64)}var U=l(4313);const b=(0,s._)("td",null," Etunimi: ",-1),M=(0,s._)("td",null," Sukunimi: ",-1),I=(0,s._)("td",null," Käyttäjätunnus: ",-1),E=(0,s._)("td",null," Osoite ",-1),C=(0,s._)("td",null," Sähköposti ",-1),W={colspan:"2"};function z(e,t,l,i,a,d){const r=(0,s.up)("MDBBtnClose"),o=(0,s.up)("MDBInput"),u=(0,s.up)("MDBBtn"),g=(0,s.up)("MDBTable"),c=(0,s.up)("MDBContainer");return(0,s.wg)(),(0,s.iD)(s.HY,null,[(0,s.Wm)(r,{style:{float:"right",cursor:"pointer"},onClick:d.closeEditProfile},null,8,["onClick"]),(0,s.Wm)(c,null,{default:(0,s.w5)((()=>[(0,s.Wm)(g,{borderless:"",style:{"font-size":"14px","text-align":"left"}},{default:(0,s.w5)((()=>[(0,s._)("tbody",null,[(0,s._)("tr",null,[b,(0,s._)("td",null,(0,n.zw)(l.loggedInUser.firstName),1)]),(0,s._)("tr",null,[M,(0,s._)("td",null,(0,n.zw)(l.loggedInUser.lastName),1)]),(0,s._)("tr",null,[I,(0,s._)("td",null,(0,n.zw)(l.loggedInUser.username),1)]),(0,s._)("tr",null,[E,(0,s._)("td",null,[(0,s.Uk)((0,n.zw)(l.userData.address)+" ",1),(0,s.Wm)(o,{id:"address",label:"Anna uusi osoitteesi",modelValue:a.newAddress,"onUpdate:modelValue":t[0]||(t[0]=e=>a.newAddress=e)},null,8,["modelValue"])])]),(0,s._)("tr",null,[C,(0,s._)("td",null,[(0,s.Wm)(o,{label:"mail",modelValue:a.mail,"onUpdate:modelValue":t[1]||(t[1]=e=>a.mail=e)},null,8,["modelValue"])])]),(0,s._)("tr",null,[(0,s._)("td",W,[(0,s.Wm)(u,{block:"",size:"lg",color:"success",onClick:d.saveProfileData},{default:(0,s.w5)((()=>[(0,s.Uk)("Tallenna tiedot")])),_:1},8,["onClick"])])])])])),_:1})])),_:1})],64)}var A={name:"EditProfile",props:{loggedInUser:Object,userData:Object},components:{MDBContainer:U.L5,MDBInput:U.u2,MDBBtnClose:U.Ok,MDBBtn:U.$v,MDBTable:U.re},data(){return{lat:null,long:null,address:null,mail:"",newAddress:""}},mounted(){const e={lat:50.064192,lng:-130.605469},t={north:e.lat+.1,south:e.lat-.1,east:e.lng+.1,west:e.lng-.1},l=document.getElementById("address"),s={bounds:t,componentRestrictions:{country:"fi"},fields:["address_components","geometry","icon","name","formatted_address"],strictBounds:!1},n=new google.maps.places.Autocomplete(l,s);n.addListener("place_changed",(()=>{let e=n.getPlace();this.lat=e.geometry.location.lat(),this.long=e.geometry.location.lng(),this.address=e.formatted_address,console.log(e)}))},methods:{closeEditProfile(){this.$emit("goBackFromEditProfile")},saveProfileData(){const e={latitude:this.lat,longitude:this.long,address:this.address};this.$emit("saveAddress",e)}}},N=l(89);const S=(0,N.Z)(A,[["render",z]]);var j=S,x=l(9398),O=l(5800),T={name:"user-profile",props:{loggedInUser:Object,provider:Object,recipient:Array},components:{editProfile:j,MDBContainer:U.L5,MDBTable:U.re,MDBBtn:U.$v,MDBRow:U.uZ,MDBCol:U.TK,MDBIcon:U.vm},data(){return{userData:{},isPressedEditProfile:!1,isEditData:!1,pro:{},client:[],mail:"",address:"",osoite:null,lat:null,long:null}},mounted(){const e=window.localStorage.getItem("loggedAppUser");if(e){this.getUserPro(),this.getUserRecipient();let e="";this.pro?e=this.pro.address:this.client,this.userData={firstName:this.loggedInUser.firstName,address:e}}else this.$router.push("/")},methods:{async getUserPro(){const e=await x.Z.getProvider(this.loggedInUser.id);e&&(this.pro=e),this.userData={firstName:this.loggedInUser.firstName,address:e.address}},async getUserRecipient(){const e=await O.Z.getOwnBookings(this.loggedInUser.id);e.length>0&&(this.client=e,this.userData={firstName:this.loggedInUser.firstName,address:e[0].address})},pressedEditProfile(){this.isPressedEditProfile=!0},handleSaveProfileData(){},getPro(e){setTimeout((()=>{e.yritys?this.pro=e:this.pro=null}),2e3)},async handleSaveAddress(e){if(this.pro&&(await x.Z.editAddress(this.pro.id,e),this.userData.address=e.address,this.isPressedEditProfile=!1),this.client.length>0)for(let t in this.client){const l=this.client[t].id;await O.Z.editBookingAddress(l,e)}},saveEditedName(){this.userData.firstName=this.name,this.isEditName=!1},handleCloseEditProfile(){this.isPressedEditProfile=!1}}};const Z=(0,N.Z)(T,[["render",P],["__scopeId","data-v-a875f7ec"]]);var V=Z}}]);
//# sourceMappingURL=222.f255df07.js.map