(function(){var e={5253:function(e,t){"use strict";const n=({num:e})=>{let t="";switch(5===e&&(t="Mis siis"),e){case 0:t="Tammikuu";break;case 1:t="Helmikuu";break;case 2:t="Maaliskuu";break;case 3:t="Huhtikuu";break;case 4:t="Toukokuu";break;case 5:t="Kesäkuu";break;case 6:t="Heinäkuu";break;case 7:t="Elokuu";break;case 8:t="Syyskuu";break;case 9:t="Lokakuu";break;case 10:t="Maaliskuu";break;case 11:t="Joulukuu";break}return t};t.Z=n},1447:function(e,t,n){"use strict";var o=n(9242),s=n(3396),i=n(7139);const r={class:"pill"};function a(e,t,n,o,a,l){const c=(0,s.up)("MDBNavbarBrand"),u=(0,s.up)("router-link"),d=(0,s.up)("MDBNavbarToggler"),g=(0,s.up)("MDBNavbarNav"),m=(0,s.up)("MDBCollapse"),p=(0,s.up)("MDBNavbarItem"),h=(0,s.up)("MDBIcon"),f=(0,s.up)("MDBBadge"),v=(0,s.up)("MDBDropdownToggle"),k=(0,s.up)("MDBDropdownItem"),b=(0,s.up)("MDBDropdownMenu"),w=(0,s.up)("MDBDropdown"),y=(0,s.up)("MDBNavbar"),B=(0,s.up)("Notifications"),D=(0,s.up)("router-view");return(0,s.wg)(),(0,s.iD)(s.HY,null,[(0,s.Wm)(y,{size:"large",style:{position:"fixed","z-index":"1"},position:"top",container:"",expand:"xl",bg:"light",class:"d-flex justify-content-between"},{default:(0,s.w5)((()=>[(0,s.Wm)(u,{to:"/"},{default:(0,s.w5)((()=>[(0,s.Wm)(c,null,{default:(0,s.w5)((()=>[(0,s.Uk)(" Pro Connections ")])),_:1})])),_:1}),(0,s.Wm)(d,{right:"",target:"#navbarColor01",onClick:t[0]||(t[0]=e=>o.collapse7=!o.collapse7)}),(0,s.Wm)(m,{id:"navbarColor01",modelValue:o.collapse7,"onUpdate:modelValue":t[1]||(t[1]=e=>o.collapse7=e)},{default:(0,s.w5)((()=>[(0,s.Wm)(g,{center:"",class:"mb-2 mb-lg-0"})])),_:1},8,["modelValue"]),void 0===a.loggedUser.token?((0,s.wg)(),(0,s.j4)(g,{key:0,right:"",class:"mb-2 mb-lg-0 d-flex flex-row"},{default:(0,s.w5)((()=>[(0,s.Wm)(p,null,{default:(0,s.w5)((()=>[(0,s.Wm)(u,{to:"/login",onClick:t[2]||(t[2]=e=>o.collapse7=!1)},{default:(0,s.w5)((()=>[(0,s.Uk)("Kirjaudu")])),_:1})])),_:1})])),_:1})):((0,s.wg)(),(0,s.j4)(g,{key:1,right:"",class:"mb-2 mb-lg-0 d-flex flex-row"},{default:(0,s.w5)((()=>[a.providerBookings.length>0?((0,s.wg)(),(0,s.j4)(p,{key:0,to:"",class:"me-3 me-lg-0",linkClass:"link-secondary",style:{padding:"10px"}},{default:(0,s.w5)((()=>[a.isBell?((0,s.wg)(),(0,s.j4)(h,{key:0,icon:"bell",size:"2x",disabled:!0,onClick:l.handleNotifications},null,8,["onClick"])):(0,s.kq)("",!0),a.notSeenClientBookings.length>0?((0,s.wg)(),(0,s.j4)(f,{key:1,notification:"",color:"danger",class:"translate-middle p-2",onClick:l.handleNotifications,pill:""},{default:(0,s.w5)((()=>[(0,s._)("span",r,(0,i.zw)(a.notSeenClientBookings.length),1)])),_:1},8,["onClick"])):((0,s.wg)(),(0,s.j4)(f,{key:2,notification:"",color:"danger",class:"translate-middle p-3",pill:""}))])),_:1})):(0,s.kq)("",!0),(0,s.Wm)(w,{modelValue:o.dropdownUser,"onUpdate:modelValue":t[4]||(t[4]=e=>o.dropdownUser=e),style:{padding:"10px"}},{default:(0,s.w5)((()=>[(0,s.Wm)(v,{tag:"a",class:"nav-link",onClick:t[3]||(t[3]=e=>o.dropdownUser=!o.dropdownUser)},{default:(0,s.w5)((()=>[(0,s.Wm)(h,{icon:"user",size:"2x"})])),_:1}),(0,s.Wm)(b,null,{default:(0,s.w5)((()=>[(0,s.Wm)(k,{onClick:l.profile,href:"#"},{default:(0,s.w5)((()=>[(0,s.Uk)(" Omat tiedot ")])),_:1},8,["onClick"]),a.recipientBookings.length>0?((0,s.wg)(),(0,s.j4)(k,{key:0,href:"#",onClick:l.history},{default:(0,s.w5)((()=>[(0,s.Uk)(" Historia ")])),_:1},8,["onClick"])):(0,s.kq)("",!0),(0,s.Wm)(k,{href:"#",onClick:l.handleLogOut},{default:(0,s.w5)((()=>[(0,s.Uk)(" Log out ")])),_:1},8,["onClick"])])),_:1})])),_:1},8,["modelValue"])])),_:1}))])),_:1}),a.isNotification?((0,s.wg)(),(0,s.j4)(B,{key:0,"onExit:notifications":l.handleExitNotifications,"onUpdate:status":l.handleStatusUpdate,bookings:a.providerBookings},null,8,["onExit:notifications","onUpdate:status","bookings"])):(0,s.kq)("",!0),(0,s.Wm)(D,{"onLogin:data":l.handleLogin,"onRegister:data":l.createUser,userIsProvider:a.userIsProvider,loggedInUser:a.loggedUser,recipientBookings:a.recipientBookings,"onBooking:update":l.handleRecipientBookingsUpdate,"onExit:notifications":l.handleExitNotifications,"onUpdate:status":l.handleStatusUpdate,"onRemove:booking":l.handleRemoveBooking,"onActivate:bell":l.handleActivateBell,"onDeactivate:bell":l.handleDeActivateBell,bookings:a.providerBookings,bookingsConfirmed:a.providerBookingsHistory,recipientConfirmedBookings:a.recipientConfirmedBookings,tere:"Tere"},null,8,["onLogin:data","onRegister:data","userIsProvider","loggedInUser","recipientBookings","onBooking:update","onExit:notifications","onUpdate:status","onRemove:booking","onActivate:bell","onDeactivate:bell","bookings","bookingsConfirmed","recipientConfirmedBookings"])],64)}n(7658);var l=n(1319);const c=n(7218),u="/api/users",d=async()=>{const e=await c.get(u);return e.data},g=async e=>{const t=await c.post(`${u}`,e);return t.data};var m={getAll:d,addUser:g},p=n(9398),h=n(5800);const f=n(7218),v="/api/login",k=async e=>{const t=await f.post(v,e);return t.data},b=async e=>{const t=await f.post(`${v}/${e}`);return t.data};var w={login:k,verifyToken:b};const y=async()=>{const e=window.localStorage.getItem("loggedAppUser");if(e){console.log("Tooooken 0 "+e);const t=JSON.parse(e).token,n=await w.verifyToken(t);return!n}};var B={validation:y},D=n(4313),U=n(4870),I={name:"App",components:{Notifications:l["default"],MDBNavbar:D.A0,MDBCollapse:D.Eq,MDBNavbarItem:D.V$,MDBNavbarBrand:D.JI,MDBNavbarNav:D.T2,MDBNavbarToggler:D.$Y,MDBBadge:D.m_,MDBIcon:D.vm,MDBDropdown:D.H6,MDBDropdownToggle:D.CU,MDBDropdownMenu:D.Ed,MDBDropdownItem:D.i2},data(){return{users:[],isBell:!1,loggedUser:{},recipientBookings:[],userIsProvider:{},providerBookings:[],providerBookingsHistory:[],recipientConfirmedBookings:[],isNotification:!1,notSeenClientBookings:[]}},created(){this.validateToken()},async mounted(){},setup(){const e=(0,U.iH)(!1),t=(0,U.iH)(!1),n=(0,U.iH)(!1);return{collapse7:e,dropdownUser:t,dropdownBell:n}},methods:{handleActivateBell(e){console.log("Bell bell bell"+e),this.isBell=e},handleDeActivateBell(){},profile(){this.$router.push("/profile")},history(){this.$router.push("/history")},renderPage(){this.$router.push({path:"/chat"})},renderDialogPage(){this.$router.push({path:"/dialog"}).then((()=>{this.$router.go()}))},reload:()=>{(void 0).isRouterAlive=!1,setTimeout((()=>{(void 0).isRouterAlive=!0}),0)},async getUsers(){this.users=await m.getAll()},async createUser(e){console.log("User name is here: "+e.firstName),await m.addUser(e);const t=await w.login({username:e.username,password:e.password});window.localStorage.setItem("loggedAppUser",JSON.stringify(t)),this.loggedUser=t,this.$router.push("/")},async handleLogin(e){let t;console.log("userdata: "+e.username),""!==e.username&&""!==e.password&&(t=await w.login(e),window.localStorage.setItem("loggedAppUser",JSON.stringify(t)),this.loggedUser=t),this.$route.query.redirect?this.$router.push(this.$route.query.redirect):this.$router.push("/")},handleLogOut(){window.localStorage.removeItem("loggedAppUser"),this.loginUser="",this.loggedUser="",this.$router.push("/")},async handleProvider(){this.userIsProvider=await p.Z.getProvider(this.loggedUser.id),this.userIsProvider&&(this.providerBookings=this.userIsProvider.booking.filter((e=>"confirmed"!==e.status)),this.providerBookingsHistory=this.userIsProvider.booking.filter((e=>"confirmed"===e.status))),this.providerBookings.forEach((e=>{"notSeen"===e.status&&(this.notSeenClientBookings=this.notSeenClientBookings.concat(e))}))},async handleRecipientBookings(){this.recipientBookings=await h.Z.getOwnBookings(this.loggedUser.id),this.recipientConfirmedBookings=this.recipientBookings.filter((e=>"confirmed"===e.status))},handleRecipientBookingsUpdate(e){this.recipientBookings=this.recipientBookings.concat(e)},handleNotifications(){this.$router.push("/notification")},handleExitNotifications(e){console.log("State is: "+e),this.isNotification=e},handleStatusUpdate(e){this.notSeenClientBookings=this.notSeenClientBookings.filter((t=>t.id!==e?t:null)),this.handleProvider()},handleRemoveBooking(e){console.log("Handling remove booking..."+e),location.reload()},test(){console.log("xxxx "+B)},async validateToken(){const e=window.localStorage.getItem("loggedAppUser");if(e){const t=JSON.parse(e),n=await w.verifyToken(t.token);"token expired"===n.result?(window.localStorage.removeItem("loggedAppUser"),this.loggedUser=""):(this.loggedUser=t,console.log("Loged, logged user "+this.loggedUser.username),this.handleRecipientBookings(),this.handleProvider())}},runEveryMinite(){alert("The minute has passed!!")}}},M=n(89);const C=(0,M.Z)(I,[["render",a]]);var S=C,_=n(2483);const Z=[{path:"/",name:"dash-board",component:()=>n.e(367).then(n.bind(n,8367))},{path:"/register",name:"app-register",component:()=>n.e(697).then(n.bind(n,4697))},{path:"/login",name:"login-register",component:()=>n.e(674).then(n.bind(n,4674))},{path:"/profile",name:"user-profile",component:()=>n.e(382).then(n.bind(n,8382))},{path:"/recipient-public",name:"recipient-public",component:()=>Promise.all([n.e(161),n.e(29)]).then(n.bind(n,1029))},{path:"/recipient-form",name:"recipient-form",component:()=>n.e(608).then(n.bind(n,3608)),beforeEnter:async(e,t,n)=>{const o=window.localStorage.getItem("loggedAppUser"),s=JSON.parse(o),i=await h.Z.getOwnBookings(s.id);if(i.length>0)return n("/received");n()},meta:{requiresAuth:!0}},{path:"/received",name:"recipient-panel",component:()=>Promise.all([n.e(629),n.e(133)]).then(n.bind(n,9127))},{path:"/recipient-result",name:"recipient-result",component:()=>Promise.all([n.e(629),n.e(51)]).then(n.bind(n,7629))},{path:"/received-final/:data",name:"recipient-final",component:()=>n.e(346).then(n.bind(n,7346)),props:!0},{path:"/rf",name:"r-form",component:()=>n.e(608).then(n.bind(n,3608))},{path:"/provider-public",name:"provider-public",component:()=>Promise.all([n.e(161),n.e(82)]).then(n.bind(n,82)),beforeEnter:async(e,t,n)=>{const o=window.localStorage.getItem("loggedAppUser");if(!o)return n();{const e=JSON.parse(o),t=await p.Z.getProvider(e.id);if(t)return n("/provider-panel");n()}}},{path:"/provider-form",name:"provider-form",component:()=>Promise.all([n.e(161),n.e(352)]).then(n.bind(n,5352)),beforeEnter:async(e,t,n)=>{const o=window.localStorage.getItem("loggedAppUser"),s=JSON.parse(o),i=await p.Z.getProvider(s.id);if(i)return n("/provider-panel");n()}},{path:"/provider-panel",name:"provider-panel",component:()=>n.e(896).then(n.bind(n,9896)),props:!0},{path:"/location",name:"user-location",component:()=>Promise.all([n.e(161),n.e(320)]).then(n.bind(n,6320))},{path:"/notification",name:"client-notifications",component:()=>Promise.resolve().then(n.bind(n,1319))},{path:"/chat",name:"chat-panel",component:()=>Promise.resolve().then(n.bind(n,1845))},{path:"/dialog",name:"user-dialog",component:()=>n.e(558).then(n.bind(n,3558))},{path:"/history",name:"user-history",component:()=>n.e(901).then(n.bind(n,1901))}],P=["recipient-form","provider-form"],N=(0,_.p7)({history:(0,_.PO)(),routes:Z});N.beforeEach((async(e,t,n)=>{const o=window.localStorage.getItem("loggedAppUser");if(o){JSON.parse(o)}const s=P.includes(e.name);s&&!o?n({path:"/login",query:{redirect:e.fullPath}}):n()}));var O=N,$=n(4912),T=n(966);(0,o.ri)(S).component("VueDatePicker",$.Z),(0,o.ri)(S).use(O).use(T.ZP).mount("#app")},9398:function(e,t,n){"use strict";const o=n(7218),s="/api/providers",i=async()=>{const e=await o.get(s);return e.data},r=async e=>{const t=await o.get(`${s}/${e}`);return t.data},a=async e=>{const t=await o.post(`${s}/profession`,e);return t.data},l=async(e,t)=>{const n=await o.post(`${s}/${e}`,t);return n.data},c=async(e,t)=>{const n=await o.post(`${s}/${e}/addRoom`,t);return n.data},u=async(e,t)=>{const n=await o.post(`${s}/${e}/addRecipient/${t}`);return n.data},d=async(e,t)=>{const n=await o.put(`${s}/${e}`,t);return n.data},g=async(e,t)=>{const n=await o.delete(`${s}/${e}/recipient/${t}`);return n.data};t.Z={getProviders:i,getProvider:r,getProvidersMatchingByProfession:a,addProvider:l,updateProvider:d,addRoom:c,addProviderBooking:u,removeProviderBooking:g}},5800:function(e,t,n){"use strict";const o=n(7218),s="/api/recipients",i=async()=>{const e=await o.get(s);return e.data},r=async e=>{const t=await o.get(`${s}/user/${e}`);return t.data},a=async e=>{const t=await o.get(`${s}/booking/${e}`);return t.data},l=async(e,t)=>{const n=await o.post(`${s}/${e}`,t);return n.data},c=async(e,t)=>{const n=await o.put(`${s}/${e}`,t);return n.data};t.Z={getRecipients:i,getOwnBookings:r,getBookingById:a,addRecipient:l,updateRecipient:c}},4058:function(e,t,n){"use strict";var o=n(2066);const s="https://line-app-q9oo.onrender.com",i={"force new connection":!0,reconnectionAttempts:"Infinity",timeout:1e4,transports:["websocket"]},r=o.io.connect(s,i);r.onAny(((e,...t)=>{console.log(e,t)})),t.Z=r},1245:function(e,t,n){"use strict";n.d(t,{Z:function(){return O}});var o=n(3396);const s={class:"scrolling-wrapper"};function i(e,t,n,i,r,a){const l=(0,o.up)("user"),c=(0,o.up)("message-panel");return(0,o.wg)(),(0,o.iD)("div",null,[(0,o._)("div",s,[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(r.users,(t=>((0,o.wg)(),(0,o.iD)("div",{class:"card",key:t.userID},[(0,o._)("p",null,[(0,o.Wm)(l,{user:t,firstUser:e.userFirst,selected:r.selectedUser===t,onSelect:e=>a.onSelectUser(t)},null,8,["user","firstUser","selected","onSelect"])])])))),128))]),r.selectedUser?((0,o.wg)(),(0,o.j4)(c,{key:0,user:r.selectedUser,initMessages:r.initMessages,"onNew:message":a.onMessage},null,8,["user","initMessages","onNew:message"])):(0,o.kq)("",!0)])}n(7658);var r=n(4058),a=n(7139);const l={class:"description"},c={class:"name"},u={key:0,class:"new-messages"};function d(e,t,n,s,i,r){const d=(0,o.up)("MDBBtn"),g=(0,o.up)("MDBBadge");return(0,o.wg)(),(0,o.iD)("div",{class:(0,a.C_)(["user",{selected:n.selected}]),onClick:t[0]||(t[0]=(...e)=>r.onClick&&r.onClick(...e))},[(0,o._)("div",l,[(0,o._)("div",c,[(0,o.Wm)(d,null,{default:(0,o.w5)((()=>[(0,o.Uk)((0,a.zw)(n.user.username)+" "+(0,a.zw)(n.user.self?" (Mina)":"")+" ",1),n.user.hasNewMessages?((0,o.wg)(),(0,o.iD)("div",u,"!")):(0,o.kq)("",!0)])),_:1}),n.user.connected?((0,o.wg)(),(0,o.j4)(g,{key:0,badge:"success",class:"translate-middle p-2 border border-light rounded-circle",dot:""})):((0,o.wg)(),(0,o.j4)(g,{key:1,badge:"danger",class:"translate-middle p-2 border border-light rounded-circle",dot:""}))])])],2)}var g=n(4313),m={name:"chat-user",components:{MDBBadge:g.m_,MDBBtn:g.$v},props:{user:Object,firstUser:String,selected:Boolean},methods:{onClick(){this.$emit("select")}},computed:{status(){return this.user.connected?"online":"offline"}}},p=n(89);const h=(0,p.Z)(m,[["render",d],["__scopeId","data-v-50144252"]]);var f=h,v=n(9242);const k=e=>((0,o.dD)("data-v-6aff0b8e"),e=e(),(0,o.Cn)(),e),b={class:"panel"},w={class:"messages",ref:"messagesRef"},y={class:"inner"},B={key:0,class:"sender"},D={class:"text"},U=k((()=>(0,o._)("br",null,null,-1))),I=["disabled"];function M(e,t,n,s,i,r){return(0,o.wg)(),(0,o.iD)(o.HY,null,[(0,o._)("div",b,[(0,o._)("div",w,[(0,o._)("div",y,[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(n.user.messages,((e,t)=>((0,o.wg)(),(0,o.iD)("div",{key:t,class:"message"},[r.displaySender(e,t)?((0,o.wg)(),(0,o.iD)("div",B,(0,a.zw)(e.fromSelf?"Mina":n.user.username),1)):(0,o.kq)("",!0),(0,o._)("div",null,(0,a.zw)(e.username),1),(0,o._)("div",D,(0,a.zw)(e.content),1),U,(0,o.Uk)(" "+(0,a.zw)(e.date),1)])))),128))])],512),(0,o._)("form",{onSubmit:t[1]||(t[1]=(0,v.iM)(((...e)=>r.onSubmit&&r.onSubmit(...e)),["prevent"]))},[(0,o.wy)((0,o._)("input",{"onUpdate:modelValue":t[0]||(t[0]=e=>i.msg=e),placeholder:"Lähetä viesti..."},null,512),[[v.nr,i.msg]]),(0,o._)("button",{disabled:!r.isValid},"+",8,I)],32)]),(0,o.Uk)(" "+(0,a.zw)(n.initMessages),1)],64)}var C=n(4045),S={name:"MessagePanel",components:{},props:{user:Object,initMessages:Array},data(){return{msg:""}},methods:{onSubmit(){const e=new Date;this.$emit("new:message",this.msg,(0,C.ZP)(e,"dd-mm-yyyy,  HH:MM")),this.msg=""},displaySender(e,t){return 0===t||this.user.messages[t-1].fromSelf!==this.user.messages[t].fromSelf}},computed:{isValid(){return this.msg.length>0}}};const _=(0,p.Z)(S,[["render",M],["__scopeId","data-v-6aff0b8e"]]);var Z=_,P={name:"chat-io",props:{me:Object,uname:String,rm:String,isUserRemoved:Boolean},components:{User:f,MessagePanel:Z},data(){return{selectedUser:null,users:[],room:"",firstUser:"",user:!0,initMessages:{}}},methods:{onMessage(e,t){this.selectedUser&&(console.log("Selected user: "+this.selectedUser.username),r.Z.emit("private message",{content:e,date:t,to:this.selectedUser.userID}),this.selectedUser.messages.push({content:e,date:t,fromSelf:!0}))},onSelectUser(e){e.self||(this.selectedUser=e),e.hasNewMessages=!1}},mounted(){r.Z.on("init messages",(e=>{this.initMessages=e.messages}))},beforeMount(){},created(){r.Z.on("init messages",(e=>{this.initMessages=e.messages})),r.Z.on("connect",(()=>{this.users.forEach((e=>{e.self&&(e.connected=!0)}))})),r.Z.on("disconnect",(()=>{this.users.forEach((e=>{e.self&&(e.connected=!1)}))}));const e=e=>{this.initMessages.length>0&&(console.log("Room vvvvvv"+this.initMessages[0].room),this.room=this.initMessages[0].room),e.room===this.room?e.messages=this.initMessages:e.messages=[],e.hasNewMessages=!1};r.Z.on("get room users",(t=>{console.log("Room users: "+t.users.map((e=>e.username))),t.users.forEach((t=>{for(let e=0;e<this.users.length;e++){const n=this.users[e];if(n.userID===t.userID)return void(n.connected=t.connected)}t.self=t.userID===r.Z.userID,e(t),this.users.push(t)})),this.users.sort(((e,t)=>e.self?-1:t.self?1:e.username<t.username?-1:e.username>t.username?1:0))})),r.Z.on("user connected",(t=>{for(let e=0;e<this.users.length;e++){const n=this.users[e];if(n.userID===t.userID)return void(n.connected=!0)}e(t),this.users.push(t)})),r.Z.on("user disconnected",(e=>{for(let t=0;t<this.users.length;t++){const n=this.users[t];if(n.userID===e){n.connected=!1;break}}})),r.Z.on("private message",(({content:e,from:t,to:n})=>{for(let o=0;o<this.users.length;o++){const s=this.users[o],i=r.Z.userID===t;if(s.userID===(i?n:t)){s.messages.push({content:e,fromSelf:i}),s!==this.selectedUser&&(s.hasNewMessages=!0);break}}}))},unmounted(){r.Z.off("connect"),r.Z.off("disconnect"),r.Z.off("users"),r.Z.off("user connected"),r.Z.off("user disconnected"),r.Z.off("private message")}};const N=(0,p.Z)(P,[["render",i],["__scopeId","data-v-60209846"]]);var O=N},1845:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return w}});var o=n(3396);const s=e=>((0,o.dD)("data-v-22a4cab7"),e=e(),(0,o.Cn)(),e),i={id:"app"},r=s((()=>(0,o._)("p",null,"See nupp on hetkel ajutiselt, mis aitab eemaldada chati kasutaja.",-1)));function a(e,t,n,s,a,l){const c=(0,o.up)("select-user"),u=(0,o.up)("chat"),d=(0,o.up)("MDBBtn"),g=(0,o.up)("MDBContainer");return(0,o.wg)(),(0,o.iD)("div",i,[(0,o.Wm)(g,{class:"chatPanel"},{default:(0,o.w5)((()=>[(0,o.Wm)(c,{onInpuut:l.onUsernameSelection,un:n.un,ri:n.ri},null,8,["onInpuut","un","ri"]),(0,o.Wm)(u,{me:n.loggedInUser,uname:n.un,rm:n.ri,isUserRemoved:a.isUserRemoved},null,8,["me","uname","rm","isUserRemoved"]),r,(0,o.Wm)(d,{outline:"danger",block:"",size:"lg",onClick:l.removeChatUser},{default:(0,o.w5)((()=>[(0,o.Uk)("Remove chat user")])),_:1},8,["onClick"])])),_:1})])}var l=n(4313),c=n(9242);const u={class:"select-username"};function d(e,t,n,s,i,r){return(0,o.wg)(),(0,o.iD)("div",u,[(0,o._)("form",{onSubmit:t[0]||(t[0]=(0,c.iM)(((...e)=>r.onSubmit&&r.onSubmit(...e)),["prevent"]))},null,32)])}var g={name:"SelectUsername",props:{un:String,ri:String},components:{},data(){return{username:"",room:""}},computed:{isValid(){return this.username.length>2}},methods:{onSubmit(){this.$emit("inpuut",this.un,this.ri)},preventDefault(){this.$emit("inpuut",this.un,this.ri)}}},m=n(89);const p=(0,m.Z)(g,[["render",d],["__scopeId","data-v-103ce08e"]]);var h=p,f=n(1245),v=n(4058),k={name:"LiveChat",props:{loggedInUser:Object,bookings:Array,bookingsHistory:Array,un:String,ri:String},components:{MDBContainer:l.L5,MDBBtn:l.$v,SelectUser:h,chat:f.Z},data(){return{usernameAlreadySelected:!1,test:"",username:"",room:"",isUserRemoved:!1}},onMounted(){},beforeMount(){},mounted(){},methods:{newChat(){console.log("Aaaaaaaa");let e="alla",t="tuba";this.usernameAlreadySelected=!0,v.Z.auth={username:e,room:t},v.Z.connect()},openxxx(){},reloader(){window.location.reload()},socketResetTest(){v.Z.disconnect(),v.Z.connect()},onUsernameSelection(e,t){console.log("Aaaaaaaa"),this.username=e,this.room=t,this.usernameAlreadySelected=!0,v.Z.auth={username:e,room:t},v.Z.connect()},joinAllRooms(){const e=["111","222"];v.Z.emit("joinAllClientRooms",e)},updateRoom(){v.Z.emit("updateRoom","uus-tuba"),v.Z.on("get room users",(e=>{this.users=e})),this.socketResetTest()},removeChatUser(){console.log("Remove chat user"),v.Z.emit("unsubscribe"),window.localStorage.removeItem("sessionID"),v.Z.on("get room users",(e=>{this.users=e})),location.reload()}},created(){console.log("Heiiiii"),this.socketResetTest();const e=localStorage.getItem("sessionID");console.log("Session id "+e),e&&(this.usernameAlreadySelected=!0,v.Z.auth={sessionID:e},v.Z.connect()),v.Z.on("session",(({sessionID:e,userID:t,roomName:n})=>{v.Z.auth={sessionID:e},localStorage.setItem("sessionID",e),v.Z.userID=t,v.Z.roomName=n})),v.Z.on("connect_error",(e=>{"invalid username"===e.message&&(this.usernameAlreadySelected=!1)}))},unmounted(){v.Z.off("connect_error")}};const b=(0,m.Z)(k,[["render",a],["__scopeId","data-v-22a4cab7"]]);var w=b},1319:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return C}});var o=n(3396),s=n(7139);const i=e=>((0,o.dD)("data-v-64310ae6"),e=e(),(0,o.Cn)(),e),r={key:0,class:"spinner-border",role:"status"},a=i((()=>(0,o._)("span",{class:"visually-hidden"},"Loading...",-1))),l=[a],c={key:1},u=["onClick"],d=["onClick"],g={style:{border:"solid blue"}},m={key:0},p=["src"];function h(e,t,n,i,a,h){const f=(0,o.up)("monthConverter"),v=(0,o.up)("MDBTabItem"),k=(0,o.up)("MDBTabNav"),b=(0,o.up)("MDBBtnClose"),w=(0,o.up)("MDBBtn"),y=(0,o.up)("chat"),B=(0,o.up)("MDBTable"),D=(0,o.up)("MDBTabPane"),U=(0,o.up)("MDBTabContent"),I=(0,o.up)("MDBTabs"),M=(0,o.up)("MDBContainer");return(0,o.wg)(),(0,o.iD)("div",null,[(0,o.Wm)(M,{style:{"margin-top":"200px"}},{default:(0,o.w5)((()=>[0===a.bookings.length?((0,o.wg)(),(0,o.iD)("div",r,l)):((0,o.wg)(),(0,o.iD)("div",c,[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(a.bookings,((i,r)=>((0,o.wg)(),(0,o.j4)(I,{modelValue:e.activeTabId4,"onUpdate:modelValue":t[0]||(t[0]=t=>e.activeTabId4=t),vertical:"lg",key:r},{default:(0,o.w5)((()=>["confirmed"!==i.state?((0,o.wg)(),(0,o.j4)(k,{key:0,pills:"",tabsClasses:"mb-3 text-center"},{default:(0,o.w5)((()=>[(0,o.Wm)(v,{wrap:!1,tabId:"{{booking.id}}",href:"{{booking.id}}"},{default:(0,o.w5)((()=>["notSeen"===i.status?((0,o.wg)(),(0,o.iD)("b",{key:0,onClick:e=>h.messageSeen(i)},[(0,o.Wm)(f,{num:i.onTime[0].month},null,8,["num"]),(0,o.Uk)(" "+(0,s.zw)(i.onTime[0].day)+" "+(0,s.zw)(i.onTime[0].year)+" - "+(0,s.zw)(i.header),1)],8,u)):((0,o.wg)(),(0,o.iD)("p",{key:1,onClick:e=>h.messageSeen(i)},[(0,o.Wm)(f,{num:i.onTime[0].month},null,8,["num"]),(0,o.Uk)(" "+(0,s.zw)(i.onTime[0].day)+" "+(0,s.zw)(i.onTime[0].year)+" - "+(0,s.zw)(i.header),1)],8,d))])),_:2},1024)])),_:2},1024)):(0,o.kq)("",!0),(0,o.Wm)(U,null,{default:(0,o.w5)((()=>[(0,o.Wm)(D,{tabId:"{{booking.id}}",href:"{{booking.id}}",class:"dataContainer"},{default:(0,o.w5)((()=>[(0,o.Wm)(B,{borderless:"",style:{"font-size":"18px","text-align":"left"}},{default:(0,o.w5)((()=>[(0,o._)("tbody",null,[(0,o._)("tr",null,[(0,o._)("td",null,[(0,o.Uk)((0,s.zw)(i.address)+" ",1),(0,o.Wm)(b,{class:"closeData",onClick:h.exitFromNotificationData},null,8,["onClick"])])]),(0,o._)("tr",null,[(0,o._)("td",g,(0,s.zw)(i.description),1)]),(0,o._)("tr",null,[i.image?((0,o.wg)(),(0,o.iD)("td",m,[a.isImageOpen?(0,o.kq)("",!0):((0,o.wg)(),(0,o.j4)(w,{key:0,outline:"success",onClick:e=>h.openImagePanel(i.image)},{default:(0,o.w5)((()=>[(0,o.Uk)(" Open image ")])),_:2},1032,["onClick"])),(0,o._)("div",null,[a.isOpenImage?((0,o.wg)(),(0,o.iD)("img",{key:0,id:"img",class:"loading",src:a.srcImg,alt:"kuva"},null,8,p)):(0,o.kq)("",!0),a.isImageOpen?((0,o.wg)(),(0,o.j4)(w,{key:1,outline:"secondary",onClick:h.closeImagePanel},{default:(0,o.w5)((()=>[(0,o.Uk)(" Close image ")])),_:1},8,["onClick"])):(0,o.kq)("",!0)])])):(0,o.kq)("",!0)]),(0,o._)("tr",null,[(0,o._)("td",null,[(0,o.Wm)(y,{un:n.userIsProvider.yritys,ri:a.ri},null,8,["un","ri"])])]),(0,o._)("tr",null,[(0,o._)("td",null,[(0,o.Wm)(w,{block:"",outline:"success",onClick:e=>h.confirmBooking(i.id)},{default:(0,o.w5)((()=>[(0,o.Uk)(" Kinnita tellimus ")])),_:2},1032,["onClick"])])])])])),_:2},1024)])),_:2},1024)])),_:2},1024)])),_:2},1032,["modelValue"])))),128))]))])),_:1})])}var f=n(4313),v=n(2043),k=n(5253),b=n(5800),w=n(9398),y=n(1845),B=n(1245),D=n(4058),U={name:"client-notifications",props:{loggedInUser:Object,userIsProvider:Object},components:{PulseLoader:v.Z,monthConverter:k.Z,chat:y["default"],chatContent:B.Z,MDBContainer:f.L5,MDBRow:f.uZ,MDBCol:f.TK,MDBListGroup:f.d8,MDBListGroupItem:f.FQ,MDBTabs:f.zk,MDBTabNav:f.JH,MDBTabItem:f.kX,MDBTabContent:f.oJ,MDBTabPane:f._I,MDBTable:f.re,MDBBtnClose:f.Ok,MDBBtn:f.$v},data(){return{userIn:null,bookings:[],currentRoom:"",bookingDate:null,isSeen:!1,isOpenImage:!1,isImageOpen:!1,srcImg:"",isChatOpen:!1,isRenderData:!1,loading:!1,id:null,un:"sanna",ri:""}},onMounted(){},mounted(){const e=window.localStorage.getItem("loggedAppUser");if(e){const t=JSON.parse(e);this.userIn=t,console.log("User in notification: "+t.username),this.handleBookings()}},methods:{async handleBookings(){const e=await w.Z.getProvider(this.userIn.id);e&&(this.bookings=e.booking.filter((e=>"confirmed"!==e.status)))},createBookingDate(){this.bookingDate=22},messageSeen(e){this.isSeen=!0,this.isChatOpen=!0,this.isRenderData=!0,this.ri=this.userIsProvider.yritys+e.user.username,console.log("Ri means: "+this.ri);this.userIn.username,this.ri;D.Z.emit("updateRoom",this.ri),D.Z.disconnect(),D.Z.connect(),D.Z.emit("room users account"),D.Z.on("get room users account",(e=>{console.log("Can we get users data from backend here??? "+e.users.length)})),this.id=e.id,this.editStatus(e.id,"seen")},async editStatus(e,t){const n={status:t},o=await b.Z.updateRecipient(e,n);console.log("Is status updated: "+o.status),this.$emit("update:status",e)},openImagePanel(e){this.isOpenImage=!0,this.srcImg=n(3866)(`./${e.map((e=>e.name))}`),""!==this.srcImg&&(this.isImageOpen=!0)},confirmBooking(e){console.log("confirmed booking id"+e),this.editStatus(e,"confirmed"),this.$emit("remove:booking",e),this.$emit("deactivate:bell",!1)},closeImagePanel(){this.isOpenImage=!1,this.isImageOpen=!1},exitFromNotificationData(){location.reload()}}},I=n(89);const M=(0,I.Z)(U,[["render",h],["__scopeId","data-v-64310ae6"]]);var C=M},3866:function(e,t,n){var o={"./file-1683564858678-jane_doe.png":7138,"./file-1683983780652-alus merellÃ¤.jpg":9107};function s(e){var t=i(e);return n(t)}function i(e){if(!n.o(o,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return o[e]}s.keys=function(){return Object.keys(o)},s.resolve=i,e.exports=s,s.id=3866},7138:function(e,t,n){"use strict";e.exports=n.p+"img/file-1683564858678-jane_doe.05f8ae65.png"},9107:function(e,t,n){"use strict";e.exports=n.p+"img/file-1683983780652-alus merellÃ¤.72e40714.jpg"}},t={};function n(o){var s=t[o];if(void 0!==s)return s.exports;var i=t[o]={exports:{}};return e[o].call(i.exports,i,i.exports,n),i.exports}n.m=e,function(){var e=[];n.O=function(t,o,s,i){if(!o){var r=1/0;for(u=0;u<e.length;u++){o=e[u][0],s=e[u][1],i=e[u][2];for(var a=!0,l=0;l<o.length;l++)(!1&i||r>=i)&&Object.keys(n.O).every((function(e){return n.O[e](o[l])}))?o.splice(l--,1):(a=!1,i<r&&(r=i));if(a){e.splice(u--,1);var c=s();void 0!==c&&(t=c)}}return t}i=i||0;for(var u=e.length;u>0&&e[u-1][2]>i;u--)e[u]=e[u-1];e[u]=[o,s,i]}}(),function(){n.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return n.d(t,{a:t}),t}}(),function(){n.d=function(e,t){for(var o in t)n.o(t,o)&&!n.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})}}(),function(){n.f={},n.e=function(e){return Promise.all(Object.keys(n.f).reduce((function(t,o){return n.f[o](e,t),t}),[]))}}(),function(){n.u=function(e){return"js/"+e+"."+{29:"3e89ac32",51:"4cefe4ba",82:"2e5f6c37",133:"1441be90",161:"dd6cffa5",320:"36410b14",346:"bcfd0cdb",352:"0e210405",367:"9c46720e",382:"abe9c1ea",558:"8300cef8",608:"898aace7",629:"9c0d9b4d",674:"4769a283",697:"6b1a83d5",896:"f9268e2a",901:"056d1123"}[e]+".js"}}(),function(){n.miniCssF=function(e){return"css/"+e+"."+{29:"982c571a",51:"dcccf11d",82:"982c571a",133:"2c7880bd",320:"4bfaa8cc",352:"e889df20",608:"72fbd56a",674:"3787a8bd",697:"509fb228",896:"99444498"}[e]+".css"}}(),function(){n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){var e={},t="prore-mongo:";n.l=function(o,s,i,r){if(e[o])e[o].push(s);else{var a,l;if(void 0!==i)for(var c=document.getElementsByTagName("script"),u=0;u<c.length;u++){var d=c[u];if(d.getAttribute("src")==o||d.getAttribute("data-webpack")==t+i){a=d;break}}a||(l=!0,a=document.createElement("script"),a.charset="utf-8",a.timeout=120,n.nc&&a.setAttribute("nonce",n.nc),a.setAttribute("data-webpack",t+i),a.src=o),e[o]=[s];var g=function(t,n){a.onerror=a.onload=null,clearTimeout(m);var s=e[o];if(delete e[o],a.parentNode&&a.parentNode.removeChild(a),s&&s.forEach((function(e){return e(n)})),t)return t(n)},m=setTimeout(g.bind(null,void 0,{type:"timeout",target:a}),12e4);a.onerror=g.bind(null,a.onerror),a.onload=g.bind(null,a.onload),l&&document.head.appendChild(a)}}}(),function(){n.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){n.p="/"}(),function(){if("undefined"!==typeof document){var e=function(e,t,n,o,s){var i=document.createElement("link");i.rel="stylesheet",i.type="text/css";var r=function(n){if(i.onerror=i.onload=null,"load"===n.type)o();else{var r=n&&("load"===n.type?"missing":n.type),a=n&&n.target&&n.target.href||t,l=new Error("Loading CSS chunk "+e+" failed.\n("+a+")");l.code="CSS_CHUNK_LOAD_FAILED",l.type=r,l.request=a,i.parentNode&&i.parentNode.removeChild(i),s(l)}};return i.onerror=i.onload=r,i.href=t,n?n.parentNode.insertBefore(i,n.nextSibling):document.head.appendChild(i),i},t=function(e,t){for(var n=document.getElementsByTagName("link"),o=0;o<n.length;o++){var s=n[o],i=s.getAttribute("data-href")||s.getAttribute("href");if("stylesheet"===s.rel&&(i===e||i===t))return s}var r=document.getElementsByTagName("style");for(o=0;o<r.length;o++){s=r[o],i=s.getAttribute("data-href");if(i===e||i===t)return s}},o=function(o){return new Promise((function(s,i){var r=n.miniCssF(o),a=n.p+r;if(t(r,a))return s();e(o,a,null,s,i)}))},s={143:0};n.f.miniCss=function(e,t){var n={29:1,51:1,82:1,133:1,320:1,352:1,608:1,674:1,697:1,896:1};s[e]?t.push(s[e]):0!==s[e]&&n[e]&&t.push(s[e]=o(e).then((function(){s[e]=0}),(function(t){throw delete s[e],t})))}}}(),function(){var e={143:0};n.f.j=function(t,o){var s=n.o(e,t)?e[t]:void 0;if(0!==s)if(s)o.push(s[2]);else if(51!=t){var i=new Promise((function(n,o){s=e[t]=[n,o]}));o.push(s[2]=i);var r=n.p+n.u(t),a=new Error,l=function(o){if(n.o(e,t)&&(s=e[t],0!==s&&(e[t]=void 0),s)){var i=o&&("load"===o.type?"missing":o.type),r=o&&o.target&&o.target.src;a.message="Loading chunk "+t+" failed.\n("+i+": "+r+")",a.name="ChunkLoadError",a.type=i,a.request=r,s[1](a)}};n.l(r,l,"chunk-"+t,t)}else e[t]=0},n.O.j=function(t){return 0===e[t]};var t=function(t,o){var s,i,r=o[0],a=o[1],l=o[2],c=0;if(r.some((function(t){return 0!==e[t]}))){for(s in a)n.o(a,s)&&(n.m[s]=a[s]);if(l)var u=l(n)}for(t&&t(o);c<r.length;c++)i=r[c],n.o(e,i)&&e[i]&&e[i][0](),e[i]=0;return n.O(u)},o=self["webpackChunkprore_mongo"]=self["webpackChunkprore_mongo"]||[];o.forEach(t.bind(null,0)),o.push=t.bind(null,o.push.bind(o))}();var o=n.O(void 0,[998],(function(){return n(1447)}));o=n.O(o)})();
//# sourceMappingURL=app.c90fabfe.js.map