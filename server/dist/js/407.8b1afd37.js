"use strict";(self["webpackChunkprore_mongo"]=self["webpackChunkprore_mongo"]||[]).push([[407],{1889:function(e,t,o){o.d(t,{A:function(){return p}});var i=o(6768),a=o(4232);const s={key:0,class:"full-star"},n={key:1,class:"half-star"},l={key:2,class:"star"};function r(e,t,o,r,d,c){const g=(0,i.g2)("MDBContainer");return(0,i.uX)(),(0,i.Wv)(g,null,{default:(0,i.k6)((()=>[(0,i.Lk)("div",null,[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(c.stars,((e,t)=>((0,i.uX)(),(0,i.CE)("span",{key:t,class:(0,a.C4)(["starGap",["star",{full:"full"===e,half:"half"===e}]])},["full"===e?((0,i.uX)(),(0,i.CE)("span",s,"★")):"half"===e?((0,i.uX)(),(0,i.CE)("span",n,"★")):((0,i.uX)(),(0,i.CE)("span",l,"★"))],2)))),128))])])),_:1})}o(4114);var d=o(5846),c={name:"RatingStars",props:{rating:Number},components:{MDBContainer:d.Dj},data(){return{}},computed:{stars(){let e=[],t=Math.floor(this.rating),o=this.rating%1>=.1;for(let i=0;i<t;i++)e.push("full");o&&e.push("half");while(e.length<5)e.push("empty");return e}}},g=o(1241);const u=(0,g.A)(c,[["render",r],["__scopeId","data-v-7c73cb5d"]]);var p=u},3837:function(e,t,o){o(8111),o(7588),o(4373)},7311:function(e,t,o){e.exports=o.p+"img/avatar.db2f8c83.png"},7407:function(e,t,o){o.r(t),o.d(t,{default:function(){return pe}});var i=o(6768),a=o(4232),s=o(5130);const n={style:{display:"flex","justify-content":"right"}},l={key:0,style:{color:"red"}},r={id:"address-panel"},d={style:{"margin-bottom":"20px"}},c={value:"slotProps"},g={key:0},u={key:1},p={style:{},class:"flex align-items-center"},m={class:"distSelectPanel"},h={style:{"margin-top":"15px"}},k={key:0,style:{"background-color":"white",margin:"auto",padding:"10px",width:"350px",border:"solid darkgrey"}},y={key:1,class:"map-info-table",style:{"background-color":"white",color:"darkslategrey",padding:"10px",width:"90%",margin:"auto",border:"solid darkgrey"}},f={style:{display:"flex","justify-content":"right"}},b={style:{"background-color":"dimgrey","border-radius":"10px",padding:"13px","margin-bottom":"13px"}},v={style:{color:"#ddd","font-size":"11px",display:"flex","justify-content":"right",padding:"7px 0"}},w=["src"],L={style:{"margin-bottom":"13px"}},C={key:0},D={key:0},M={key:1,colspan:"2"},P={key:1},x=["href"],A={key:2},F={colspan:"2"},B={key:3},S={colspan:"2"},_={key:2,class:"order"},E={style:{display:"flex","justify-content":"right",padding:"20px"}},I={style:{color:"#00a6ff","text-align":"left"}},O={key:0,style:{color:"palevioletred"}},T={key:1,style:{color:"palevioletred"}},N={style:{color:"#fff"}},U={key:0,style:{color:"palevioletred"}},X={class:"message-counter"},V={key:3},R={key:0},z=["src"],j={key:4,style:{"background-color":"white",width:"300px",margin:"auto"}},H={key:0},Q={style:{color:"blue","font-size":"14px","text-align":"left",padding:"15px"}};function W(e,t,W,$,G,Y){const q=(0,i.g2)("MDBIcon"),J=(0,i.g2)("MDBBtnClose"),K=(0,i.g2)("MDBInput"),Z=(0,i.g2)("Dropdown"),ee=(0,i.g2)("VueDatePicker"),te=(0,i.g2)("MDBCheckbox"),oe=(0,i.g2)("MDBBtn"),ie=(0,i.g2)("chat-panel"),ae=(0,i.g2)("rating-stars"),se=(0,i.g2)("MDBCol"),ne=(0,i.g2)("MDBRow"),le=(0,i.g2)("feedback-list"),re=(0,i.g2)("MDBTable"),de=(0,i.g2)("MDBTextarea"),ce=(0,i.g2)("MDBContainer");return(0,i.uX)(),(0,i.CE)("div",null,[(0,i.bF)(ce,{style:{position:"relative","z-index":"1","margin-top":"80px",opacity:"0.8"}},{default:(0,i.k6)((()=>[(0,i.Lk)("div",null,[(0,i.Lk)("div",{class:(0,a.C4)([{hideMainPanel:!G.isMainPanel},"client-map-panel"])},[(0,i.Lk)("div",n,[(0,i.bF)(q,{size:"lg",style:{padding:"10px"},onClick:Y.closeMainPanel},{default:(0,i.k6)((()=>t[15]||(t[15]=[(0,i.Lk)("i",{class:"fas fa-expand-arrows-alt"},null,-1)]))),_:1},8,["onClick"]),(0,i.Lk)("div",null,[(0,i.bF)(J,{white:"",style:{padding:"10px"},size:"lg",onClick:t[0]||(t[0]=t=>e.$router.go(-1))})])]),G.isNoAddressGiven?(0,i.Q3)("",!0):((0,i.uX)(),(0,i.CE)("p",l,"Anna osoittesi!")),(0,i.Lk)("div",r,[(0,i.bF)(K,{white:"",inputGroup:"",label:"Anna toinen osoitteesi kun ei täsmää",modelValue:G.address,"onUpdate:modelValue":t[1]||(t[1]=e=>G.address=e),id:"autocomplete",size:"lg",wrapperClass:"mb-4"},{default:(0,i.k6)((()=>[G.address?((0,i.uX)(),(0,i.Wv)(J,{key:0,white:"",style:{float:"right","margin-right":"7px","margin-top":"5px"},onClick:Y.clearOrderAddress},null,8,["onClick"])):(0,i.Q3)("",!0)])),_:1},8,["modelValue"])]),(0,i.Lk)("div",d,[(0,i.bF)(Z,{onChange:Y.changedProfession,modelValue:G.prof,"onUpdate:modelValue":t[2]||(t[2]=e=>G.prof=e),options:G.prodata,filter:"",optionLabel:"label",optionGroupLabel:"label",optionGroupChildren:"items",placeholder:"Valitse ammattilainen",class:"w-full md:w-100rem"},{optiongroup:(0,i.k6)((e=>[(0,i.Lk)("div",p,[(0,i.Lk)("div",null,(0,a.v_)(e.option.label),1)])])),default:(0,i.k6)((()=>[(0,i.Lk)("template",c,[e.slotProps.value?((0,i.uX)(),(0,i.CE)("div",g,[(0,i.Lk)("div",null,(0,a.v_)(e.slotProps.value.label),1)])):((0,i.uX)(),(0,i.CE)("span",u,(0,a.v_)(e.slotProps.placeholder),1))])])),_:1},8,["onChange","modelValue","options"])]),(0,i.Lk)("div",{class:(0,a.C4)({hideDistSelectPanel:!G.isDistSelection})},[t[16]||(t[16]=(0,i.Lk)("p",{style:{"text-align":"left"}},"Valitse kiinnostavaa ajankohta tai heti!",-1)),(0,i.Lk)("div",m,[(0,i.bF)(ee,{style:{"margin-bottom":"20px",width:"70%",padding:"7px"},modelValue:G.bookingDate,"onUpdate:modelValue":[t[3]||(t[3]=e=>G.bookingDate=e),Y.handleDate],dark:"","min-date":new Date,"teleport-center":"",onInternalModelChange:e.handleInternalDate,state:!e.isNoDate&&null},null,8,["modelValue","min-date","onInternalModelChange","onUpdate:modelValue","state"]),(0,i.Lk)("div",h,[(0,i.bF)(te,{white:"",label:"Heti!",name:"selection",modelValue:G.isSelectNotNow,"onUpdate:modelValue":t[4]||(t[4]=e=>G.isSelectNotNow=e),value:"true",onClick:Y.removeDateIfExist,wrapperClass:"mb-4"},null,8,["modelValue","onClick"])])])],2),(0,i.Lk)("div",{class:(0,a.C4)({hideDistSelectPanel:!G.isDistSelection}),style:{"margin-bottom":"13px"}},[(0,i.bo)((0,i.Lk)("select",{style:{padding:"12px",width:"100%","margin-bottom":"25px","background-color":"dimgrey",color:"white"},id:"distance","onUpdate:modelValue":t[5]||(t[5]=e=>G.distBtw=e),onClick:t[6]||(t[6]=(...t)=>e.filterByDistance&&e.filterByDistance(...t))},t[17]||(t[17]=[(0,i.Lk)("option",{disabled:"",value:"0"},"Valitse etäisyys",-1),(0,i.Lk)("option",{value:"1"},"1 km ympärilläsi",-1),(0,i.Lk)("option",{value:"2"},"2 km ympärilläsi",-1),(0,i.Lk)("option",{value:"3"},"3 km ympärilläsi",-1),(0,i.Lk)("option",{value:"4"},"4 km ympärilläsi",-1),(0,i.Lk)("option",{value:"5"},"5 km ympärilläsi",-1),(0,i.Lk)("option",{value:"6"},"6 km ympärilläsi",-1),(0,i.Lk)("option",{value:"7"},"7 km ympärilläsi",-1),(0,i.Lk)("option",{value:"8"},"8 km ympärilläsi",-1),(0,i.Lk)("option",{value:"9"},"9 km ympärilläsi",-1),(0,i.Lk)("option",{value:"10"},"10 km ympärilläsi",-1),(0,i.Lk)("option",{value:"20"},"20 km ympärilläsi",-1),(0,i.Lk)("option",{value:"30"},"30 km ympärilläsi",-1),(0,i.Lk)("option",{value:"40"},"40 km ympärilläsi",-1),(0,i.Lk)("option",{value:"50"},"50 km ympärilläsi",-1),(0,i.Lk)("option",{value:"60"},"60 km ympärilläsi",-1),(0,i.Lk)("option",{value:"70"},"70 km ympärilläsi",-1),(0,i.Lk)("option",{value:"80"},"80 km ympärilläsi",-1),(0,i.Lk)("option",{value:"90"},"90 km ympärilläsi",-1),(0,i.Lk)("option",{value:"100"},"100 km ympärilläsi",-1),(0,i.Lk)("option",{value:"200"},"200 km ympärilläsi",-1),(0,i.Lk)("option",{value:"300"},"300 km ympärilläsi",-1)]),512),[[s.u1,G.distBtw]]),G.bookingDate||G.isSelectNotNow?((0,i.uX)(),(0,i.Wv)(oe,{key:0,color:"success",onClick:Y.findSuitablePro},{default:(0,i.k6)((()=>t[18]||(t[18]=[(0,i.eW)(" Etsi ammatilainen ")]))),_:1},8,["onClick"])):(0,i.Q3)("",!0)],2),G.prof&&G.isPressedFindBtn?((0,i.uX)(),(0,i.CE)("p",{key:1,class:(0,a.C4)({noClients:G.isActiveProffs}),style:{color:"palevioletred"}}," Ei ammattilaisia vielä! ",2)):(0,i.Q3)("",!0)],2)]),G.isMapChat?((0,i.uX)(),(0,i.CE)("div",k,[(0,i.Lk)("p",{style:{float:"right",color:"limegreen"},onClick:t[7]||(t[7]=(...e)=>Y.closeMapChat&&Y.closeMapChat(...e))},"Valmis"),(0,i.bF)(ie,{chatusers:W.chatusers,messages:W.messages,selecteduser:W.selecteduser,"onSelect:user":Y.selectUser,onNoSelected:Y.noSelectUser,"onOn:message":Y.onMessage},null,8,["chatusers","messages","selecteduser","onSelect:user","onNoSelected","onOn:message"])])):G.isTargetSelected&&!G.isMapChat?((0,i.uX)(),(0,i.CE)("div",y,[(0,i.Lk)("div",f,[(0,i.Lk)("p",{style:{"font-size":"15px",padding:"10px",color:"green"},onClick:t[8]||(t[8]=(...e)=>Y.outFromMarkerPanel&&Y.outFromMarkerPanel(...e))},"Valmis")]),(0,i.bF)(ne,null,{default:(0,i.k6)((()=>[(0,i.bF)(se,{lg:"4"},{default:(0,i.k6)((()=>[(0,i.Lk)("div",b,[(0,i.Lk)("div",v,(0,a.v_)(G.target.rating.positive.length>0?G.target.rating.positive/G.target.rating.count:0)+" tähteä   ( "+(0,a.v_)(G.target.rating.count)+" antajaa ) ",1),(0,i.Lk)("img",{style:{width:"100px"},src:!0===G.target.user.avatar.isImage?G.target.user.avatar.imageUrl:o(7311),alt:"pro-image"},null,8,w),(0,i.bF)(ae,{rating:G.target.rating.positive/G.target.rating.count},null,8,["rating"])])])),_:1}),(0,i.bF)(se,null,{default:(0,i.k6)((()=>[(0,i.Lk)("p",L,(0,a.v_)(G.target.description),1)])),_:1})])),_:1}),(0,i.bF)(re,{responsive:"",borderless:"",style:{"font-size":"14px",width:"100%","text-align":"left"}},{default:(0,i.k6)((()=>[(0,i.Lk)("tbody",null,[(0,i.Lk)("tr",null,[t[19]||(t[19]=(0,i.Lk)("td",null," Yritys: ",-1)),(0,i.Lk)("td",null,(0,a.v_)(this.target.yritys),1)]),(0,i.Lk)("tr",null,[t[20]||(t[20]=(0,i.Lk)("td",null," Y - tunnus: ",-1)),(0,i.Lk)("td",null,(0,a.v_)(this.target.ytunnus),1)]),(0,i.Lk)("tr",null,[t[21]||(t[21]=(0,i.Lk)("td",null," Työalue: ",-1)),(0,i.Lk)("td",null,(0,a.v_)(this.target.range?this.target.range+" km":"Palvelun tarjous vain paikalla!"),1)]),(0,i.Lk)("tr",null,[t[22]||(t[22]=(0,i.Lk)("td",null," Palvelun hinta: ",-1)),(0,i.Lk)("td",null,(0,a.v_)(this.target.priceByHour?this.target.priceByHour+" Euroa / tunti":"Urakkahinta sovittaessa!"),1)]),this.target.feedback.length>0?((0,i.uX)(),(0,i.CE)("tr",C,[(0,i.Lk)("td",{class:(0,a.C4)({hideFeedbackTitle:G.isShowRatingResults})}," Palaute ",2),G.isShowRatingResults?((0,i.uX)(),(0,i.CE)("td",M,[(0,i.bF)(le,{style:{color:"#ddd"},feedback:this.target.feedback,onCloseFeedbackList:Y.handleCloseMapFeedbackList},null,8,["feedback","onCloseFeedbackList"])])):((0,i.uX)(),(0,i.CE)("td",D,[(0,i.bF)(oe,{block:"",color:"info",onClick:t[9]||(t[9]=e=>G.isShowRatingResults=!0)},{default:(0,i.k6)((()=>[(0,i.eW)("Katso arvostelut  ( "+(0,a.v_)(G.target.feedback.length)+" )",1)])),_:1})]))])):(0,i.Q3)("",!0),this.target.pro_link?((0,i.uX)(),(0,i.CE)("tr",P,[t[23]||(t[23]=(0,i.Lk)("td",null," Kotisivu ",-1)),(0,i.Lk)("td",null,[(0,i.Lk)("a",{href:"//"+this.target.pro_link,target:"_blank"}," Palveluntarjoajan kotisivu ",8,x)])])):(0,i.Q3)("",!0),G.target.user.id!==G.userId?((0,i.uX)(),(0,i.CE)("tr",A,[(0,i.Lk)("td",F,[(0,i.bF)(oe,{style:{float:"right"},color:"warning",size:"lg",onClick:Y.createChatPanel},{default:(0,i.k6)((()=>t[24]||(t[24]=[(0,i.eW)("    "),(0,i.Lk)("i",{class:"far fa-comments"},null,-1)]))),_:1},8,["onClick"])])])):(0,i.Q3)("",!0),G.target.user.id===G.userId||G.isOrder?(0,i.Q3)("",!0):((0,i.uX)(),(0,i.CE)("tr",B,[(0,i.Lk)("td",S,[(0,i.bF)(oe,{block:"",color:"success",size:"lg",onClick:Y.createBooking},{default:(0,i.k6)((()=>t[25]||(t[25]=[(0,i.eW)("Tee tilaus")]))),_:1},8,["onClick"])])]))])])),_:1})])):(0,i.Q3)("",!0),G.isOrder?((0,i.uX)(),(0,i.CE)("div",_,[(0,i.Lk)("div",E,[(0,i.bF)(J,{white:"",size:"lg",onClick:t[10]||(t[10]=e=>G.isOrder=!1)})]),(0,i.Lk)("form",null,[(0,i.Lk)("p",I,"Address: "+(0,a.v_)(G.address),1),(0,i.eW)(" order label "+(0,a.v_)(Y.isNoOrderLabelAdded)+" ",1),Y.isNoOrderLabelAdded?((0,i.uX)(),(0,i.CE)("p",O,"Anna otsikko, pakollinen kenttä!")):(0,i.Q3)("",!0),(0,i.bF)(K,{white:"",label:"Anna otsiko",modelValue:G.orderHeader,"onUpdate:modelValue":t[11]||(t[11]=e=>G.orderHeader=e),wrapperClass:"mb-4"},null,8,["modelValue"]),t[26]||(t[26]=(0,i.Lk)("p",{style:{"text-align":"left"}},"Missä ajalla haluaisit ammattilaista?",-1)),Y.isNoOrderDateAdded?((0,i.uX)(),(0,i.CE)("p",T,"Anna päivämäärä ja aika, pakollinen kenttä!")):(0,i.Q3)("",!0),(0,i.Lk)("div",N,[(0,i.bF)(ee,{style:{"margin-bottom":"20px"},modelValue:G.bookingDate,"onUpdate:modelValue":t[12]||(t[12]=e=>G.bookingDate=e),dark:"","min-date":new Date,"teleport-center":"",onInternalModelChange:e.handleInternalDate,state:!e.isNoDate&&null},null,8,["modelValue","min-date","onInternalModelChange","state"]),Y.isNoOrderDescriptionAdded?((0,i.uX)(),(0,i.CE)("p",U,"Anna kuvaus tehtävästä, pakollinen kenttä!")):(0,i.Q3)("",!0),(0,i.bF)(de,{maxlength:"70",label:"Tehtävän kuvaus...",white:"",rows:"2",modelValue:G.orderDescription,"onUpdate:modelValue":t[13]||(t[13]=e=>G.orderDescription=e),invalidFeedback:"Ole hyvä ja kirjoita tehtävän kuvaus.",validFeedback:"Ok!",wrapperClass:"mb-4"},null,8,["modelValue"]),(0,i.Lk)("span",X,(0,a.v_)(G.orderDescription.length)+" / 70",1)])]),(0,i.bF)(oe,{block:"",disabled:G.isOrderBtnClicked,color:"success",onClick:Y.confirmOrder},{default:(0,i.k6)((()=>t[27]||(t[27]=[(0,i.eW)("Tilaa")]))),_:1},8,["disabled","onClick"])])):(0,i.Q3)("",!0),G.isTargetSelected?(0,i.Q3)("",!0):((0,i.uX)(),(0,i.CE)("div",V,[G.isMainPanel?(0,i.Q3)("",!0):((0,i.uX)(),(0,i.CE)("div",R,[(0,i.Lk)("img",{src:o(417),alt:"back",style:{float:"right",padding:"10px"},onClick:t[14]||(t[14]=(...e)=>Y.returnToMainPanel&&Y.returnToMainPanel(...e))},null,8,z)]))])),!G.isMainPanel&&G.countOfSelectedProfessional>0&&!G.isTargetSelected?((0,i.uX)(),(0,i.CE)("div",j,[G.bookingDate?((0,i.uX)(),(0,i.CE)("div",H,[(0,i.Lk)("p",Q," Valittu aika: "+(0,a.v_)(G.bookingDate.getDate()+" / "+(G.bookingDate.getMonth()+1)+" klo "+G.bookingDate.getHours()+":"+(G.bookingDate.getMinutes().length<2?"0"+G.bookingDate.getMinutes():G.bookingDate.getMinutes())),1),t[28]||(t[28]=(0,i.Lk)("p",{style:{color:"darkgreen","font-size":"17px","font-weight":"bold","text-align":"left","padding-left":"15px"}},"Vihreä merkki - saatavilla ",-1)),t[29]||(t[29]=(0,i.Lk)("p",{style:{color:"darkorange","font-size":"17px","font-weight":"bold","text-align":"left","padding-left":"15px"}},"Oranssi merkki - sovitaessa ",-1))])):(0,i.Q3)("",!0),t[30]||(t[30]=(0,i.Lk)("p",{style:{color:"#9fa6b2","font-size":"14px","text-align":"left",padding:"15px"}}," Napsauta merkkiä nähdäksesi palveluntarjoajan! ",-1))])):(0,i.Q3)("",!0)])),_:1}),t[31]||(t[31]=(0,i.Lk)("div",{id:"map"},null,-1))])}o(4114),o(8111),o(7588),o(1701);var $=o(4373),G=o(407),Y=o(1769),q=o(8405),J=o(5846),K=(o(5607),o(3837),o(3076)),Z=o(6510),ee=o(8068),te=o(7630),oe=o(2436),ie=o(2717);function ae(e){e.CapacitorUtils.Synapse=new Proxy({},{get(t,o){return new Proxy({},{get(t,i){return(t,a,s)=>{const n=e.Capacitor.Plugins[o];void 0!==n?"function"==typeof n[i]?(async()=>{try{const e=await n[i](t);a(e)}catch(e){s(e)}})():s(new Error(`Method ${i} not found in Capacitor plugin ${o}`)):s(new Error(`Capacitor plugin ${o} not found`))}}})}})}function se(e){e.CapacitorUtils.Synapse=new Proxy({},{get(t,o){return e.cordova.plugins[o]}})}function ne(e=!1){window.CapacitorUtils=window.CapacitorUtils||{},void 0===window.Capacitor||e?void 0!==window.cordova&&se(window):ae(window)}const le=(0,ie.F3)("Geolocation",{web:()=>o.e(414).then(o.bind(o,5414)).then((e=>new e.GeolocationWeb))});ne();var re=o(1690),de=o(1889),ce={name:"recipient-public",props:{userIsProvider:Object,selecteduser:null,chatusers:Array,messages:Array,isProviderLoggedIn:Boolean},components:{RatingStars:de.A,chatPanel:Z["default"],MDBContainer:J.Dj,MDBInput:J.gk,MDBBtn:J.al,MDBBtnClose:J.uR,MDBRow:J.gU,MDBCol:J.m6,MDBIcon:J.$u,MDBBadge:J.nf,MDBTextarea:J.QP,MDBTable:J.EU,MDBCheckbox:J.lR,feedbackList:te.A,Dropdown:oe.A,VueDatePicker:ee.A},data(){return{isMapReady:!1,obj:null,stateActive:!1,datetime:q.A,isOrder:!1,target:{},isTargetSelected:!1,isMainPanel:!0,isCreatingChatPanel:!1,prof:null,username:null,userId:null,providerId:null,address:null,isNoAddressGiven:!0,myLat:null,mylng:null,countOfSelectedProfessional:0,isActiveProffs:!1,isDistSelection:!1,professional:"Automaalari",currentProfession:"",distBtw:0,prodata:K.A,room:null,isShowRatingResults:!1,isChatPanel:!0,isMapChat:!1,providers:[],selectedProPosition:null,bookingDate:null,isSelectNotNow:!1,isPressedFindBtn:!1,orderDate:null,orderHeader:"",orderDescription:"",isCompleteOrder:!1,isOrderBtnClicked:!1}},computed:{isNoOrderLabelAdded(){return""===this.orderHeader&&this.isCompleteOrder},isNoOrderDateAdded(){return null===this.bookingDate&&this.isCompleteOrder},isNoOrderDescriptionAdded(){return""===this.orderDescription&&this.isCompleteOrder}},async mounted(){const e=window.localStorage.getItem("loggedAppUser");if(e){const t=JSON.parse(e);this.username=t.username,this.userId=t.id}ie.Ii.isNativePlatform()&&this.getCurrentLocation(),this.resizeMap(),this.userCurrentLocation();const t=document.getElementById("distance");t.addEventListener("change",(e=>{this.distBtw=parseFloat(e.target.value),this.stateActive=!0;this.currentProfession,parseFloat(e.target.value)}));const o=document.getElementById("autocomplete"),i={lat:50.064192,lng:-130.605469},a={north:i.lat+.1,south:i.lat-.1,east:i.lng+.1,west:i.lng-.1},s={bounds:a,componentRestrictions:{country:"fi"},fields:["address_components","geometry","icon","name","formatted_address"],strictBounds:!1},n=new google.maps.places.Autocomplete(o,s);n.addListener("place_changed",(()=>{let e=n.getPlace();this.myLat=e.geometry.location.lat(),this.myLng=e.geometry.location.lng(),this.getAddressFrom(e.geometry.location.lat(),e.geometry.location.lng()),this.address=e.formatted_address,console.log("Address xxxx "+e.formatted_address),console.log("place-----------"+this.myLat)}))},methods:{async getCurrentLocation(){try{const e={coords:{latitude:60.2767265,longitude:24.8575089}};console.log("Mocked location:",e.latitude);const t=await le.requestPermissions();if("granted"===t.location){const e=await le.getCurrentPosition({timeout:2e4,enableHighAccuracy:!0});console.log("Latitude:",e.coords.latitude),console.log("Longitude:",e.coords.longitude)}else console.log("Location permission denied")}catch(e){console.error("Error getting location",e)}},async watchLocation(){await le.watchPosition({},((e,t)=>{t?console.error("Error watching location",t):(console.log("Latitude:",e.coords.latitude),console.log("Longitude:",e.coords.longitude))}))},loadGoogleMapsScript(){return new Promise((e=>{if(window.google&&window.google.maps&&google.maps.geometry)e();else{window.initMap=()=>e();const t=document.createElement("script");t.src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDt2YXE5tk0J72JgqnH3DTD7MeoqbbWBmU&libraries=places,geometry&v=beta&callback=initMap",t.async=!0,t.defer=!0,document.head.appendChild(t)}}))},setUserPlace(e){const t=document.getElementById(e),o={lat:50.064192,lng:-130.605469},i={north:o.lat+.1,south:o.lat-.1,east:o.lng+.1,west:o.lng-.1},a={bounds:i,componentRestrictions:{country:"fi"},fields:["address_components","geometry","icon","name","formatted_address"],strictBounds:!1},s=client.places.Autocomplete(t,a);s.addListener("place_changed",(()=>{let e=s.getPlace();this.myLat=e.geometry.location.lat(),this.myLng=e.geometry.location.lng(),this.isNoAddressGiven=!0,this.getAddressFrom(e.geometry.location.lat(),e.geometry.location.lng()),this.address=e.formatted_address}))},clearOrderAddress(){this.address=null},handleCloseMapFeedbackList(){this.isShowRatingResults=!1},puhasta(){console.log("Puhastatud")},removeDateIfExist(){console.log("Clicked, functioning"),console.log("IS now`` "+this.isSelectNotNow),this.isSelectNotNow?this.bookingDate=null:this.bookingDate=new Date},async handleDate(e){if(console.log("Date handled!"+e),e&&(this.isSelectNotNow=!1),this.stateActive){await Y.A.getProviders()}},changedProfession(){console.log("Changed "+this.prof.label),this.showClientLocationOnTheMap(this.prof.label,this.distBtw),this.currentProfession=this.prof.label,this.isDistSelection=!0},selectUser(e){this.$emit("select:user",e)},noSelectUser(){this.$emit("noSelected")},onMessage(e,t,o){this.$emit("on:message",e,t,o)},resizeMap(){var e=document.getElementById("map");e.style.height="100%",e.style.width="100%"},receive(){this.$router.push("/rf")},userCurrentLocation(){navigator.geolocation&&navigator.geolocation.getCurrentPosition((e=>{const{latitude:t,longitude:o}=e.coords;this.myLat=t,this.myLng=o,console.log("myLat "+t),this.showUserLocationOnTheMap(t,o)}))},pinSymbol(e,t){const o=document.createElement("div");return o.className="price-tag",o.textContent="$2.5M",{path:"M 0,0 C -2,-20 -10,-22 -10,-30 A 10,10 0 1,1 10,-30 C 10,-22 2,-20 0,0 z",fillColor:e,fillOpacity:1,strokeColor:t,strokeWeight:2,scale:1,labelOrigin:{x:60,y:-25}}},showUserLocationOnTheMap(e,t){try{new google.maps.Map(document.getElementById("map"),{zoom:13,center:new google.maps.LatLng(e,t),mapTypeId:google.maps.MapTypeId.ROADMAP,accuracy:50})}catch(o){console.log("Error to load map: "+o.message)}this.getAddressFrom(e,t)},getAddressFrom(e,t){$.A.get("https://maps.googleapis.com/maps/api/geocode/json?latlng="+e+","+t+"&key=AIzaSyDt2YXE5tk0J72JgqnH3DTD7MeoqbbWBmU").then((o=>{if(o.data.error_message)this.error=o.data.error_message,console.log(o.data.error_message);else{new google.maps.Map(document.getElementById("map"),{zoom:13,center:new google.maps.LatLng(e,t),mapTypeId:google.maps.MapTypeId.ROADMAP});this.address=o.data.results[1].formatted_address}})).catch((e=>{this.error=e.message,console.log(e.message)}))},distanceBtw(e,t,o,i){var a=new google.maps.LatLng(e,t),s=new google.maps.LatLng(o,i);return(google.maps.geometry.spherical.computeDistanceBetween(a,s)/1e3).toFixed(2)},findSuitablePro(){this.address?(this.isPressedFindBtn=!0,this.showClientLocationOnTheMap(this.currentProfession,this.distBtw)):(console.log("No address given!"),this.isNoAddressGiven=!1)},datetimeFitting(e){let t;if(this.bookingDate){let e=this.bookingDate.getFullYear(),o=this.bookingDate.getMonth(),i=this.bookingDate.getDate(),a=this.bookingDate.getHours(),s=this.bookingDate.getMinutes();console.log("Booking date 2 "+new Date(e,o,i,a,s)),t=new Date(e,o,i,a,s)}return this.datetime.providerMatchingForClient(t,{y:e.yearFrom,m:e.monthFrom,d:e.dayFrom,hour:e.hoursFrom,min:e.minutesFrom},{y:e.yearTo,m:e.monthTo,d:e.dayTo,hour:e.hoursTo,min:e.minutesTo})},async otherUserLocations(e,t,o){let i,a=!1,s=new google.maps.Map(document.getElementById("map"),{zoom:9,center:new google.maps.LatLng(this.myLat,this.myLng),mapTypeId:google.maps.MapTypeId.ROADMAP});if(console.log("Users count: "+e.length),console.log("Current distance "+o),this.bookingDate){let e=this.bookingDate.getFullYear(),t=this.bookingDate.getMonth(),o=this.bookingDate.getDate(),a=this.bookingDate.getHours(),s=this.bookingDate.getMinutes();console.log("Booking date 2 "+new Date(e,t,o,a,s)),i=new Date(e,t,o,a,s)}let n=0;if(e.length>0){this.target={};for(let l=0;l<e.length;l++){console.log("------------ "+e[l].yritys);this.myLat,this.myLng;e[l].profession.forEach((r=>{if(r===t){console.log("Pro "+r.yritys);e[l].latitude,e[l].longitude;if(console.log("Distance btw "+this.distanceBtw(this.myLat,this.myLng,e[l].latitude,e[l].longitude)),this.isActiveProffs=!0,this.distanceBtw(this.myLat,this.myLng,e[l].latitude,e[l].longitude)<=o){let t;n++,e[l].isAvailable24_7?t=new google.maps.Marker({position:new google.maps.LatLng(e[l].latitude,e[l].longitude),accuracy:50,map:s,title:e[l].yritys,icon:this.pinSymbol("seagreen","darkgreen"),label:{color:"green",fontWeight:"bold",fontSize:"14px"}}):e[l].timeoffer.length>0?e[l].timeoffer.map((o=>{console.log("Year: "+o.yearFrom),console.log("Fitting datetime: "+this.datetime.providerMatchingForClient(i,{y:o.yearFrom,m:o.monthFrom,d:o.dayFrom,hour:o.hoursFrom,min:o.minutesFrom},{y:o.yearTo,m:o.monthTo,d:o.dayTo,hour:o.hoursTo,min:o.minutesTo})),t=this.datetime.providerMatchingForClient(i,{y:o.yearFrom,m:o.monthFrom,d:o.dayFrom,hour:o.hoursFrom,min:o.minutesFrom},{y:o.yearTo,m:o.monthTo,d:o.dayTo,hour:o.hoursTo,min:o.minutesTo})||e[l].isAvailable24_7?new google.maps.Marker({position:new google.maps.LatLng(e[l].latitude,e[l].longitude),accuracy:50,map:s,title:e[l].yritys,icon:this.pinSymbol("seagreen","darkgreen")}):new google.maps.Marker({position:new google.maps.LatLng(e[l].latitude,e[l].longitude),accuracy:50,map:s,title:e[l].yritys,icon:this.pinSymbol("orange","darkorange")})})):t=new google.maps.Marker({position:new google.maps.LatLng(e[l].latitude,e[l].longitude),accuracy:50,map:s,title:e[l].yritys,icon:this.pinSymbol("orange","darkorange")}),window.myGlobalFunction=this.openMarker;const o=new google.maps.InfoWindow({});google.maps.event.addListener(t,"click",(function(){console.log("POOOOS "+l);let i=l;a&&a.close(),a=o,o.open(s,t),o.setContent("<div  class='map-info-window'><p style=\"color: green; \">"+e[l].yritys+'</p><p style="color: red; " onclick="myGlobalFunction('+i+' )">Tiedot</p></div>')})),console.log("Prev infowondow "+a)}}}))}n>0?(this.isActiveProffs=!0,this.isMainPanel=!1):this.isActiveProffs=!1,this.countOfSelectedProfessional=n,console.log("countxx "+n),this.identifyProfText()}},handleInitChat(e,t,o,i){if(this.target.user.username!==this.username){this.target.yritys,this.username;const a={status:"map",useCounter:i,isActive:e,bookingID:t,same_room_counter:o,isOnline:!0,room:this.room,pro:this.target.yritys,username:this.username,bookerUsername:this.username,bookerID:this.userId,providerUsername:this.target.user.username,providerID:this.target.user.id},s={useCounter:i,isActive:e,bookingID:t,same_room_counter:o,room:this.room,proID:this.target.user.id,pro:this.target.yritys,userID:this.userId,username:this.username};this.$emit("initializeChat",{initChatRoom:a,chatData:s})}},createChatPanel(){this.handleInitChat(!1,"0",0,!0),this.isMapChat=!0},async openMarker(e){console.log("Booking date "+new Date(this.bookingDate));this.bookingDate;console.log("Pro profession ");const t=[this.currentProfession],o=await Y.A.getProvidersMatchingByProfession({result:t});let i=[];o.forEach((e=>{console.log("Results: "+e.user.id);let t=parseInt(this.distanceBtw(this.myLat,this.myLng,e.latitude,e.longitude)).toFixed(0);console.log("Distance to display "+t),i=i.concat({id:e.user.id,dist:t,pro:this.currentProfession})})),re.A.emit("map search report",i);const a=await Y.A.getProviders();a&&(a[e].user.username!==this.username&&(this.isCreatingChatPanel=!0),console.log("Room in client map: "+this.room),this.target=a[e],this.username?this.room=this.target.yritys+this.username:this.room="nipitiri",this.isTargetSelected=!0)},createBooking(){console.log("Here you can make an order! "+this.address),this.isSelectNotNow&&(this.bookingDate=null),this.isOrder=!0},async confirmOrder(){if(this.isOrderBtnClicked)return;this.isOrderBtnClicked=!0,this.isCompleteOrder=!0;let e=null;if(""!==this.orderHeader&&null!==this.bookingDate&&""!==this.orderDescription){if(this.bookingDate){let t=this.bookingDate.getFullYear(),o=this.bookingDate.getMonth(),i=this.bookingDate.getDate(),a=this.bookingDate.getHours(),s=this.bookingDate.getMinutes();const n=new Date(t,o,i,a,s).getTime();e={created:this.bookingDate,created_ms:n,header:this.orderHeader,address:this.address,latitude:this.myLat,longitude:this.myLng,professional:this.currentProfession,isIncludeOffers:!1,year:this.bookingDate.getFullYear(),month:this.bookingDate.getMonth(),day:this.bookingDate.getDate(),hours:this.bookingDate.getHours(),minutes:this.bookingDate.getMinutes(),description:this.orderDescription,status:"notSeen",ordered:this.target.id}}console.log("Address: "+this.address);const t=await G.A.addRecipient(this.userId,e),o=await G.A.getBookingById(t.id);await G.A.addProviderData(t.id,this.target.id);const i=await Y.A.addProviderBooking(this.target.id,t.id);if(e&&"Recipient is added!"===i){console.log("Iiiiisss "+(this.target.yritys+this.username));const i=this.target.yritys+this.username,a=(this.target.user.id,this.target.user.username,this.target.user.id);await this.$emit("booking_map:update",t),await re.A.emit("accept provider",{id:a,booking:o}),e=null}else console.log("There is error to load recipient!");this.$router.push("/received")}else console.log("Not all requied credentials are setted!")},async outFromMarkerPanel(){this.isTargetSelected=!1,this.noSelectUser();const e=await Y.A.getProviders();null!==e&&this.otherUserLocations(e,this.currentProfession,this.distBtw)},closeMapChat(){this.isMapChat=!1},async returnToMainPanel(){this.isMainPanel=!0,this.bookingDate=null,this.isSelectNotNow=!1,this.distBtw=0,await this.showClientLocationOnTheMap(this.currentProfession,this.distBtw),this.isPressedFindBtn=!1,this.noSelectUser()},closeMainPanel(){this.isMainPanel=!1,this.noSelectUser(),console.log("Close main panel")},async showClientLocationOnTheMap(e,t){console.log("Current distance herexx  "+t);const o=await Y.A.getProviders();null!==o&&(window.google,this.otherUserLocations(o,e,t))},identifyProfText(){this.countOfSelectedProfessional>1?this.professional="ammattilaista":this.professional="ammattilainen"}}},ge=o(1241);const ue=(0,ge.A)(ce,[["render",W]]);var pe=ue},7630:function(e,t,o){o.d(t,{A:function(){return p}});var i=o(6768),a=o(4232);const s={class:"pro-panel-feedback"},n={key:0},l={style:{"margin-bottom":"10px"}},r={key:1};function d(e,t,o,d,c,g){return(0,i.uX)(),(0,i.CE)("div",s,[(0,i.Lk)("p",{style:{"text-align":"right",cursor:"pointer",color:"orangered"},onClick:t[0]||(t[0]=t=>e.$emit("closeFeedbackList"))},"Poistu"),o.feedback.length>0?((0,i.uX)(),(0,i.CE)("div",n,[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(o.feedback,(e=>((0,i.uX)(),(0,i.CE)("div",{style:{"text-align":"left"},key:e.id},[(0,i.Lk)("p",l,(0,a.v_)(e.neg?e.neg:e.pos),1)])))),128))])):((0,i.uX)(),(0,i.CE)("div",r,t[1]||(t[1]=[(0,i.Lk)("p",null,"Ei arvostelua vielä!",-1)])))])}var c={name:"FeedbackList",props:{feedback:Array}},g=o(1241);const u=(0,g.A)(c,[["render",d]]);var p=u},8405:function(e,t){const o=(e,t)=>{const o=new Date(e.y,e.m,e.d,e.hour,e.min),i=new Date(t.y,t.m,t.d,t.hour,t.min);return i>=o},i=(e,t,o)=>{const i=new Date(t.y,t.m,t.d,t.hour,t.min),a=new Date(o.y,o.m,o.d,o.hour,o.min);return e>=i&&e<a};t.A={compare:o,providerMatchingForClient:i}}}]);
//# sourceMappingURL=407.8b1afd37.js.map