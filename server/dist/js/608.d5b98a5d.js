"use strict";(self["webpackChunkprore_mongo"]=self["webpackChunkprore_mongo"]||[]).push([[608],{3608:function(e,t,a){a.r(t),a.d(t,{default:function(){return O}});var l=a(3396),i=a(9242),o=a(7139);const n=(0,l._)("h2",{style:{"margin-top":"50px"}},"- Uusi tilaus -",-1),s={class:"ui form"},d={class:"field"},r=(0,l._)("option",{disabled:"",value:""},"Valitse ammattilainen",-1),u=(0,l._)("option",null,"Putkimies",-1),c=(0,l._)("option",null,"Sähkömies",-1),m=(0,l._)("option",null,"Siivooja",-1),p=[r,u,c,m],g=(0,l._)("option",{disabled:"",value:""},"Valitse ammattilainen",-1),h=(0,l._)("option",null,"Putkimies",-1),k=(0,l._)("option",null,"Sähkömies",-1),f=(0,l._)("option",null,"Siivooja",-1),w=[g,h,k,f],v=["src"],y={key:1,for:"file-upload",class:"custom-file-upload"},b={key:0},D={key:1};function I(e,t,a,r,u,c){const m=(0,l.up)("MDBInput"),g=(0,l.up)("VueDatePicker"),h=(0,l.up)("MDBBtn"),k=(0,l.up)("MDBCol"),f=(0,l.up)("MDBTextarea"),I=(0,l.up)("MDBRow"),_=(0,l.up)("MDBContainer");return(0,l.wg)(),(0,l.iD)("div",null,[n,(0,l.Wm)(_,null,{default:(0,l.w5)((()=>[(0,l._)("form",{class:"g-3 needs-validation",novalidate:"",onSubmit:t[8]||(t[8]=(0,i.iM)(((...e)=>c.checkForm&&c.checkForm(...e)),["prevent"]))},[(0,l.Wm)(m,{label:"Anna otsikko",modelValue:u.header,"onUpdate:modelValue":t[0]||(t[0]=e=>u.header=e),id:"header",size:"lg",invalidFeedback:"Ole hyvä ja kirjoita otsikko.",validFeedback:"Ok!",required:"",wrapperClass:"mb-4"},null,8,["modelValue"]),(0,l.Wm)(m,{label:"Anna osoitteesi",modelValue:u.address,"onUpdate:modelValue":t[1]||(t[1]=e=>u.address=e),id:"osoite",size:"lg",invalidFeedback:"Ole hyvä ja kirjoita osoite.",validFeedback:"Ok!",required:"",wrapperClass:"mb-4"},null,8,["modelValue"]),(0,l._)("div",s,[(0,l._)("div",d,[r.isNotSelected?(0,l.wy)(((0,l.wg)(),(0,l.iD)("select",{key:0,id:"noSelected",style:{"border-color":"red",color:"red","margin-bottom":"20px"},"onUpdate:modelValue":t[2]||(t[2]=e=>u.professional=e),onChange:t[3]||(t[3]=e=>r.isNotSelected=!1)},p,544)),[[i.bM,u.professional]]):(0,l.wy)(((0,l.wg)(),(0,l.iD)("select",{key:1,"onUpdate:modelValue":t[4]||(t[4]=e=>u.professional=e),style:{"margin-bottom":"20px"}},w,512)),[[i.bM,u.professional]])])]),(0,l.Wm)(g,{style:{"margin-bottom":"20px"},modelValue:r.date,"onUpdate:modelValue":t[5]||(t[5]=e=>r.date=e),"min-date":new Date,placeholder:"Missä ajalla haluat ammattilaista?",onInternalModelChange:c.handleInternalDate,state:!u.isNoDate&&null},null,8,["modelValue","min-date","onInternalModelChange","state"]),(0,l.Wm)(_,{style:{"margin-bottom":"20px"}},{default:(0,l.w5)((()=>[(0,l.Wm)(I,null,{default:(0,l.w5)((()=>[(0,l.Wm)(k,{md:"4"},{default:(0,l.w5)((()=>[r.showImage?((0,l.wg)(),(0,l.iD)("img",{key:0,src:r.showImage,style:{width:"200px","margin-bottom":"20px"},alt:"..."},null,8,v)):(0,l.kq)("",!0),r.isUploaded?(0,l.kq)("",!0):((0,l.wg)(),(0,l.iD)("label",y,[u.value?((0,l.wg)(),(0,l.iD)("span",b," Muokkaa kuva: "+(0,o.zw)(u.value.name),1)):((0,l.wg)(),(0,l.iD)("span",D,"Valitse kuva tehtävästä"))])),(0,l._)("input",{id:"file-upload",type:"file",onChange:t[6]||(t[6]=(...e)=>c.handleFileChange&&c.handleFileChange(...e))},null,32),r.isImageSelected?((0,l.wg)(),(0,l.j4)(h,{key:2,outline:"danger",size:"lg",block:"",onClick:c.removeFile},{default:(0,l.w5)((()=>[(0,l.Uk)("Poista valitsettu kuva")])),_:1},8,["onClick"])):(0,l.kq)("",!0),r.isImageSelected?((0,l.wg)(),(0,l.j4)(h,{key:3,outline:"success",size:"lg",block:"",style:{"margin-bottom":"10px"},onClick:c.uploadImage},{default:(0,l.w5)((()=>[(0,l.Uk)("Lataa valitsettu kuva")])),_:1},8,["onClick"])):(0,l.kq)("",!0)])),_:1}),(0,l.Wm)(k,{md:"8"},{default:(0,l.w5)((()=>[(0,l.Wm)(f,{label:"Tehtävän kuvaus...",rows:"4",modelValue:r.explanation,"onUpdate:modelValue":t[7]||(t[7]=e=>r.explanation=e),invalidFeedback:"Ole hyvä ja kirjoita tehtävän kuvaus.",validFeedback:"Ok!",required:""},null,8,["modelValue"])])),_:1})])),_:1})])),_:1}),(0,l.Wm)(h,{outline:"success",size:"lg",block:"",onClick:c.addRecipient,style:{"margin-top":"20px","margin-bottom":"20px"},type:"submit"},{default:(0,l.w5)((()=>[(0,l.Uk)("Tee tilaus")])),_:1},8,["onClick"])],32),(0,l.Wm)(h,{outline:"danger",size:"lg",block:"",onClick:c.cancelRecipientForm,style:{"margin-bottom":"50px"}},{default:(0,l.w5)((()=>[(0,l.Uk)(" Poistu ")])),_:1},8,["onClick"])])),_:1})])}a(7658),a(2062);var _=a(4912),C=a(4313),M=a(5800);const F=a(7218),S="/api/upload",V=async()=>{const e=await F.get(S);return e.data},x=async e=>{const t=await F.post(S,e,{});return t.data},B=async(e,t)=>{const a=await F.put(`${S}/${e}`,t);return a.data},U=async(e,t)=>{await F.delete(`${S}/${e}/${t}`)};var R={getAll:V,create:x,update:B,remove:U},j=a(7514),H=a(4870),N={name:"recipient-form",components:{MDBBtn:C.$v,MDBContainer:C.L5,MDBInput:C.u2,MDBRow:C.uZ,MDBCol:C.TK,MDBTextarea:C.uj,VueDatePicker:_.Z},data(){return{recipientId:null,header:"",address:null,lat:null,lng:null,isNoDate:!1,professional:"",addFile:null,dateTest:null,calendarTooltips:[],value:null,aaa:"",file:null,f:null}},setup(){const e=(0,H.iH)(null),t=(0,H.iH)(""),a=(0,H.iH)(!1),l=(0,H.iH)(null),i=(0,H.iH)(null),o=(0,H.iH)(!1),n=(0,H.iH)(!1),s=(0,H.iH)(!1);return{date:e,explanation:t,isImageSelected:a,imgId:l,showImage:i,isShowImage:o,isUploaded:n,isNotSelected:s}},computed:{currentRouteName(){return this.$route.name}},async mounted(){const e=window.localStorage.getItem("loggedAppUser");if(e){const t=JSON.parse(e);this.recipientId=t.id,console.log("User id in recipient: "+t.id)}const t={lat:50.064192,lng:-130.605469},a={north:t.lat+.1,south:t.lat-.1,east:t.lng+.1,west:t.lng-.1},l=document.getElementById("osoite"),i={bounds:a,componentRestrictions:{country:"fi"},fields:["address_components","geometry","icon","name","formatted_address"],strictBounds:!1},o=new google.maps.places.Autocomplete(l,i);o.addListener("place_changed",(()=>{let e=o.getPlace();this.lat=e.geometry.location.lat(),this.lng=e.geometry.location.lng(),this.address=e.formatted_address,console.log(e)}))},methods:{cancelRecipientForm(){"r-form"===this.currentRouteName?this.$router.push("/received"):this.$router.push("/")},async findRecipients(){const e=await M.Z.getOwnBookings(this.recipientId);console.log("Recipients "+e.length)},async remFile(){await R.remove("644cff805261bf7d9943c5da","644cff875261bf7d9943c5dd")},handleFileChange(e){try{const t=e.target.files[0];console.log("event target client ",e.target.files[0]),t&&(this.showImage=URL.createObjectURL(t),this.file=e.target.files[0])}catch(t){console.log("Error:",t)}this.value=e.target.files[0],e.target.files[0]?this.isImageSelected=!0:this.isImageSelected=!1},async uploadImage(){const e=new FormData;e.append("file",this.file,this.file.name);const t=await R.create(e);t&&(this.imgId=t.imgCreated._id,this.file=null,this.isImageSelected=!1,this.isUploaded=!0)},removeFile(){this.value=null,this.isImageSelected=!1,this.showImage=null},formatDate(e=Date){return e?(0,j.Z)(e,"dd.MM.yyyy, HH:mm"):null},backToDashboard(){},getDate(){console.log("selected date: "+this.date.getDate())},handleInternalDate(){console.log("Handled"),this.isNoDate=!1},async addRecipient(){let e;if(""===this.professional&&(this.isNotSelected=!0),this.date||(this.isNoDate=!0),this.date&&(e={header:this.header,address:this.address,latitude:this.lat,longitude:this.lng,professional:this.professional,year:this.date.getFullYear(),month:this.date.getMonth(),day:this.date.getDate(),hours:this.date.getHours(),minutes:this.date.getMinutes(),description:this.explanation,imageId:this.imgId}),this.header&&this.address&&this.professional&&this.date.getMonth()&&this.explanation){const t=await M.Z.addRecipient(this.recipientId,e);this.$emit("booking:update",t),console.log("Booking--- "+t),this.$router.push("/received")}},checkForm(e=Event){e.target.classList.add("was-validated")}}},W=a(89);const $=(0,W.Z)(N,[["render",I]]);var O=$}}]);
//# sourceMappingURL=608.d5b98a5d.js.map