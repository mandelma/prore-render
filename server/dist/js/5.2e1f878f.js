"use strict";(self["webpackChunkprore_mongo"]=self["webpackChunkprore_mongo"]||[]).push([[5],{1005:function(e,i,t){t.r(i),t.d(i,{default:function(){return de}});var o=t(6768),s=t(4232),l=t(5130);const n={style:{display:"flex","justify-content":"right",padding:"20px"}},a={class:"client-result-header"},d={key:0,class:"expired_date"},r={key:0},g={key:1},c={style:{display:"flex","justify-content":"right",cursor:"pointer"}},u={key:0},h={key:0},m={key:1},k={key:0},p={key:1},f={key:0},b=["src","alt"],_={key:1,class:"edit-panel"},v=["onChange"],y={for:"file-upload",class:"custom-file-upload"},D={key:0},I={key:1},C=["src"],w={key:2,class:"add-panel"},A={for:"file-upload-x",class:"custom-file-upload"},E={key:0},P={key:1},F=["src"],M={key:0},S={class:"ui large form"},x={class:"field"},L={style:{"margin-bottom":"20px"}},B={value:""},T={value:"distance"},X={value:"rating"},z={value:"price"},R={style:{"font-size":"14px"}},U={style:{"font-size":"14px"}},W={style:{"font-size":"14px"}},O={key:1},V={style:{width:"100%","margin-top":"17px"}};function $(e,i,t,$,Q,j){const N=(0,o.g2)("recipientFinal"),H=(0,o.g2)("MDBContainer"),K=(0,o.g2)("MDBBtnClose"),Y=(0,o.g2)("prompt-panel"),G=(0,o.g2)("successMessage"),J=(0,o.g2)("MDBTextarea"),Z=(0,o.g2)("MDBCol"),q=(0,o.g2)("MDBRow"),ee=(0,o.g2)("MDBBtn"),ie=(0,o.g2)("VueDatePicker"),te=(0,o.g2)("MDBTable"),oe=(0,o.g2)("error-message"),se=(0,o.g2)("MDBBadge");return Q.isProviderSelected?((0,o.uX)(),(0,o.Wv)(H,{key:0},{default:(0,o.k6)((()=>[(0,o.bF)(N,{"onCansel:final":j.handleCanselFinal,"onProvider:ordered":j.orderSuccess,proRefSlides:t.proRefSlides,test:t.test,provider:Q.selectedProvider,offer:Q.offer,proSlides:e.slides,room:Q.room,available:Q.availability,booking:t.booking,chatusers:t.chatusers,initialize_chat:e.handleInitializeChat,selecteduser:t.selecteduser,messages:t.messages,onMessage:j.onMessage,onSelect:j.selectUser,onNoSelect:j.noSelectUser,onJoin_chat_panel:j.handleJoinChatPanel},null,8,["onCansel:final","onProvider:ordered","proRefSlides","test","provider","offer","proSlides","room","available","booking","chatusers","initialize_chat","selecteduser","messages","onMessage","onSelect","onNoSelect","onJoin_chat_panel"])])),_:1})):((0,o.uX)(),(0,o.Wv)(H,{key:1},{default:(0,o.k6)((()=>[(0,o.Lk)("div",n,[(0,o.bF)(K,{white:"",style:{cursor:"pointer"},onClick:j.canselResult},null,8,["onClick"])]),(0,o.bF)(Y,{promptPanelContent:Q.promptPanelContent,"onPrompt:no":j.handlePromptNo,"onPrompt:yes":j.handlePromptYes},null,8,["promptPanelContent","onPrompt:no","onPrompt:yes"]),(0,o.Lk)("h2",a,(0,s.v_)(Q.t("recipient_result_need_a_pro"))+" - "+(0,s.v_)(t.line),1),t.booking.created_ms-(new Date).getTime()<=0&&t.booking.offers.length<1?((0,o.uX)(),(0,o.CE)("h5",d,(0,s.v_)(Q.t("recipient_result_order_is_expired")),1)):(0,o.Q3)("",!0),(0,o.bF)(G,{message:Q.orderMessage},null,8,["message"]),(0,o.bF)(q,{style:{"margin-top":"50px"}},{default:(0,o.k6)((()=>[(0,o.bF)(Z,{class:"client-result"},{default:(0,o.k6)((()=>[(0,o.bF)(te,{borderless:"",style:{"font-size":"17px",color:"#dddddd","text-align":"left"}},{default:(0,o.k6)((()=>[(0,o.Lk)("tbody",null,[(0,o.Lk)("tr",null,[Q.isEditDescription?((0,o.uX)(),(0,o.CE)("td",g,[(0,o.bF)(q,null,{default:(0,o.k6)((()=>[(0,o.bF)(Z,null,{default:(0,o.k6)((()=>[(0,o.bF)(J,{label:Q.t("recipient_result_edit_description"),white:"",rows:"4",modelValue:Q.description,"onUpdate:modelValue":i[0]||(i[0]=e=>Q.description=e),style:{"font-size":"14px",padding:"20px"}},null,8,["label","modelValue"])])),_:1}),(0,o.bF)(Z,{col:"1"},{default:(0,o.k6)((()=>[(0,o.Lk)("div",c,[(0,o.bF)(K,{white:"",onClick:i[1]||(i[1]=e=>Q.isEditDescription=!1)})])])),_:1})])),_:1})])):((0,o.uX)(),(0,o.CE)("td",r,[(0,o.Lk)("p",null,(0,s.v_)(t.booking.description),1)]))]),t.booking.offers.length<1?((0,o.uX)(),(0,o.CE)("tr",u,[Q.isEditDescription?((0,o.uX)(),(0,o.CE)("td",m,[(0,o.bF)(ee,{outline:"info",block:"",size:"lg",onClick:j.saveEditedDescription},{default:(0,o.k6)((()=>i[8]||(i[8]=[(0,o.eW)("Tallenna tehtävän kuvaus")]))),_:1},8,["onClick"])])):((0,o.uX)(),(0,o.CE)("td",h,[(0,o.bF)(ee,{outline:"info",block:"",size:"lg",onClick:j.pressedEditDescription},{default:(0,o.k6)((()=>i[7]||(i[7]=[(0,o.eW)("Muokkaa tehtävän kuvausta")]))),_:1},8,["onClick"])]))])):(0,o.Q3)("",!0),(0,o.Lk)("tr",null,[Q.isEditDate?((0,o.uX)(),(0,o.CE)("td",p,[(0,o.bF)(q,null,{default:(0,o.k6)((()=>[(0,o.bF)(Z,{col:"8"},{default:(0,o.k6)((()=>[(0,o.Lk)("h4",{class:(0,s.C4)({expired_date:t.booking.created_ms-(new Date).getTime()<=0})},[(0,o.eW)((0,s.v_)(Q.bookingDateToDisplay),1),i[9]||(i[9]=(0,o.Lk)("br",null,null,-1)),(0,o.eW)(" klo   "+(0,s.v_)(new Date(t.booking.created).getHours()<10?"0"+new Date(t.booking.created).getHours():new Date(t.booking.created).getHours())+" : "+(0,s.v_)(new Date(t.booking.created).getMinutes()<10?"0"+new Date(t.booking.created).getMinutes():new Date(t.booking.created).getMinutes()),1)],2),(0,o.bF)(ie,{style:{"margin-bottom":"20px"},dark:"",modelValue:Q.bookingDate,"onUpdate:modelValue":i[2]||(i[2]=e=>Q.bookingDate=e),"min-date":new Date,placeholder:Q.t("recipient_result_select_date"),onInternalModelChange:j.handleInternalDate,state:!e.isNoDate&&null},null,8,["modelValue","min-date","placeholder","onInternalModelChange","state"])])),_:1}),(0,o.bF)(Z,{col:"4"},{default:(0,o.k6)((()=>[(0,o.bF)(K,{white:"",onClick:i[3]||(i[3]=e=>Q.isEditDate=!1),style:{float:"right",cursor:"pointer"}})])),_:1})])),_:1})])):((0,o.uX)(),(0,o.CE)("td",k,[(0,o.Lk)("p",{class:(0,s.C4)({expired_date:t.booking.created_ms-(new Date).getTime()<=0&&t.booking.offers.length<1})},(0,s.v_)(Q.bookingDateToDisplay)+"   klo   "+(0,s.v_)(new Date(t.booking.created).getHours()<10?"0"+new Date(t.booking.created).getHours():new Date(t.booking.created).getHours())+" : "+(0,s.v_)(new Date(t.booking.created).getMinutes()<10?"0"+new Date(t.booking.created).getMinutes():new Date(t.booking.created).getMinutes()),3),t.booking.offers.length<1?((0,o.uX)(),(0,o.Wv)(ee,{key:0,block:"",size:"lg",outline:"info",onClick:j.editDate},{default:(0,o.k6)((()=>[(0,o.Lk)("span",{class:(0,s.C4)({expired_warning:t.booking.created_ms-(new Date).getTime()<=0})},(0,s.v_)(Q.t("recipient_result_edit_date")),3)])),_:1},8,["onClick"])):(0,o.Q3)("",!0)]))])])])),_:1}),t.booking.offers.length<1?((0,o.uX)(),(0,o.CE)("div",f,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(t.images,((e,i)=>((0,o.uX)(),(0,o.CE)("div",{key:i},[(0,o.Lk)("img",{class:"loading",style:{width:"100%"},src:e.blob?e.blob:e.imageUrl,alt:e.id},null,8,b),Q.isEditPanel?(0,o.Q3)("",!0):((0,o.uX)(),(0,o.Wv)(ee,{key:0,block:"",outline:"success",onClick:e=>j.pressEditPanel(i)},{default:(0,o.k6)((()=>[(0,o.eW)((0,s.v_)(Q.t("recipient_result_edit_picture")),1)])),_:2},1032,["onClick"])),Q.isEditPanel&&Q.imageIndex===i?((0,o.uX)(),(0,o.CE)("div",_,[(0,o.bF)(oe,{message:Q.wrong_SizeType_Message},null,8,["message"]),t.booking.offers.length<1?((0,o.uX)(),(0,o.Wv)(q,{key:0},{default:(0,o.k6)((()=>[(0,o.bF)(Z,null,{default:(0,o.k6)((()=>[Q.value?(0,o.Q3)("",!0):((0,o.uX)(),(0,o.Wv)(K,{key:0,white:"",class:"close-btn",style:{float:"right"},onClick:j.closeEditPanel},null,8,["onClick"])),(0,o.Lk)("input",{id:"file-upload",type:"file",onChange:e=>j.handleFileChange(e,i)},null,40,v),(0,o.Lk)("label",y,[Q.value?((0,o.uX)(),(0,o.CE)("span",D,(0,s.v_)(Q.t("recipient_result_edit_order_picture"))+": "+(0,s.v_)(Q.value.name),1)):((0,o.uX)(),(0,o.CE)("span",I,(0,s.v_)(Q.t("recipient_result_select_new_image")),1))]),Q.isEditImage?((0,o.uX)(),(0,o.Wv)(ee,{key:1,block:"",color:"success",onClick:t=>j.uploadEditedImage(i,e.key)},{default:(0,o.k6)((()=>[(0,o.eW)((0,s.v_)(Q.t("recipient_result_upload_edited_image")),1)])),_:2},1032,["onClick"])):(0,o.Q3)("",!0),(0,o.bF)(ee,{class:"btn",block:"",size:"lg",color:"danger",onClick:t=>j.removeImg(i,e.key)},{default:(0,o.k6)((()=>[(0,o.eW)((0,s.v_)(Q.t("recipient_result_remove_image")),1)])),_:2},1032,["onClick"])])),_:2},1024),Q.value?((0,o.uX)(),(0,o.Wv)(Z,{key:0},{default:(0,o.k6)((()=>[(0,o.bF)(K,{white:"",class:"close-btn",style:{float:"right"},onClick:j.closeEditPanel},null,8,["onClick"]),(0,o.Lk)("img",{style:{width:"100px","padding-top":"20px"},src:this.showImage,alt:"addEdit"},null,8,C)])),_:1})):(0,o.Q3)("",!0)])),_:2},1024)):(0,o.Q3)("",!0)])):(0,o.Q3)("",!0)])))),128))])):(0,o.Q3)("",!0),!Q.isPressedAddlmage&t.booking.offers.length<1?((0,o.uX)(),(0,o.Wv)(ee,{key:1,block:"",color:"primary",onClick:j.pressedAddImage},{default:(0,o.k6)((()=>[(0,o.eW)((0,s.v_)(Q.t("recipient_result_add_image")),1)])),_:1},8,["onClick"])):(0,o.Q3)("",!0),Q.isPressedAddlmage&&Q.isAddImagePanel?((0,o.uX)(),(0,o.CE)("div",w,[(0,o.bF)(oe,{message:Q.wrong_SizeType_Message},null,8,["message"]),(0,o.bF)(q,null,{default:(0,o.k6)((()=>[(0,o.bF)(Z,null,{default:(0,o.k6)((()=>[Q.value?(0,o.Q3)("",!0):((0,o.uX)(),(0,o.Wv)(K,{key:0,white:"",class:"close-btn",onClick:j.closeAddPanel},null,8,["onClick"])),(0,o.Lk)("input",{id:"file-upload-x",type:"file",onChange:i[4]||(i[4]=i=>j.handleFileChange(i,e.i))},null,32),(0,o.Lk)("label",A,[Q.value?((0,o.uX)(),(0,o.CE)("span",E," Muokka tehtävän kuvausta: "+(0,s.v_)(Q.value.name)+" + ",1)):((0,o.uX)(),(0,o.CE)("span",P,"Valitse lisää kuva tehtävästä"))]),Q.isAddImage?((0,o.uX)(),(0,o.Wv)(ee,{key:1,block:"",outline:"primary",onClick:j.addAdditionalImage},{default:(0,o.k6)((()=>i[10]||(i[10]=[(0,o.eW)("Tallenna kuva")]))),_:1},8,["onClick"])):(0,o.Q3)("",!0)])),_:1}),Q.value?((0,o.uX)(),(0,o.Wv)(Z,{key:0},{default:(0,o.k6)((()=>[(0,o.bF)(K,{class:"close-btn",white:"",onClick:j.closeAddPanel},null,8,["onClick"]),(0,o.Lk)("img",{style:{width:"100px"},src:this.showImage,alt:"addShow"},null,8,F)])),_:1})):(0,o.Q3)("",!0)])),_:1})])):(0,o.Q3)("",!0)])),_:1}),(0,o.bF)(Z,{lg:"6"},{default:(0,o.k6)((()=>[t.booking_offers.length>0?((0,o.uX)(),(0,o.CE)("div",M,[(0,o.Lk)("div",S,[(0,o.Lk)("div",x,[(0,o.Lk)("h3",L,(0,s.v_)(Q.t("recipient_result_offers")),1),(0,o.bo)((0,o.Lk)("select",{style:{padding:"20px","background-color":"#3c3535",color:"lightgrey","font-size":"18px"},id:"listOfProviders","onUpdate:modelValue":i[5]||(i[5]=e=>Q.filterResult=e),onClick:i[6]||(i[6]=(...e)=>j.addFilter&&j.addFilter(...e))},[(0,o.Lk)("option",B,(0,s.v_)(Q.t("recipient_result_filter")),1),(0,o.Lk)("option",T,(0,s.v_)(Q.t("recipient_result_filter_by_distance")),1),(0,o.Lk)("option",X,(0,s.v_)(Q.t("recipient_result_filter_by_rating")),1),(0,o.Lk)("option",z,(0,s.v_)(Q.t("recipient_result_filter_by_price")),1)],512),[[l.u1,Q.filterResult]])])]),i[14]||(i[14]=(0,o.Lk)("br",null,null,-1)),(0,o.bF)(te,{style:{"font-size":"18px","text-align":"center",position:"relative"}},{default:(0,o.k6)((()=>[(0,o.Lk)("tbody",null,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(t.booking_offers,(e=>((0,o.uX)(),(0,o.CE)("tr",{key:e.id},[(0,o.Lk)("td",null,[(0,o.bF)(ee,{class:"provider-selection",outline:"info",size:"lg",onClick:i=>j.getProviderInfo(e.provider,e,"orange")},{default:(0,o.k6)((()=>[(0,o.eW)((0,s.v_)(e.provider.yritys)+" ",1),i[11]||(i[11]=(0,o.Lk)("br",null,null,-1)),(0,o.Lk)("span",R,(0,s.v_)(Q.t("recipient_result_distance"))+" "+(0,s.v_)(e.distance)+" km",1),i[12]||(i[12]=(0,o.Lk)("br",null,null,-1))])),_:2},1032,["onClick"]),e.isNewOffer?((0,o.uX)(),(0,o.Wv)(se,{key:0,color:"danger",class:"translate-middle p-3",pill:"",notification:""},{default:(0,o.k6)((()=>[(0,o.Lk)("span",U,[(0,o.eW)((0,s.v_)(Q.t("recipient_result_new"))+" ",1),i[13]||(i[13]=(0,o.Lk)("br",null,null,-1)),(0,o.eW)((0,s.v_)(e.price)+" eur ",1)])])),_:2},1024)):((0,o.uX)(),(0,o.Wv)(se,{key:1,color:"info",class:"translate-middle p-3",pill:"",notification:""},{default:(0,o.k6)((()=>[(0,o.Lk)("span",W,(0,s.v_)(e.price)+" eur ",1)])),_:2},1024))])])))),128))])])),_:1})])):((0,o.uX)(),(0,o.CE)("div",O,[(0,o.Lk)("h2",V,(0,s.v_)(Q.t("recipient_result_waiting_offers")),1)]))])),_:1}),(0,o.bF)(ee,{block:"",color:"danger",size:"sm",onClick:j.removeOfferedBookings},{default:(0,o.k6)((()=>[(0,o.eW)((0,s.v_)(Q.t("recipient_result_remove_order")),1)])),_:1},8,["onClick"])])),_:1})])),_:1}))}t(4114),t(8111),t(7588),t(3579);var Q=t(5846),j=t(8405),N=t(9750),H=t(7337),K=t(4482),Y=t(5607),G=t(1769),J=t(2456),Z=t(4474),q=t(5570),ee=t(8269),ie=t(8068),te=t(407),oe=t(5384),se=t(1690),le=(t(2815),{name:"recipient-panel-result",props:{test:Boolean,chatusers:Array,proRefSlides:Array,selecteduser:null,messages:Array,loggedInUser:Object,booking:null,booking_offers:[],images:Array,bookingTime:null,providers:Array,confirmedBookings:Array,line:String},data(){const{t:e}=(0,oe.s9)();return{t:e,IMAGE_SIZE:1e6,offer:null,chatUser:null,count:0,promptPanelContent:null,wrong_SizeType_Message:null,datetime:j.A,distance:Y.A,selectedProvider:null,proSlides:[],isProviderSelected:!1,availability:"",orderMessage:null,isOrdered:!1,isEditDescription:!1,description:this.booking.description,isEditDate:!1,bookingDate:new Date(this.booking.created),bookingDateToDisplay:this.booking.date,isAddFirstImage:!1,isPressedAddlmage:!1,isAddImage:!1,isAddImagePanel:!1,isEditImage:!1,isUploadImage:!1,isUploaded:!1,isImageCreated:!1,isAddNewImage:!1,isEditPanel:!1,value:null,imageIndex:0,file:null,files:null,isImageSelected:!1,isAdditionalImageSelected:!1,showImage:null,tempImages:[],imagesx:[],imagesxxx:[],room:"",roomUserCount:0,filterResult:""}},components:{successMessage:H.A,errorMessage:K.A,VueDatePicker:ie.A,promptPanel:ee["default"],dist:Y.A,recipientFinal:N["default"],MDBBtn:Q.al,MDBBtnClose:Q.uR,MDBContainer:Q.Dj,MDBTable:Q.EU,MDBRow:Q.gU,MDBCol:Q.m6,MDBTextarea:Q.QP,MDBIcon:Q.$u,MDBBadge:Q.nf},methods:{handlePromptNo(){console.log("Said NO!"),this.promptPanelContent=null},handlePromptYes(){console.log("Said YES!"),this.promptPanelContent=null,this.$emit("removeOfferedBooking",this.booking,this.booking.offers)},editDate(){this.isEditDate=!0},async handleInternalDate(){if(this.bookingDate){console.log("new date: "+new Date(this.bookingDate).getTime()),this.bookingDateToDisplay=this.bookingDate.getMonth()+1+"/"+this.bookingDate.getDate()+"/"+this.bookingDate.getFullYear(),console.log("eeeeee "+(this.bookingDate.getMonth()+1)+"/"+this.bookingDate.getDate()+"/"+this.bookingDate.getFullYear());const e=new Date(this.bookingDate).getTime();new Date(this.bookingDate);await te.A.newDate(this.booking.id,{year:this.bookingDate.getFullYear(),month:this.bookingDate.getMonth(),day:this.bookingDate.getDate(),hours:this.bookingDate.getHours(),minutes:this.bookingDate.getMinutes(),date_ms:e});const i={year:this.bookingDate.getFullYear(),month:this.bookingDate.getMonth(),day:this.bookingDate.getDate(),hours:this.bookingDate.getHours(),minutes:this.bookingDate.getMinutes()};this.$emit("updateBookingDate",this.booking,i)}console.log("Date is handled")},handleFileChange(e,i){console.log("i in file change "+i),this.imageIndex=i;try{const i=e.target.files[0];if(console.log("event target client ",e.target.files[0]),i){const t=URL.createObjectURL(i);this.tempImages.push(t),this.showImage=URL.createObjectURL(i),this.file=e.target.files[0],this.files=e.target.files[0],this.isAddImage=!0,this.isEditImage=!0}}catch(t){console.log("Error:",t)}this.value=e.target.files[0]},pressedAddImage(){this.isAddImage=!1,this.isEditImage=!1,this.isEditPanel=!1,this.isPressedAddlmage=!0,this.isAddImagePanel=!0},async addImage(){},pressEditPanel(e){this.isEditImage=!1,this.value=null,this.imageIndex=e,this.isPressedAddlmage=!1,this.isEditPanel=!0,this.isAddImagePanel=!1},closeEditPanel(){this.isAddImagePanel=!1,this.isEditPanel=!1,this.isEditImage=!1,this.value=null},closeAddPanel(){this.isAddImagePanel=!1,this.isPressedAddlmage=!1,this.value=null},async uploadEditedImage(e,i){console.log("Edited image index is: "+e),console.log("Edited image key is: "+i),this.isEditPanel=!1,this.isEditImage=!1;const t=new FormData;t.append("file",this.file,this.file.name),console.log("Image id "+this.images[e]._id);const o=this.file.type;if("image/jpeg"===o||"image/jpg"===o||"image/png"===o||"image/gif"===o)if(this.file.size<=this.IMAGE_SIZE){const o=await q.A.editClientImage(this.images[e]._id,i,t);if(console.log("Edited client image key is: "+o.key),o){this.$emit("editImage",e,this.images[e]._id,o.key,this.showImage),console.log("ORDRED in EDIT pikkus "+this.booking.ordered.length);let i=[];this.booking.ordered.forEach((e=>{console.log("CVCVCV "+e.user.username),i=i.concat(e.user.id)}));const t=new FileReader;this.file&&(t.onload=t=>{const o=new Uint8Array(t.target.result);console.log("FILES.... "+this.files),se.A.emit("display edited booking image",this.images[e]._id,o,this.booking.id,i)},t.readAsArrayBuffer(this.files)),console.log("New image id is "+this.images[e]._id),this.imgId=this.images[e]._id,this.file=null,this.isEditPanel=!1,this.closeAddPanel()}}else this.isEditPanel=!0,this.closeAddPanel(),this.wrong_SizeType_Message="Väärä formaati. Kuva pitäisi olla jpeg, jpg, png tai gif formaatissa!",setTimeout((()=>{this.wrong_SizeType_Message=null}),3e3);else this.isEditPanel=!0,this.closeAddPanel(),this.wrong_SizeType_Message="Kuvan maximi koko on oltava 3 MB!",setTimeout((()=>{this.wrong_SizeType_Message=null}),3e3)},async addAdditionalImage(){this.value=null,this.isAddImagePanel=!1,this.isAddImage=!1,this.isPressedAddlmage=!1;const e=new FormData;e.append("file",this.file,this.file.name),console.log("IMG size - "+this.file.size),console.log("Image type_ "+this.file.type);const i=this.file.type;if("image/jpeg"===i||"image/jpg"===i||"image/png"===i||"image/gif"===i)if(console.log("Pildi formaat on OK"),this.file.size<=this.IMAGE_SIZE){const i=new FileReader,t=await q.A.uploadClientImage(e);if(t){console.log("AWS image id: "+t.id),console.log("AWS image key: "+t.key),await te.A.addImage(this.booking.id,t.id);const e={_id:t.id,key:t.key,blob:this.showImage};this.$emit("addImage",e,this.booking.id),console.log("ORDRED pikkus "+this.booking.ordered.length);let o=[];this.booking.ordered.forEach((e=>{console.log("CVCVCV "+e.user.username),o=o.concat(e.user.id)})),i.onload=e=>{const i=new Uint8Array(e.target.result);console.log("FILES IN UPLOAD.... "+this.files);const s={id:t._id,bytes:i};se.A.emit("display booking image",s,this.booking.id,o)},i.readAsArrayBuffer(this.files)}}else console.log("Pildi suurus peab olema väiksem kui 1 MB"),this.isAddImagePanel=!0,this.isPressedAddlmage=!0,this.wrong_SizeType_Message="Kuvan maximi koko on 3 MB.",setTimeout((()=>{this.wrong_SizeType_Message=null}),3e3);else console.log("Pildi formaat on FAKE"),this.wrong_SizeType_Message="Väärä formaati. Kuva pitäisi olla jpeg, jpg, png tai gif formaatissa!",setTimeout((()=>{this.wrong_SizeType_Message=null}),3e3)},async removeImg(e,i){this.images[e].blob||console.log("removed image is blob"),console.log("removable image id is "+this.images[e]._id),console.log("Removing image by key: "+i),await te.A.removeImage(this.booking.id,this.images[e]._id),await q.A.deleteImage(this.images[e]._id,i);let t=[];this.booking.ordered.forEach((e=>{t=t.concat(e.user.id)})),se.A.emit("stop display booking image",this.images[e]._id,this.booking,t),this.$emit("removeImage",e),this.isEditPanel=!1},getDistance(){console.log("sss "+Y.A.test())},selectUser(e){this.$emit("select",e)},noSelectUser(){this.$emit("noSelect")},onMessage(e,i){this.$emit("message",e,i)},handleJoinChatPanel(){console.log("Final info in result pressed "),this.$emit("joinChatPanel",this.room)},async pressAddFirstImage(){this.isAddFirstImage=!0,this.imageIndex=0},pressAdditionalImage(e){this.isAddImage=!0,this.imageIndex=this.images.length,console.log("Images index = "+this.imageIndex),this.isAddImage=!0},async uploadAdditionalImage(){this.isAdditionalImageSelected=!1,this.isAddImage=!1,this.value=null,console.log("Image index index "+this.imageIndex);const e=new FormData;this.isUploadImage=!0,this.isUploaded=!0,e.append("file",this.file,this.file.name);const i=await Z.A.create(e);if(await te.A.addImage(this.booking.id,i.imgCreated._id),i){this.file=null;const e={_id:i.imgCreated._id,image:i.imgCreated.image,name:i.imgCreated.name,blob:this.showImage};this.$emit("addImage",e),this.isImageSelected=!1,this.isUploaded=!0}},pressedEditDescription(){this.isEditDescription=!0,console.log("Descripton: "+this.description)},saveEditedDescription(){this.isEditDescription=!1;const e={description:this.description};this.$emit("editDescription",this.description),te.A.editDescription(this.booking.id,e)},cancelEditDescription(){console.log("Is here something happening??")},providerGetBooking(e,i){console.log("Sended to user id... "+e),se.A.emit("accept provider",{id:e,booking:i})},async orderSuccess(e){if(console.log("Include offers? "+this.booking.isIncludeOffers),this.booking.isIncludeOffers){this.canselResult(),console.log("## bef "+this.booking.ordered.length),this.$emit("offer_confirmed",this.booking,e.id),console.log("## aft "+this.booking.ordered.length);const i=await G.A.getProvByProvId(e.id);console.log("Offer confirmation user id "+i.user.id);this.selectedProvider.id;await te.A.updateRecipient(this.booking.id,{status:"confirmed"});this.booking.id;console.log("Username here???? "+this.booking.user.username);let t=[],o=[],s=[],l=[];if(this.booking){t=this.booking.offers;const e=this.booking.ordered;for(let t in e)e[t].user.id!==i.user.id&&s.push(e[t]);for(let i in t)t[i].room!==this.room&&await J.A.removeBookingOffer(t[i].id,this.booking.id)}let n={};for(let e in t)console.log("Offer maker id heeeeeere "+t[e].provider.user.id),t[e].provider.user.id!==i.user.id?(o=o.concat(t[e]),console.log("eeeeeeeeeeeeeeeeeeeee "+t[e].provider.user.id),await G.A.removeProviderBooking(t[e].provider.id,this.booking.id),await te.A.removeProviderData(this.booking.id,t[e].provider.id)):n=t[e];console.log("offerMakers length "+o.length),s.forEach((e=>{o.some((i=>i.provider.id===e.id))||l.push(e)})),console.log("ampIDs "+s.map((e=>e.id))),console.log("REST OF PROS "+l.map((e=>e)));for(let e in l)console.log("Test id "+l[e].id),await G.A.removeProviderBooking(l[e].id,this.booking.id),await te.A.removeProviderData(this.booking.id,l[e].id);se.A.emit("confirm offer",i.user.id,this.booking,n),se.A.emit("deal done notification",o,l,this.booking,n)}else this.isProviderSelected=!1,console.log("No booking with offers here!")},async orderSuccess_standing(e){this.isProviderSelected=!1,console.log("Provider id "+e.id),console.log("Recpient id: "+this.booking.id),this.canselResult(),this.$emit("offer_confirmed",this.booking);this.selectedProvider.id,await te.A.updateRecipient(this.booking.id,{status:"confirmed"}),this.booking.id},async getProviderInfo(e,i,t){this.proSlides=[],this.offer=i,this.selectedProvider=e,this.booking.isIncludeOffers&&i.isNewOffer&&this.$emit("editBookingOfferStatus",i),e.reference.forEach((e=>{this.proSlides=[...this.proSlides,e]})),this.availability=t,this.isProviderSelected=!0;let o="",s="";this.chatUser&&(s=this.chatUser.username,o=e.yritys+s,this.room=o)},async roomToDb(e,i){await G.A.addRoom(e,i)},addFilter(){const e=document.getElementById("listOfProviders");e.addEventListener("change",(e=>{console.log("Filtered provider: "+e.target.value),this.$emit("filter_provider",e.target.value)}))},handleCanselFinal(e){this.isProviderSelected=e},canselResult(){this.$emit("cansel:result",!1)},async removeOfferedBookings(){!0===confirm("Oletko varmaa, että haluat poistaa tilauksen!?")?this.$emit("removeOfferedBooking",this.booking,this.booking.offers):console.log("You canceled!")}},async mounted(){const e=window.localStorage.getItem("loggedAppUser");if(e){const i=JSON.parse(e);this.chatUser=i}}}),ne=t(1241);const ae=(0,ne.A)(le,[["render",$],["__scopeId","data-v-d0fa3894"]]);var de=ae},1644:function(e,i,t){e.exports=t.p+"img/error.9510853e.png"},4482:function(e,i,t){var o=t(6768);const s=({message:e})=>null===e?null:(0,o.bF)("div",{className:"error"},[e,(0,o.bF)("img",{className:"errorImg",alt:"error",src:t(1644)},null)]);i.A=s},8405:function(e,i){const t=(e,i)=>{const t=new Date(e.y,e.m,e.d,e.hour,e.min),o=new Date(i.y,i.m,i.d,i.hour,i.min);return o>=t},o=(e,i,t)=>{const o=new Date(i.y,i.m,i.d,i.hour,i.min),s=new Date(t.y,t.m,t.d,t.hour,t.min);return e>=o&&e<s};i.A={compare:t,providerMatchingForClient:o}}}]);
//# sourceMappingURL=5.2e1f878f.js.map