"use strict";(self["webpackChunkprore_mongo"]=self["webpackChunkprore_mongo"]||[]).push([[853],{5800:function(e,t,o){const a=o(7218),n="/api/recipients",s=async()=>{const e=await a.get(n);return e.data},i=async(e,t)=>{const o=await a.post(`${n}/${e}`,t);return o.data};t["Z"]={getRecipients:s,addRecipient:i}},853:function(e,t,o){o.r(t),o.d(t,{default:function(){return k}});o(7658);var a=o(3396),n=o(9242),s=o(7139);const i={id:"test",style:{"background-color":"white"}},l={class:"ui large segment form"},r={class:"field"},c=(0,a._)("option",{disabled:"",value:""},"Valitse ammattisi",-1),g=(0,a._)("option",{value:"Putkimies"},"Putkimies",-1),p=(0,a._)("option",{value:"Sähkömies"},"Sähkömies",-1),m=(0,a._)("option",{value:"Siivooja"},"Siivooja",-1),d=[c,g,p,m],u=(0,a._)("section",{id:"map"},null,-1);function h(e,t,o,c,g,p){const m=(0,a.up)("MDBInput"),h=(0,a.up)("MDBBtn"),y=(0,a.up)("MDBContainer");return(0,a.wg)(),(0,a.iD)("div",null,[(0,a.Wm)(y,{style:{position:"relative","z-index":"1",opacity:"0.8","margin-top":"60px"}},{default:(0,a.w5)((()=>[(0,a._)("div",i,[(0,a.Wm)(m,{label:"Anna osoitteesi",modelValue:g.address,"onUpdate:modelValue":t[0]||(t[0]=e=>g.address=e),id:"autocomplite",size:"lg",wrapperClass:"mb-4"},null,8,["modelValue"])]),(0,a._)("div",l,[(0,a._)("div",r,[(0,a.wy)((0,a._)("select",{id:"listOfProfessions","onUpdate:modelValue":t[1]||(t[1]=e=>g.prof=e)},d,512),[[n.bM,g.prof]])]),(0,a._)("h3",{class:(0,s.C_)({activeClients:!g.isActiveClients})},(0,s.zw)(g.countOfSelectedClients+" "+g.client)+" tarvitsee palveluasi ",3),g.prof?((0,a.wg)(),(0,a.iD)("h3",{key:0,class:(0,s.C_)({noClients:g.isActiveClients})}," Ei asiakkaita vielä! ",2)):(0,a.kq)("",!0)]),(0,a.Wm)(h,{color:"dark",size:"lg",block:"",onClick:t[2]||(t[2]=t=>e.$router.push("/provider-form")),style:{position:"relative","z-index":"1",opacity:"1.2"}},{default:(0,a.w5)((()=>[(0,a.Uk)(" Tarjoa omaa palvelua ")])),_:1}),(0,a.Wm)(h,{color:"danger",size:"lg",block:"",onClick:t[3]||(t[3]=t=>e.$router.push("/")),style:{position:"relative","z-index":"1",opacity:"1.0"}},{default:(0,a.w5)((()=>[(0,a.Uk)(" Poistu ")])),_:1})])),_:1}),u])}var y=o(4161),f=o(5800),v=o(4313);var w={name:"provider-public",components:{MDBContainer:v.L5,MDBInput:v.u2,MDBBtn:v.$v},data(){return{prof:"",address:null,myLat:null,mylng:null,countOfSelectedClients:0,isActiveClients:!1,client:""}},mounted(){new google.maps.Marker({icon:"http://maps.google.com/mapfiles/ms/icons/green-dot.png"});this.userCurrentLocation();const e=document.getElementById("listOfProfessions");e.addEventListener("change",(e=>{this.showClientLocationOnTheMap(e.target.value)}));const t=document.getElementById("autocomplite"),o={lat:50.064192,lng:-130.605469},a={north:o.lat+.1,south:o.lat-.1,east:o.lng+.1,west:o.lng-.1},n={bounds:a,componentRestrictions:{country:"fi"},fields:["address_components","geometry","icon","name","formatted_address"],strictBounds:!1},s=new google.maps.places.Autocomplete(t,n);s.addListener("place_changed",(()=>{let e=s.getPlace();this.myLat=e.geometry.location.lat(),this.myLng=e.geometry.location.lng(),this.getAddressFrom(e.geometry.location.lat(),e.geometry.location.lng()),this.address=e.formatted_address,console.log(e)}))},methods:{userCurrentLocation(){navigator.geolocation&&navigator.geolocation.getCurrentPosition((e=>{const{latitude:t,longitude:o}=e.coords;this.myLat=t,this.myLng=o,this.showUserLocationOnTheMap(t,o)}))},pinSymbol(e){return{path:"M 0,0 C -2,-20 -10,-22 -10,-30 A 10,10 0 1,1 10,-30 C 10,-22 2,-20 0,0 z",fillColor:e,fillOpacity:1,strokeColor:"#000",strokeWeight:2,scale:1}},showUserLocationOnTheMap(e,t){let o=new google.maps.Map(document.getElementById("map"),{zoom:13,center:new google.maps.LatLng(e,t),mapTypeId:google.maps.MapTypeId.ROADMAP,accuracy:50});new google.maps.Marker({position:new google.maps.LatLng(e,t),accuracy:50,map:o,icon:this.pinSymbol("yellow"),label:{color:"#00aaff",fontWeight:"bold",fontSize:"14px",text:"Olen tällä"}})},getAddressFrom(e,t){y.Z.get("https://maps.googleapis.com/maps/api/geocode/json?latlng="+e+","+t+"&key=AIzaSyBDA2EBoGezJx51wQtxoW3Ecq5Ql8CCAiE").then((o=>{if(o.data.error_message)this.error=o.data.error_message,console.log(o.data.error_message);else{const a=new google.maps.Map(document.getElementById("map"),{zoom:13,center:new google.maps.LatLng(e,t),mapTypeId:google.maps.MapTypeId.ROADMAP});new google.maps.Marker({position:new google.maps.LatLng(e,t),accuracy:50,map:a,icon:this.pinSymbol("yellow"),label:{color:"#00aaff",fontWeight:"bold",fontSize:"14px",text:"Olen tällä"}}),console.log(o.data.results.results[0].formatted_address)}})).catch((e=>{this.error=e.message,console.log(e.message)}))},otherUserLocations(e,t){let o=new google.maps.Map(document.getElementById("map"),{zoom:9,center:new google.maps.LatLng(this.myLat,this.myLng),mapTypeId:google.maps.MapTypeId.ROADMAP});console.log("Users count: "+e.length),new google.maps.Marker({position:new google.maps.LatLng(this.myLat,this.myLng),accuracy:50,map:o,icon:this.pinSymbol("yellow"),label:{color:"#00aaff",fontWeight:"bold",fontSize:"14px",text:"Olen tällä"}});let a=0;if(e.length>0){for(let n=0;n<e.length;n++)e[n].professional.forEach((s=>{s===t&&(this.isActiveClients=!0,a++,new google.maps.Marker({position:new google.maps.LatLng(e[n].latitude,e[n].longitude),map:o}))}));this.isActiveClients=a>0,this.countOfSelectedClients=a,this.identifyClientText()}},renderClients(e){console.log("Event value "+e.target.value),e.target.value&&this.showClientLocationOnTheMap(e.target.value),this.prof=e.target.value,e.target.value=""},async showClientLocationOnTheMap(e){const t=await f.Z.getRecipients();t&&this.otherUserLocations(t,e)},identifyClientText(){console.log("Klientide arv: "+this.countOfSelectedClients),this.countOfSelectedClients>1?this.client="asiakasta":this.client="asiakas"}}},C=o(89);const L=(0,C.Z)(w,[["render",h]]);var k=L}}]);
//# sourceMappingURL=853.3e63e234.js.map