"use strict";(self["webpackChunkprore_mongo"]=self["webpackChunkprore_mongo"]||[]).push([[133,51],{7572:function(e,o,i){i.d(o,{Z:function(){return f}});var n=i(3396),s=i(7139);const t={key:0},l={class:"waiting-info"},r={key:1},a={class:"info"},d={key:0},g={key:1};function m(e,o,i,m,u,c){const k=(0,n.up)("monthConverter"),p=(0,n.up)("MDBBtnClose");return"for-recipient-test"===i.status?((0,n.wg)(),(0,n.iD)("div",t,[(0,n._)("div",l,[(0,n._)("b",null,(0,s.zw)(i.msg.provider),1),(0,n.Uk)(" - "+(0,s.zw)(i.msg.header)+" ",1),(0,n.Wm)(k,{num:i.msg.onTime[0].month},null,8,["num"]),(0,n.Uk)(", "+(0,s.zw)(i.msg.onTime[0].day)+", "+(0,s.zw)(i.msg.onTime[0].year)+" kello "+(0,s.zw)(i.msg.onTime[0].hours)+" : "+(0,s.zw)(i.msg.onTime[0].minutes),1)])])):((0,n.wg)(),(0,n.iD)("div",r,[(0,n._)("div",a,[(0,n.Wm)(p,{class:"closeConfirmedBooking",onClick:c.handleCloseInfo},null,8,["onClick"]),"for-provider"===i.status?((0,n.wg)(),(0,n.iD)("div",d,[(0,n._)("h2",null,[(0,n._)("b",null,(0,s.zw)(i.msg.header),1)]),(0,n.Uk)(" "+(0,s.zw)(i.msg.address)+" ",1),(0,n.Wm)(k,{num:i.msg.onTime[0].month},null,8,["num"]),(0,n.Uk)(", "+(0,s.zw)(i.msg.onTime[0].day)+", "+(0,s.zw)(i.msg.onTime[0].year)+" kello "+(0,s.zw)(i.msg.onTime[0].hours)+" : "+(0,s.zw)(i.msg.onTime[0].minutes),1)])):"recipient"===i.status?((0,n.wg)(),(0,n.iD)("div",g,[(0,n._)("b",null,(0,s.zw)(i.msg.provider),1),(0,n.Uk)(" - "+(0,s.zw)(i.msg.header)+" ",1),(0,n.Wm)(k,{num:i.msg.onTime[0].month},null,8,["num"]),(0,n.Uk)(", "+(0,s.zw)(i.msg.onTime[0].day)+", "+(0,s.zw)(i.msg.onTime[0].year)+" kello "+(0,s.zw)(i.msg.onTime[0].hours)+" : "+(0,s.zw)(i.msg.onTime[0].minutes),1)])):(0,n.kq)("",!0)])]))}var u=i(4313),c=i(5253),k={name:"Info",props:{status:String,msg:String},components:{MDBBtnClose:u.Ok,monthConverter:c.Z},methods:{handleCloseInfo(){this.$emit("close:info")}}},p=i(89);const h=(0,p.Z)(k,[["render",m],["__scopeId","data-v-0a2a8d86"]]);var f=h},9127:function(e,o,i){i.r(o),i.d(o,{default:function(){return U}});var n=i(3396),s=i(7139);const t=e=>((0,n.dD)("data-v-469b2b70"),e=e(),(0,n.Cn)(),e),l={key:0},r={key:1},a={key:0,class:"spinner-border",role:"status"},d=t((()=>(0,n._)("span",{class:"visually-hidden"},"Loading...",-1))),g=[d],m={key:1},u={key:0,id:"info-block"},c={class:"file-marker"},k=t((()=>(0,n._)("div",{class:"box-title"}," Kinnitust ootaved broneeringud ",-1))),p={class:"box-contents"},h={key:0,id:"info-block"},f={class:"file-marker"},w=t((()=>(0,n._)("div",{class:"box-title"}," Kinnitatud broneeringud ",-1))),v={class:"box-contents"};function B(e,o,i,t,d,B){const b=(0,n.up)("recipientResult"),y=(0,n.up)("bookingInfo"),D=(0,n.up)("MDBCol"),T=(0,n.up)("MDBRow"),C=(0,n.up)("MDBBtn"),_=(0,n.up)("MDBTable"),M=(0,n.up)("MDBContainer");return(0,n.wg)(),(0,n.iD)("div",null,[(0,n.Wm)(M,{style:{"margin-top":"200px"}},{default:(0,n.w5)((()=>[d.isBooking?((0,n.wg)(),(0,n.iD)("div",l,[(0,n.Wm)(b,{booking:d.booking,bookingTime:d.recipientDateTime,providers:d.providerMatchByProfession,confirmedBookings:d.confirmedBookings,line:d.line,"onSet:order:to:send":B.handleOrderToSend,"onRemove:confirmed:provider":B.handleConfirmedProvider,"onCansel:result":B.handleCanselResult},null,8,["booking","bookingTime","providers","confirmedBookings","line","onSet:order:to:send","onRemove:confirmed:provider","onCansel:result"])])):((0,n.wg)(),(0,n.iD)("div",r,[d.bookings?((0,n.wg)(),(0,n.iD)("div",m,[(0,n.Wm)(T,null,{default:(0,n.w5)((()=>[(0,n.Wm)(D,{md:"6"},{default:(0,n.w5)((()=>[d.clientConfirmedBookings.length>0?((0,n.wg)(),(0,n.iD)("aside",u,[(0,n._)("section",c,[(0,n._)("div",null,[k,(0,n._)("div",p,[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(d.clientConfirmedBookings,(e=>((0,n.wg)(),(0,n.j4)(y,{key:e.id,status:"for-recipient-test",msg:e},null,8,["msg"])))),128))])])])])):(0,n.kq)("",!0)])),_:1}),(0,n.Wm)(D,{md:"6"},{default:(0,n.w5)((()=>[d.confirmedBookings.length>0?((0,n.wg)(),(0,n.iD)("aside",h,[(0,n._)("section",f,[(0,n._)("div",null,[w,(0,n._)("div",v,[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(d.confirmedBookings,(e=>((0,n.wg)(),(0,n.j4)(y,{key:e.id,status:"recipient",msg:e},null,8,["msg"])))),128))])])])])):(0,n.kq)("",!0)])),_:1})])),_:1}),(0,n._)("h3",null,"Sinulla on hetkellä - "+(0,s.zw)(d.bookings.length)+" - avointa tilausta:",1),(0,n.Wm)(_,{borderless:"",style:{"font-size":"16px","text-align":"left"}},{default:(0,n.w5)((()=>[(0,n._)("tbody",null,[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(d.bookings,(e=>((0,n.wg)(),(0,n.iD)("tr",{key:e.id},[(0,n._)("td",null,(0,s.zw)(e.date),1),(0,n._)("td",null,(0,s.zw)(e.header),1),(0,n._)("td",null,[(0,n.Wm)(C,{outline:"info",block:"",size:"lg",onClick:o=>B.handleRecipientResult(e.id)},{default:(0,n.w5)((()=>[(0,n.Uk)("Tiedot")])),_:2},1032,["onClick"])])])))),128))])])),_:1}),(0,n.Wm)(C,{outline:"info",block:"",size:"lg",onClick:B.newBooking},{default:(0,n.w5)((()=>[(0,n.Uk)("Teen uuden tilauksen")])),_:1},8,["onClick"]),(0,n.Wm)(C,{outline:"black",block:"",size:"lg",onClick:B.openMap},{default:(0,n.w5)((()=>[(0,n.Uk)("Asiantuntijoita ympärilläsi")])),_:1},8,["onClick"])])):((0,n.wg)(),(0,n.iD)("div",a,g))]))])),_:1})])}i(7658);var b=i(4313),y=i(4870),D=i(7629),T=i(9398),C=i(5800),_=i(7572);const M=()=>{var e=new google.maps.LatLng(60.233093,24.7531362),o=new google.maps.LatLng(60.2767265,24.8575089),i=new google.maps.DistanceMatrixService;i.getDistanceMatrix({origins:[e],destinations:[o],travelMode:"DRIVING",unitSystem:google.maps.UnitSystem.METRIC,durationInTraffic:!0,avoidHighways:!1,avoidTolls:!1},z)},z=(e,o)=>{o!==google.maps.DistanceMatrixStatus.OK||"OK"!==o?(console.log("Error:",o),alert(o)):alert(e.rows[0].elements[0].distance.text)},x=()=>{console.log("Is it working??")};var R={distance:M,test:x},I=i(5253),S={name:"recipient-panel",props:{recipientBookings:Array},data(){return{bookings:[],provider:{},booking:null,confirmedBookings:[],clientConfirmedBookings:[],isBooking:!1,providerMatchByProfession:[],providerMatchingRequirements:null,line:"",recipientDateTime:null}},setup(){const e=(0,y.iH)(!1);return{isAvailable:e}},components:{bookingInfo:_.Z,recipientResult:D["default"],MDBTable:b.re,MDBBtn:b.$v,MDBContainer:b.L5,MDBRow:b.uZ,MDBCol:b.TK},async mounted(){const e=window.localStorage.getItem("loggedAppUser");if(e){const o=JSON.parse(e);this.userId=o.id,this.provider=await T.Z.getProvider(o.id),this.handleRecipientBookings()}else this.$router.push("/")},methods:{async handleRecipientBookings(){let e=await C.Z.getOwnBookings(this.userId);this.confirmedBookings=e.filter((e=>"confirmed"===e.status)),this.clientConfirmedBookings=e.filter((e=>"notSeen"===e.status||"seen"===e.status)),this.bookings=e.filter((e=>"waiting"===e.status))},async handleRecipientResult(e){console.log("Provider id is: "+e),this.booking=await C.Z.getBookingById(e),console.log("Profession: "+this.booking.map((e=>e.professional)));let o=[];o=this.booking[0].professional,this.booking.map((e=>{this.recipientDateTime=new Date(2023,e.onTime[0].month,e.onTime[0].day,e.onTime[0].hours,e.onTime[0].minutes),console.log("Recipient datetime: "+e.onTime[0].day)})),console.log("xxx "+this.recipientDateTime.getTime()),this.line=o[0],this.providerMatchByProfession=await T.Z.getProvidersMatchingByProfession({result:o}),console.log("xxxxxx "+this.providerMatchByProfession.length),this.isBooking=!0},handleOrderToSend(e){console.log("Order is sended"),this.clientConfirmedBookings=this.clientConfirmedBookings.concat(this.booking),this.bookings=this.bookings.filter((o=>o.id!==e))},newBooking(){this.$router.push("/rf")},handleConfirmedProvider(e){this.providerMatchByProfession=this.providerMatchByProfession.filter((o=>o.id!==e))},openMap(){this.$router.push("/recipient-public")},getDistance(){R.distance()},compareTime(){console.log("Month is: "+I.Z.month(4))},handleCanselResult(e){console.log("Canseled: "+e),this.isBooking=e}}},P=i(89);const W=(0,P.Z)(S,[["render",B],["__scopeId","data-v-469b2b70"]]);var U=W}}]);
//# sourceMappingURL=133.1441be90.js.map