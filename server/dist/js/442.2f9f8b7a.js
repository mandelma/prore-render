"use strict";(self["webpackChunkprore_mongo"]=self["webpackChunkprore_mongo"]||[]).push([[442],{5118:function(e,t,i){var s=i(3396);const a=({message:e})=>null===e?null:(0,s.Wm)("div",{className:"error"},[e,(0,s.Wm)("img",{className:"errorImg",src:i(5551)},null)]);t.Z=a},3442:function(e,t,i){i.r(t),i.d(t,{default:function(){return D}});var s=i(3396),a=i(7139);const n=e=>((0,s.dD)("data-v-5fc42240"),e=e(),(0,s.Cn)(),e),o={style:{display:"flex","justify-content":"right",padding:"13px"}},l={style:{"font-size":"16px"}},r=n((()=>(0,s._)("h3",null,"Voit antaa palautetta painamalla valitsemasi kuvaketta!",-1))),u={style:{"min-width":"33px"}},d={style:{"min-width":"33px"}},g=["src"],c={key:0},m={key:0},p={key:1},h={style:{color:"deepskyblue"}};function v(e,t,n,v,k,w){const f=(0,s.up)("MDBBtnClose"),R=(0,s.up)("MDBCol"),y=(0,s.up)("month-converter"),b=(0,s.up)("MDBRow"),M=(0,s.up)("warning-message"),W=(0,s.up)("error-message"),_=(0,s.up)("MDBIcon"),B=(0,s.up)("MDBBadge"),C=(0,s.up)("MDBTextarea"),D=(0,s.up)("MDBBtn"),x=(0,s.up)("MDBContainer");return(0,s.wg)(),(0,s.j4)(x,{style:{"padding-top":"70px"}},{default:(0,s.w5)((()=>[(0,s._)("div",o,[(0,s.Wm)(f,{white:"",onClick:w.backFromFeedbackClient},null,8,["onClick"])]),(0,s.Wm)(b,{style:{"padding-bottom":"20px"}},{default:(0,s.w5)((()=>[(0,s.Wm)(R),(0,s.Wm)(R,null,{default:(0,s.w5)((()=>[(0,s._)("p",l,[(0,s._)("b",null,(0,a.zw)(n.customer.ordered[0].yritys),1),(0,s.Uk)(" odottaa palautetta tarjoamastaan palvelusta "),(0,s._)("b",null,[(0,s.Uk)(' "'+(0,a.zw)(n.customer.header)+'" ',1),(0,s.Wm)(y,{num:n.customer.onTime[0].month},null,8,["num"]),(0,s.Uk)(" - "+(0,a.zw)(n.customer.onTime[0].day)+" - "+(0,a.zw)(n.customer.onTime[0].year),1)])])])),_:1})])),_:1}),(0,s.Wm)(M,{message:k.rateWarning},null,8,["message"]),(0,s.Wm)(W,{message:k.ratingError},null,8,["message"]),r,(0,s.Wm)(b,{style:{position:"relative"}},{default:(0,s.w5)((()=>[(0,s.Wm)(R,{style:{padding:"20px"}},{default:(0,s.w5)((()=>[(0,s.Wm)(b,{class:"rating"},{default:(0,s.w5)((()=>[(0,s.Wm)(R,null,{default:(0,s.w5)((()=>[(0,s.Wm)(_,{style:{padding:"10px",cursor:"pointer"},i:"",class:"fas fa-smile",size:"3x",onClick:w.ratePlus},null,8,["onClick"]),(0,s.Wm)(B,{color:"success",class:"translate-middle p-1",pill:"",notification:""},{default:(0,s.w5)((()=>[(0,s._)("h2",u,(0,a.zw)(k.positiveRating),1)])),_:1})])),_:1}),(0,s.Wm)(R,null,{default:(0,s.w5)((()=>[(0,s.Wm)(_,{style:{padding:"10px",cursor:"pointer"},class:"far fa-frown",size:"3x",onClick:w.rateMinus},null,8,["onClick"]),(0,s.Wm)(B,{color:"danger",class:"translate-middle p-1",pill:"",notification:""},{default:(0,s.w5)((()=>[(0,s._)("h3",d,(0,a.zw)(k.negativeRating),1)])),_:1})])),_:1}),(0,s.Wm)(R,null,{default:(0,s.w5)((()=>[(0,s._)("img",{style:{width:"300px"},src:i(3266),alt:"rating-time"},null,8,g)])),_:1})])),_:1}),k.isRatingGiven?((0,s.wg)(),(0,s.iD)("div",c,[k.isReview?((0,s.wg)(),(0,s.iD)("h2",p,"Arvostelee!")):((0,s.wg)(),(0,s.iD)("h2",m,"Kiitos palautteesta!")),k.isReview?((0,s.wg)(),(0,s.j4)(C,{key:2,white:"",style:{"margin-bottom":"20px"},label:"Message",rows:"4",modelValue:k.feedback,"onUpdate:modelValue":t[0]||(t[0]=e=>k.feedback=e)},null,8,["modelValue"])):(0,s.kq)("",!0),(0,s.Wm)(D,{color:"grey",size:"lg",onClick:t[1]||(t[1]=e=>k.isReview=!k.isReview)},{default:(0,s.w5)((()=>[(0,s._)("p",h,(0,a.zw)(k.isReview?"Poistu arvostelusta":"Kirjoittaa halutessasi arvostelu"),1)])),_:1})])):(0,s.kq)("",!0)])),_:1})])),_:1}),k.isRatingGiven?((0,s.wg)(),(0,s.j4)(D,{key:0,outline:"info",size:"lg",block:"",onClick:t[2]||(t[2]=e=>w.reload())},{default:(0,s.w5)((()=>[(0,s.Uk)("Muokkaa antamasi palautesi!")])),_:1})):(0,s.kq)("",!0),k.isRatingGiven?((0,s.wg)(),(0,s.j4)(D,{key:1,style:{"margin-bottom":"20px"},block:"",color:"success",size:"lg",onClick:w.confirmFeedback},{default:(0,s.w5)((()=>[(0,s.Uk)("Lähettää palaute")])),_:1},8,["onClick"])):(0,s.kq)("",!0)])),_:1})}i(7658);var k=i(4313),w=i(5253);const f=({message:e})=>null===e?null:(0,s.Wm)("div",{className:"warning"},[e]);var R=f,y=i(5118),b=i(5800),M=i(9398),W=i(4045),_={name:"Feedback",props:{customer:Object},components:{monthConverter:w.Z,warningMessage:R,errorMessage:y.Z,MDBContainer:k.L5,MDBBtn:k.$v,MDBRow:k.uZ,MDBCol:k.TK,MDBIcon:k.vm,MDBBadge:k.m_,MDBTextarea:k.uj,MDBTable:k.re,MDBBtnClose:k.Ok},data(){return{user:null,fbc:{},isRatingGiven:!1,isReview:!1,ratedTimes:0,isRatedPos:!1,isRatedMinus:!1,positiveRating:0,negativeRating:0,feedback:"",rateWarning:null,ratingError:null}},methods:{reload(){location.reload()},async getClient(e){const t=await b.Z.getOwnBookings(e);console.log("booking client ");const i=t.find((e=>!0===e.isFeedbackClient));this.positiveRating=i.ordered[0].rating.positive,this.negativeRating=i.ordered[0].rating.negative,this.fbc=i},ratePlus(){this.isRated=!0,console.log("Pos rating before "+this.positiveRating),this.isRatedMinus?(console.log("Not, only one time is allowed!"),this.rateWarning="Arvostella saa vain kerran!",setTimeout((()=>{this.rateWarning=null}),3e3)):(this.ratedTimes+=1,1===this.ratedTimes?(this.positiveRating=this.positiveRating+1,console.log("Pos rating after "+this.positiveRating),this.isRatingGiven=!0):(console.log("Not, only one time is allowed!"),this.rateWarning="Arvostella saa vain kerran!",setTimeout((()=>{this.rateWarning=null}),3e3)),this.isRatedPlus=!0,this.isRatedMinus=!1)},rateMinus(){this.isRated=!0,this.isRatedPlus?(this.rateWarning="Arvostella saa vain kerran, negatiivisen tai positiivisen!",setTimeout((()=>{this.rateWarning=null}),3e3)):(this.ratedTimes+=1,1===this.ratedTimes?(this.negativeRating=this.negativeRating+1,this.isRatingGiven=!0):(this.rateWarning="Arvostella saa vain kerran, negatiivisen tai positiivisen!",setTimeout((()=>{this.rateWarning=null}),3e3)),this.isRatedPlus=!1,this.isRatedMinus=!0)},async confirmFeedback(){const e=this.customer.ordered[0].id,t=new Date,i=(0,W.ZP)(t,"dd-mm-yyyy,  HH:MM"),s={pos:i+": ( "+this.customer.user.username+" ) "+this.feedback},a={neg:i+": ( "+this.customer.user.username+" ) "+this.feedback};this.feedback.length>0&&(this.isRatedPlus&&(await M.Z.addPositiveFeedback(e,s),this.feedback=""),this.isRatedMinus&&(await M.Z.addNegativeFeedback(e,a),this.feedback="")),this.isRatedPlus&&(await M.Z.setPositiveRating(e),this.$emit("isRated",this.customer.id,"positiivista",this.customer.ordered[0].yritys),this.$router.go(-1)),this.isRatedMinus&&(await M.Z.setNegativeRating(e),this.$emit("isRated",this.customer.id,"negatiivista",this.customer.ordered[0].yritys),this.$router.go(-1))},backFromFeedbackClient(){this.$router.go(-1)}},mounted(){const e=window.localStorage.getItem("loggedAppUser");if(e){JSON.parse(e);this.positiveRating=this.customer.ordered[0].rating.positive,this.negativeRating=this.customer.ordered[0].rating.negative}else this.$router.push("/")}},B=i(89);const C=(0,B.Z)(_,[["render",v],["__scopeId","data-v-5fc42240"]]);var D=C},5551:function(e,t,i){e.exports=i.p+"img/error.9510853e.png"},3266:function(e,t,i){e.exports=i.p+"img/is_feedback.77929104.png"}}]);
//# sourceMappingURL=442.2f9f8b7a.js.map