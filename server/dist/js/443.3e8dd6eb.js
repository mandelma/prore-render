"use strict";(self["webpackChunkprore_mongo"]=self["webpackChunkprore_mongo"]||[]).push([[443],{8405:function(e,i){const t=(e,i)=>{const t=new Date(e.y,e.m,e.d,e.hour,e.min),o=new Date(i.y,i.m,i.d,i.hour,i.min);return o>=t},o=(e,i,t)=>{const o=new Date(i.y,i.m,i.d,i.hour,i.min),s=new Date(t.y,t.m,t.d,t.hour,t.min);return e>=o&&e<s};i.A={compare:t,providerMatchingForClient:o}},4482:function(e,i,t){var o=t(6768);const s=({message:e})=>null===e?null:(0,o.bF)("div",{className:"error"},[e,(0,o.bF)("img",{className:"errorImg",alt:"error",src:t(1644)},null)]);i.A=s},443:function(e,i,t){t.r(i),t.d(i,{default:function(){return ee}});var o=t(6768),s=t(4232),n=t(5130);const l={style:{display:"flex","justify-content":"right",padding:"20px"}},a={class:"client-result-header"},d={key:0,class:"expired_date"},r={key:0},g={key:1},c={style:{display:"flex","justify-content":"right",cursor:"pointer"}},u={key:0},h={key:0},m={key:1},k={key:0},p={key:1},f=["src","alt"],b={key:1,class:"edit-panel"},v=["onChange"],_={for:"file-upload",class:"custom-file-upload"},y={key:0},D={key:1},I=["src"],C={key:1,class:"add-panel"},w={for:"file-upload-x",class:"custom-file-upload"},A={key:0},P={key:1},E=["src"],F={key:0},M={class:"ui large form"},S={class:"field"},x={style:{"font-size":"14px"}},L={style:{"font-size":"14px"}},B={style:{"font-size":"14px"}},T={key:1};function X(e,i,t,X,z,R){const U=(0,o.g2)("recipientFinal"),O=(0,o.g2)("MDBContainer"),W=(0,o.g2)("MDBBtnClose"),V=(0,o.g2)("prompt-panel"),$=(0,o.g2)("successMessage"),j=(0,o.g2)("MDBTextarea"),N=(0,o.g2)("MDBCol"),Q=(0,o.g2)("MDBRow"),H=(0,o.g2)("MDBBtn"),K=(0,o.g2)("VueDatePicker"),Y=(0,o.g2)("MDBTable"),G=(0,o.g2)("error-message"),J=(0,o.g2)("MDBBadge");return z.isProviderSelected?((0,o.uX)(),(0,o.Wv)(O,{key:0},{default:(0,o.k6)((()=>[(0,o.bF)(U,{"onCansel:final":R.handleCanselFinal,"onProvider:ordered":R.orderSuccess,proRefSlides:t.proRefSlides,test:t.test,provider:z.selectedProvider,offer:z.offer,proSlides:e.slides,room:z.room,available:z.availability,booking:t.booking,chatusers:t.chatusers,initialize_chat:e.handleInitializeChat,selecteduser:t.selecteduser,messages:t.messages,onMessage:R.onMessage,onSelect:R.selectUser,onNoSelect:R.noSelectUser,onJoin_chat_panel:R.handleJoinChatPanel},null,8,["onCansel:final","onProvider:ordered","proRefSlides","test","provider","offer","proSlides","room","available","booking","chatusers","initialize_chat","selecteduser","messages","onMessage","onSelect","onNoSelect","onJoin_chat_panel"])])),_:1})):((0,o.uX)(),(0,o.Wv)(O,{key:1},{default:(0,o.k6)((()=>[(0,o.Lk)("div",l,[(0,o.bF)(W,{white:"",style:{cursor:"pointer"},onClick:R.canselResult},null,8,["onClick"])]),(0,o.bF)(V,{promptPanelContent:z.promptPanelContent,"onPrompt:no":R.handlePromptNo,"onPrompt:yes":R.handlePromptYes},null,8,["promptPanelContent","onPrompt:no","onPrompt:yes"]),(0,o.Lk)("h2",a,(0,s.v_)(z.t("recipient_result_need_a_pro"))+" - "+(0,s.v_)(t.line),1),t.booking.created_ms-(new Date).getTime()<=0&&t.booking.offers.length<1?((0,o.uX)(),(0,o.CE)("h5",d,(0,s.v_)(z.t("recipient_result_order_is_expired")),1)):(0,o.Q3)("",!0),(0,o.bF)($,{message:z.orderMessage},null,8,["message"]),(0,o.bF)(Q,{style:{"margin-top":"50px"}},{default:(0,o.k6)((()=>[(0,o.bF)(N,{class:"client-result"},{default:(0,o.k6)((()=>[(0,o.bF)(Y,{borderless:"",style:{"font-size":"17px",color:"#dddddd","text-align":"left"}},{default:(0,o.k6)((()=>[(0,o.Lk)("tbody",null,[(0,o.Lk)("tr",null,[z.isEditDescription?((0,o.uX)(),(0,o.CE)("td",g,[(0,o.bF)(Q,null,{default:(0,o.k6)((()=>[(0,o.bF)(N,null,{default:(0,o.k6)((()=>[(0,o.bF)(j,{label:z.t("recipient_result_edit_description"),white:"",rows:"4",modelValue:z.description,"onUpdate:modelValue":i[0]||(i[0]=e=>z.description=e),style:{"font-size":"14px",padding:"20px"}},null,8,["label","modelValue"])])),_:1}),(0,o.bF)(N,{col:"1"},{default:(0,o.k6)((()=>[(0,o.Lk)("div",c,[(0,o.bF)(W,{white:"",onClick:i[1]||(i[1]=e=>z.isEditDescription=!1)})])])),_:1})])),_:1})])):((0,o.uX)(),(0,o.CE)("td",r,[(0,o.Lk)("p",null,(0,s.v_)(t.booking.description),1)]))]),t.booking.offers.length<1?((0,o.uX)(),(0,o.CE)("tr",u,[z.isEditDescription?((0,o.uX)(),(0,o.CE)("td",m,[(0,o.bF)(H,{outline:"info",block:"",size:"lg",onClick:R.saveEditedDescription},{default:(0,o.k6)((()=>i[8]||(i[8]=[(0,o.eW)("Tallenna tehtävän kuvaus")]))),_:1},8,["onClick"])])):((0,o.uX)(),(0,o.CE)("td",h,[(0,o.bF)(H,{outline:"info",block:"",size:"lg",onClick:R.pressedEditDescription},{default:(0,o.k6)((()=>i[7]||(i[7]=[(0,o.eW)("Muokkaa tehtävän kuvausta")]))),_:1},8,["onClick"])]))])):(0,o.Q3)("",!0),(0,o.Lk)("tr",null,[z.isEditDate?((0,o.uX)(),(0,o.CE)("td",p,[(0,o.bF)(Q,null,{default:(0,o.k6)((()=>[(0,o.bF)(N,{col:"8"},{default:(0,o.k6)((()=>[(0,o.Lk)("h4",{class:(0,s.C4)({expired_date:t.booking.created_ms-(new Date).getTime()<=0})},[(0,o.eW)((0,s.v_)(z.bookingDateToDisplay),1),i[9]||(i[9]=(0,o.Lk)("br",null,null,-1)),(0,o.eW)(" klo   "+(0,s.v_)(new Date(t.booking.created).getHours()<10?"0"+new Date(t.booking.created).getHours():new Date(t.booking.created).getHours())+" : "+(0,s.v_)(new Date(t.booking.created).getMinutes()<10?"0"+new Date(t.booking.created).getMinutes():new Date(t.booking.created).getMinutes()),1)],2),(0,o.bF)(K,{style:{"margin-bottom":"20px"},dark:"",modelValue:z.bookingDate,"onUpdate:modelValue":i[2]||(i[2]=e=>z.bookingDate=e),"min-date":new Date,placeholder:z.t("recipient_result_select_date"),onInternalModelChange:R.handleInternalDate,state:!e.isNoDate&&null},null,8,["modelValue","min-date","placeholder","onInternalModelChange","state"])])),_:1}),(0,o.bF)(N,{col:"4"},{default:(0,o.k6)((()=>[(0,o.bF)(W,{white:"",onClick:i[3]||(i[3]=e=>z.isEditDate=!1),style:{float:"right",cursor:"pointer"}})])),_:1})])),_:1})])):((0,o.uX)(),(0,o.CE)("td",k,[(0,o.Lk)("p",{class:(0,s.C4)({expired_date:t.booking.created_ms-(new Date).getTime()<=0&&t.booking.offers.length<1})},(0,s.v_)(z.bookingDateToDisplay)+"   klo   "+(0,s.v_)(new Date(t.booking.created).getHours()<10?"0"+new Date(t.booking.created).getHours():new Date(t.booking.created).getHours())+" : "+(0,s.v_)(new Date(t.booking.created).getMinutes()<10?"0"+new Date(t.booking.created).getMinutes():new Date(t.booking.created).getMinutes()),3),t.booking.offers.length<1?((0,o.uX)(),(0,o.Wv)(H,{key:0,block:"",size:"lg",outline:"info",onClick:R.editDate},{default:(0,o.k6)((()=>[(0,o.Lk)("span",{class:(0,s.C4)({expired_warning:t.booking.created_ms-(new Date).getTime()<=0})},(0,s.v_)(z.t("recipient_result_edit_date")),3)])),_:1},8,["onClick"])):(0,o.Q3)("",!0)]))])])])),_:1}),((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(t.images,((n,l)=>((0,o.uX)(),(0,o.CE)("div",{key:l},[(0,o.Lk)("img",{class:"loading",style:{width:"100%"},src:n.blob?e.im.blob:n.image,alt:n.name},null,8,f),z.isEditPanel?(0,o.Q3)("",!0):((0,o.uX)(),(0,o.Wv)(H,{key:0,block:"",outline:"success",onClick:e=>R.pressEditPanel(l)},{default:(0,o.k6)((()=>[(0,o.eW)((0,s.v_)(z.t("recipient_result_edit_picture")),1)])),_:2},1032,["onClick"])),z.isEditPanel&&z.imageIndex===l?((0,o.uX)(),(0,o.CE)("div",b,[(0,o.bF)(G,{message:z.wrong_SizeType_Message},null,8,["message"]),t.booking.offers.length<1?((0,o.uX)(),(0,o.Wv)(Q,{key:0},{default:(0,o.k6)((()=>[(0,o.bF)(N,null,{default:(0,o.k6)((()=>[z.value?(0,o.Q3)("",!0):((0,o.uX)(),(0,o.Wv)(W,{key:0,white:"",class:"close-btn",style:{float:"right"},onClick:R.closeEditPanel},null,8,["onClick"])),(0,o.Lk)("input",{id:"file-upload",type:"file",onChange:e=>R.handleFileChange(e,l)},null,40,v),(0,o.Lk)("label",_,[z.value?((0,o.uX)(),(0,o.CE)("span",y,(0,s.v_)(z.t("recipient_result_edit_order_picture"))+": "+(0,s.v_)(z.value.name),1)):((0,o.uX)(),(0,o.CE)("span",D,(0,s.v_)(z.t("recipient_result_select_new_image")),1))]),z.isEditImage?((0,o.uX)(),(0,o.Wv)(H,{key:1,block:"",color:"success",onClick:e=>R.uploadEditedImage(l)},{default:(0,o.k6)((()=>i[10]||(i[10]=[(0,o.eW)("Upload edited image")]))),_:2},1032,["onClick"])):(0,o.Q3)("",!0),(0,o.bF)(H,{class:"btn",block:"",size:"lg",color:"danger",onClick:e=>R.removeImg(l)},{default:(0,o.k6)((()=>i[11]||(i[11]=[(0,o.eW)("Poista kuva")]))),_:2},1032,["onClick"])])),_:2},1024),z.value?((0,o.uX)(),(0,o.Wv)(N,{key:0},{default:(0,o.k6)((()=>[(0,o.bF)(W,{white:"",class:"close-btn",style:{float:"right"},onClick:R.closeEditPanel},null,8,["onClick"]),(0,o.Lk)("img",{style:{width:"100px","padding-top":"20px"},src:this.showImage,alt:"addEdit"},null,8,I)])),_:1})):(0,o.Q3)("",!0)])),_:2},1024)):(0,o.Q3)("",!0)])):(0,o.Q3)("",!0)])))),128)),!z.isPressedAddlmage&t.booking.offers.length<1?((0,o.uX)(),(0,o.Wv)(H,{key:0,block:"",color:"primary",onClick:R.pressedAddImage},{default:(0,o.k6)((()=>i[12]||(i[12]=[(0,o.eW)("Lisää kuva tehtävästä")]))),_:1},8,["onClick"])):(0,o.Q3)("",!0),z.isPressedAddlmage&&z.isAddImagePanel?((0,o.uX)(),(0,o.CE)("div",C,[(0,o.bF)(G,{message:z.wrong_SizeType_Message},null,8,["message"]),(0,o.bF)(Q,null,{default:(0,o.k6)((()=>[(0,o.bF)(N,null,{default:(0,o.k6)((()=>[z.value?(0,o.Q3)("",!0):((0,o.uX)(),(0,o.Wv)(W,{key:0,white:"",class:"close-btn",onClick:R.closeAddPanel},null,8,["onClick"])),(0,o.Lk)("input",{id:"file-upload-x",type:"file",onChange:i[4]||(i[4]=i=>R.handleFileChange(i,e.i))},null,32),(0,o.Lk)("label",w,[z.value?((0,o.uX)(),(0,o.CE)("span",A," Muokka tehtävän kuvausta: "+(0,s.v_)(z.value.name)+" + ",1)):((0,o.uX)(),(0,o.CE)("span",P,"Valitse lisää kuva tehtävästä"))]),z.isAddImage?((0,o.uX)(),(0,o.Wv)(H,{key:1,block:"",outline:"primary",onClick:R.addAdditionalImage},{default:(0,o.k6)((()=>i[13]||(i[13]=[(0,o.eW)("Tallenna kuva")]))),_:1},8,["onClick"])):(0,o.Q3)("",!0)])),_:1}),z.value?((0,o.uX)(),(0,o.Wv)(N,{key:0},{default:(0,o.k6)((()=>[(0,o.bF)(W,{class:"close-btn",white:"",onClick:R.closeAddPanel},null,8,["onClick"]),(0,o.Lk)("img",{style:{width:"100px"},src:this.showImage,alt:"addShow"},null,8,E)])),_:1})):(0,o.Q3)("",!0)])),_:1})])):(0,o.Q3)("",!0)])),_:1}),(0,o.bF)(N,{lg:"6"},{default:(0,o.k6)((()=>[t.booking_offers.length>0?((0,o.uX)(),(0,o.CE)("div",F,[(0,o.Lk)("div",M,[(0,o.Lk)("div",S,[i[15]||(i[15]=(0,o.Lk)("h3",{style:{"margin-bottom":"20px"}},"Tarjoukset",-1)),(0,o.bo)((0,o.Lk)("select",{style:{padding:"20px","background-color":"#3c3535",color:"lightgrey","font-size":"18px"},id:"listOfProviders","onUpdate:modelValue":i[5]||(i[5]=e=>z.filterResult=e),onClick:i[6]||(i[6]=(...e)=>R.addFilter&&R.addFilter(...e))},i[14]||(i[14]=[(0,o.Lk)("option",{value:""},"Suodata...",-1),(0,o.Lk)("option",{value:"distance"},"Etäisyyden mukaan - lähin ensin",-1),(0,o.Lk)("option",{value:"rating"},"Positiivisen palauteen mukaan - enemmän ensin",-1),(0,o.Lk)("option",{value:"price"},"Hinnan mukaan - halvin ensin",-1)]),512),[[n.u1,z.filterResult]])])]),i[20]||(i[20]=(0,o.Lk)("br",null,null,-1)),(0,o.bF)(Y,{style:{"font-size":"18px","text-align":"center",position:"relative"}},{default:(0,o.k6)((()=>[(0,o.Lk)("tbody",null,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(t.booking_offers,(e=>((0,o.uX)(),(0,o.CE)("tr",{key:e.id},[(0,o.Lk)("td",null,[(0,o.bF)(H,{class:"provider-selection",outline:"info",size:"lg",onClick:i=>R.getProviderInfo(e.provider,e,"orange")},{default:(0,o.k6)((()=>[(0,o.eW)((0,s.v_)(e.provider.yritys)+" ",1),i[16]||(i[16]=(0,o.Lk)("br",null,null,-1)),(0,o.Lk)("span",x,"Etäisyys: "+(0,s.v_)(e.distance)+" km",1),i[17]||(i[17]=(0,o.Lk)("br",null,null,-1))])),_:2},1032,["onClick"]),e.isNewOffer?((0,o.uX)(),(0,o.Wv)(J,{key:0,color:"danger",class:"translate-middle p-3",pill:"",notification:""},{default:(0,o.k6)((()=>[(0,o.Lk)("span",L,[i[18]||(i[18]=(0,o.eW)(" uusi! ")),i[19]||(i[19]=(0,o.Lk)("br",null,null,-1)),(0,o.eW)((0,s.v_)(e.price)+" eur ",1)])])),_:2},1024)):((0,o.uX)(),(0,o.Wv)(J,{key:1,color:"info",class:"translate-middle p-3",pill:"",notification:""},{default:(0,o.k6)((()=>[(0,o.Lk)("span",B,(0,s.v_)(e.price)+" eur ",1)])),_:2},1024))])])))),128))])])),_:1})])):((0,o.uX)(),(0,o.CE)("div",T,i[21]||(i[21]=[(0,o.Lk)("h2",{style:{width:"100%","margin-top":"17px"}},"Odotetaan tarjouksia...",-1)])))])),_:1}),(0,o.bF)(H,{block:"",color:"danger",size:"sm",onClick:R.removeOfferedBookings},{default:(0,o.k6)((()=>i[22]||(i[22]=[(0,o.eW)("Poista tilaus")]))),_:1},8,["onClick"])])),_:1})])),_:1}))}t(4114),t(6573),t(8100),t(7936),t(8111),t(7588),t(3579),t(7467),t(4732),t(9577),t(4603),t(7566),t(8721);var z=t(5846),R=t(8405),U=t(7185),O=t(7337),W=t(4482),V=t(5607),$=t(1769),j=t(2456),N=t(4474),Q=t(8269),H=t(8068),K=t(407),Y=t(5384),G=t(1690),J=(t(2815),{name:"recipient-panel-result",props:{test:Boolean,chatusers:Array,proRefSlides:Array,selecteduser:null,messages:Array,loggedInUser:Object,booking:null,booking_offers:[],images:Array,bookingTime:null,providers:Array,confirmedBookings:Array,line:String},data(){const{t:e}=(0,Y.s9)();return{t:e,IMAGE_SIZE:1e6,offer:null,chatUser:null,count:0,promptPanelContent:null,wrong_SizeType_Message:null,datetime:R.A,distance:V.A,selectedProvider:null,proSlides:[],isProviderSelected:!1,availability:"",orderMessage:null,isOrdered:!1,isEditDescription:!1,description:this.booking.description,isEditDate:!1,bookingDate:new Date(this.booking.created),bookingDateToDisplay:this.booking.date,isAddFirstImage:!1,isPressedAddlmage:!1,isAddImage:!1,isAddImagePanel:!1,isEditImage:!1,isUploadImage:!1,isUploaded:!1,isImageCreated:!1,isAddNewImage:!1,isEditPanel:!1,value:null,imageIndex:0,file:null,files:null,isImageSelected:!1,isAdditionalImageSelected:!1,showImage:null,tempImages:[],imagesx:[],imagesxxx:[],room:"",roomUserCount:0,filterResult:""}},components:{successMessage:O.A,errorMessage:W.A,VueDatePicker:H.A,promptPanel:Q["default"],dist:V.A,recipientFinal:U["default"],MDBBtn:z.al,MDBBtnClose:z.uR,MDBContainer:z.Dj,MDBTable:z.EU,MDBRow:z.gU,MDBCol:z.m6,MDBTextarea:z.QP,MDBIcon:z.$u,MDBBadge:z.nf},methods:{handlePromptNo(){console.log("Said NO!"),this.promptPanelContent=null},handlePromptYes(){console.log("Said YES!"),this.promptPanelContent=null,this.$emit("removeOfferedBooking",this.booking,this.booking.offers)},editDate(){this.isEditDate=!0},async handleInternalDate(){if(this.bookingDate){console.log("new date: "+new Date(this.bookingDate).getTime()),this.bookingDateToDisplay=this.bookingDate.getMonth()+1+"/"+this.bookingDate.getDate()+"/"+this.bookingDate.getFullYear(),console.log("eeeeee "+(this.bookingDate.getMonth()+1)+"/"+this.bookingDate.getDate()+"/"+this.bookingDate.getFullYear());const e=new Date(this.bookingDate).getTime();new Date(this.bookingDate);await K.A.newDate(this.booking.id,{year:this.bookingDate.getFullYear(),month:this.bookingDate.getMonth(),day:this.bookingDate.getDate(),hours:this.bookingDate.getHours(),minutes:this.bookingDate.getMinutes(),date_ms:e});const i={year:this.bookingDate.getFullYear(),month:this.bookingDate.getMonth(),day:this.bookingDate.getDate(),hours:this.bookingDate.getHours(),minutes:this.bookingDate.getMinutes()};this.$emit("updateBookingDate",this.booking,i)}console.log("Date is handled")},handleFileChange(e,i){console.log("i in file change "+i),this.imageIndex=i;try{const i=e.target.files[0];if(console.log("event target client ",e.target.files[0]),i){const t=URL.createObjectURL(i);this.tempImages.push(t),this.showImage=URL.createObjectURL(i),this.file=e.target.files[0],this.files=e.target.files[0],this.isAddImage=!0,this.isEditImage=!0}}catch(t){console.log("Error:",t)}this.value=e.target.files[0]},pressedAddImage(){this.isAddImage=!1,this.isEditImage=!1,this.isEditPanel=!1,this.isPressedAddlmage=!0,this.isAddImagePanel=!0},async addImage(){},pressEditPanel(e){this.isEditImage=!1,this.value=null,this.imageIndex=e,this.isPressedAddlmage=!1,this.isEditPanel=!0,this.isAddImagePanel=!1},closeEditPanel(){this.isAddImagePanel=!1,this.isEditPanel=!1,this.isEditImage=!1,this.value=null},closeAddPanel(){this.isAddImagePanel=!1,this.isPressedAddlmage=!1,this.value=null},async uploadEditedImage(e,i){console.log("Edited image index is: "+e),this.isEditPanel=!1,this.isEditImage=!1;const t=new FormData;t.append("file",this.file,this.file.name),console.log("Image id "+this.images[e]._id);const o=this.file.type;if("image/jpeg"===o||"image/jpg"===o||"image/png"===o||"image/gif"===o)if(this.file.size<=this.IMAGE_SIZE){const i=await N.A.updateImage(this.images[e]._id,t);if(i){this.$emit("editImage",e,i._id,this.showImage),console.log("ORDRED in EDIT pikkus "+this.booking.ordered.length);let t=[];this.booking.ordered.forEach((e=>{console.log("CVCVCV "+e.user.username),t=t.concat(e.user.id)}));const o=new FileReader;this.file&&(o.onload=e=>{const o=new Uint8Array(e.target.result);console.log("FILES.... "+this.files);const s=i._id;G.A.emit("display edited booking image",s,o,this.booking.id,t)},o.readAsArrayBuffer(this.files)),console.log("New image id is "+i._id),this.imgId=i._id,this.file=null,this.isEditPanel=!1,this.closeAddPanel()}}else this.isEditPanel=!0,this.closeAddPanel(),this.wrong_SizeType_Message="Väärä formaati. Kuva pitäisi olla jpeg, jpg, png tai gif formaatissa!",setTimeout((()=>{this.wrong_SizeType_Message=null}),3e3);else this.isEditPanel=!0,this.closeAddPanel(),this.wrong_SizeType_Message="Kuvan maximi koko on oltava 3 MB!",setTimeout((()=>{this.wrong_SizeType_Message=null}),3e3)},async addAdditionalImage(){this.value=null,this.isAddImagePanel=!1,this.isAddImage=!1,this.isPressedAddlmage=!1;const e=new FormData;e.append("file",this.file,this.file.name),console.log("IMG size - "+this.file.size),console.log("Image type_ "+this.file.type);const i=this.file.type;if("image/jpeg"===i||"image/jpg"===i||"image/png"===i||"image/gif"===i)if(console.log("Pildi formaat on OK"),this.file.size<=this.IMAGE_SIZE){const i=new FileReader,t=await N.A.create(e);if(t){await K.A.addImage(this.booking.id,t.imgCreated._id);const e={_id:t.imgCreated._id,blob:this.showImage};this.$emit("addImage",e,this.booking.id),console.log("ORDRED pikkus "+this.booking.ordered.length);let o=[];this.booking.ordered.forEach((e=>{console.log("CVCVCV "+e.user.username),o=o.concat(e.user.id)})),i.onload=e=>{const i=new Uint8Array(e.target.result);console.log("FILES IN UPLOAD.... "+this.files);const s={id:t.imgCreated._id,bytes:i};G.A.emit("display booking image",s,this.booking.id,o)},i.readAsArrayBuffer(this.files)}}else console.log("Pildi suurus peab olema väiksem kui 1 MB"),this.isAddImagePanel=!0,this.isPressedAddlmage=!0,this.wrong_SizeType_Message="Kuvan maximi koko on 3 MB.",setTimeout((()=>{this.wrong_SizeType_Message=null}),3e3);else console.log("Pildi formaat on FAKE"),this.wrong_SizeType_Message="Väärä formaati. Kuva pitäisi olla jpeg, jpg, png tai gif formaatissa!",setTimeout((()=>{this.wrong_SizeType_Message=null}),3e3)},async removeImg(e){this.images[e].blob||console.log("removed image is blob"),console.log("removable image id is "+this.images[e]._id),await K.A.removeImage(this.booking.id,this.images[e]._id),await N.A.remove(this.images[e]._id,this.booking.id);let i=[];this.booking.ordered.forEach((e=>{i=i.concat(e.user.id)})),G.A.emit("stop display booking image",this.images[e]._id,this.booking,i),this.$emit("removeImage",e),this.isEditPanel=!1},getDistance(){console.log("sss "+V.A.test())},selectUser(e){this.$emit("select",e)},noSelectUser(){this.$emit("noSelect")},onMessage(e,i){this.$emit("message",e,i)},handleJoinChatPanel(){console.log("Final info in result pressed "),this.$emit("joinChatPanel",this.room)},async pressAddFirstImage(){this.isAddFirstImage=!0,this.imageIndex=0},pressAdditionalImage(e){this.isAddImage=!0,this.imageIndex=this.images.length,console.log("Images index = "+this.imageIndex),this.isAddImage=!0},async uploadAdditionalImage(){this.isAdditionalImageSelected=!1,this.isAddImage=!1,this.value=null,console.log("Image index index "+this.imageIndex);const e=new FormData;this.isUploadImage=!0,this.isUploaded=!0,e.append("file",this.file,this.file.name);const i=await N.A.create(e);if(await K.A.addImage(this.booking.id,i.imgCreated._id),i){this.file=null;const e={_id:i.imgCreated._id,image:i.imgCreated.image,name:i.imgCreated.name,blob:this.showImage};this.$emit("addImage",e),this.isImageSelected=!1,this.isUploaded=!0}},pressedEditDescription(){this.isEditDescription=!0,console.log("Descripton: "+this.description)},saveEditedDescription(){this.isEditDescription=!1;const e={description:this.description};this.$emit("editDescription",this.description),K.A.editDescription(this.booking.id,e)},cancelEditDescription(){console.log("Is here something happening??")},providerGetBooking(e,i){console.log("Sended to user id... "+e),G.A.emit("accept provider",{id:e,booking:i})},async orderSuccess(e){if(console.log("Include offers? "+this.booking.isIncludeOffers),this.booking.isIncludeOffers){this.canselResult(),console.log("## bef "+this.booking.ordered.length),this.$emit("offer_confirmed",this.booking,e.id),console.log("## aft "+this.booking.ordered.length);const i=await $.A.getProvByProvId(e.id);console.log("Offer confirmation user id "+i.user.id);this.selectedProvider.id;await K.A.updateRecipient(this.booking.id,{status:"confirmed"});this.booking.id;console.log("Username here???? "+this.booking.user.username);let t=[],o=[],s=[],n=[];if(this.booking){t=this.booking.offers;const e=this.booking.ordered;for(let t in e)e[t].user.id!==i.user.id&&s.push(e[t]);for(let i in t)t[i].room!==this.room&&await j.A.removeBookingOffer(t[i].id,this.booking.id)}let l={};for(let e in t)console.log("Offer maker id heeeeeere "+t[e].provider.user.id),t[e].provider.user.id!==i.user.id?(o=o.concat(t[e]),console.log("eeeeeeeeeeeeeeeeeeeee "+t[e].provider.user.id),await $.A.removeProviderBooking(t[e].provider.id,this.booking.id),await K.A.removeProviderData(this.booking.id,t[e].provider.id)):l=t[e];console.log("offerMakers length "+o.length),s.forEach((e=>{o.some((i=>i.provider.id===e.id))||n.push(e)})),console.log("ampIDs "+s.map((e=>e.id))),console.log("REST OF PROS "+n.map((e=>e)));for(let e in n)console.log("Test id "+n[e].id),await $.A.removeProviderBooking(n[e].id,this.booking.id),await K.A.removeProviderData(this.booking.id,n[e].id);G.A.emit("confirm offer",i.user.id,this.booking,l),G.A.emit("deal done notification",o,n,this.booking,l)}else this.isProviderSelected=!1,console.log("No booking with offers here!")},async orderSuccess_standing(e){this.isProviderSelected=!1,console.log("Provider id "+e.id),console.log("Recpient id: "+this.booking.id),this.canselResult(),this.$emit("offer_confirmed",this.booking);this.selectedProvider.id,await K.A.updateRecipient(this.booking.id,{status:"confirmed"}),this.booking.id},async getProviderInfo(e,i,t){this.proSlides=[],this.offer=i,this.selectedProvider=e,this.booking.isIncludeOffers&&i.isNewOffer&&this.$emit("editBookingOfferStatus",i),e.reference.forEach((e=>{this.proSlides=[...this.proSlides,e]})),this.availability=t,this.isProviderSelected=!0;let o="",s="";this.chatUser&&(s=this.chatUser.username,o=e.yritys+s,this.room=o)},async roomToDb(e,i){await $.A.addRoom(e,i)},addFilter(){const e=document.getElementById("listOfProviders");e.addEventListener("change",(e=>{console.log("Filtered provider: "+e.target.value),this.$emit("filter_provider",e.target.value)}))},handleCanselFinal(e){this.isProviderSelected=e},canselResult(){this.$emit("cansel:result",!1)},async removeOfferedBookings(){!0===confirm("Oletko varmaa, että haluat poistaa tilauksen!?")?this.$emit("removeOfferedBooking",this.booking,this.booking.offers):console.log("You canceled!")}},async mounted(){const e=window.localStorage.getItem("loggedAppUser");if(e){const i=JSON.parse(e);this.chatUser=i}}}),Z=t(1241);const q=(0,Z.A)(J,[["render",X],["__scopeId","data-v-10ff520c"]]);var ee=q},1644:function(e,i,t){e.exports=t.p+"img/error.9510853e.png"}}]);
//# sourceMappingURL=443.3e8dd6eb.js.map