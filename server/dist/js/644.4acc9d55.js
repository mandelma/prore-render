"use strict";(self["webpackChunkprore_mongo"]=self["webpackChunkprore_mongo"]||[]).push([[644],{1840:function(e,t,o){var i=o(3396);let l="";const a=()=>{var e=new google.maps.LatLng(60.233093,24.7531362),t=new google.maps.LatLng(60.2767265,24.8575089),o=new google.maps.DistanceMatrixService;o.getDistanceMatrix({origins:[e],destinations:[t],travelMode:"DRIVING",unitSystem:google.maps.UnitSystem.METRIC,durationInTraffic:!0,avoidHighways:!1,avoidTolls:!1},n)},n=(e,t)=>{if(t===google.maps.DistanceMatrixStatus.OK&&"OK"===t)return console.log("Distance "+e.rows[0].elements[0].distance.text),l=e.rows[0].elements[0].distance.text,"aaaaaaaaaaaaa";console.log("Error:",t),alert(t)},s=()=>(console.log("Is it working??"+l),(0,i.Wm)("div",null,[(0,i.Uk)("Hiiii")])),r=()=>{var e=new google.maps.LatLng(60.233093,24.7531362),t=new google.maps.LatLng(60.2767265,24.8575089);return(google.maps.geometry.spherical.computeDistanceBetween(e,t)/1e3).toFixed(2)};t.Z={distance:a,test:s,theDist:r}},2283:function(e,t,o){o(4161)},3998:function(e,t){const o=[{label:"Hitsaaja",value:"1"},{label:"Putkimies",value:"2"},{label:"Sähkömies",value:"3"}],i=[{label:"Siivooja",value:"4"}],l=[{group:"Rakennus",options:o},{group:"Kiinteistöala",options:i}];t.Z=l},3644:function(e,t,o){o.r(t),o.d(t,{default:function(){return N}});var i=o(3396),l=o(7139),a=o(9242);const n={key:0,style:{"background-color":"white",padding:"10px",width:"70%",float:"right",border:"solid darkgrey"}},s={style:{display:"flex","justify-content":"right"}},r={style:{"font-size":"17px",width:"100%","text-align":"left"}},g=(0,i._)("td",null," Yritys: ",-1),c=(0,i._)("td",null," Y - tunnus: ",-1),d=(0,i._)("td",null," Työalue: ",-1),p=(0,i._)("tr",null,[(0,i._)("td",null," palaute: "),(0,i._)("td",null," Siia tulee palaute ")],-1),u=(0,i._)("tr",null,[(0,i._)("td",{colspan:"2"},[(0,i._)("h3",{style:{"text-align":"center"}},"Chat panel")])],-1),m={key:1,class:"ui large segment form"},h={style:{display:"flex","justify-content":"right"}},y={id:"test",style:{"background-color":"white"}},f={class:"field"},w=(0,i._)("option",{value:""},"Valitse ammattilainen",-1),v=["label"],k=["value"],_=["value"],L=(0,i._)("option",{disabled:"",value:"1"},"1 kilometriä ympärilläsi",-1),M=(0,i._)("option",{value:"10"},"10 km ympärilläsi",-1),P=(0,i._)("option",{value:"20"},"20 km ympärilläsi",-1),b=(0,i._)("option",{value:"30"},"30 km ympärilläsi",-1),C=(0,i._)("option",{value:"40"},"40 km ympärilläsi",-1),D=(0,i._)("option",{value:"50"},"50 km ympärilläsi",-1),B=(0,i._)("option",{value:"60"},"60 km ympärilläsi",-1),x=(0,i._)("option",{value:"70"},"70 km ympärilläsi",-1),I=(0,i._)("option",{value:"80"},"80 km ympärilläsi",-1),T=(0,i._)("option",{value:"90"},"90 km ympärilläsi",-1),z=(0,i._)("option",{value:"100"},"100 km ympärilläsi",-1),S=[L,M,P,b,C,D,B,x,I,T,z],O={key:2},A={style:{"background-color":"white",width:"40%",float:"right"}},U=(0,i._)("br",null,null,-1),E=(0,i._)("br",null,null,-1),F=(0,i._)("h3",{style:{"margin-top":"50px"}},"Kartta ladataan...",-1),j=(0,i._)("div",{class:"spinner-border",role:"status"},[(0,i._)("span",{class:"visually-hidden"},"Loading...")],-1),W=(0,i._)("div",{id:"map"},null,-1);function Z(e,t,o,L,M,P){const b=(0,i.up)("MDBBtnClose"),C=(0,i.up)("MDBInput"),D=(0,i.up)("MDBBtn"),B=(0,i.up)("MDBContainer");return(0,i.wg)(),(0,i.iD)("div",null,[(0,i.Wm)(B,{style:{position:"relative","z-index":"1",width:"70%","padding-top":"50px",opacity:"0.8"}},{default:(0,i.w5)((()=>[M.isTargetSelected?((0,i.wg)(),(0,i.iD)("div",n,[(0,i._)("div",s,[(0,i._)("p",{style:{"margin-right":"10px","margin-left":"auto","font-size":"15px",padding:"10px",color:"orangered"},onClick:t[0]||(t[0]=(...e)=>P.outFromMarkerPanel&&P.outFromMarkerPanel(...e))},"Valmis")]),(0,i._)("table",r,[(0,i._)("tbody",null,[(0,i._)("tr",null,[g,(0,i._)("td",null,(0,l.zw)(this.target.yritys),1)]),(0,i._)("tr",null,[c,(0,i._)("td",null,(0,l.zw)(this.target.ytunnus),1)]),(0,i._)("tr",null,[d,(0,i._)("td",null,(0,l.zw)(this.target.range),1)]),p,u])])])):!M.isTargetSelected&&M.isMainPanel?((0,i.wg)(),(0,i.iD)("div",m,[(0,i._)("div",h,[(0,i.Wm)(b,{style:{"margin-right":"0","margin-left":"auto",padding:"10px"},onClick:P.closeMainPanel},null,8,["onClick"])]),(0,i._)("div",y,[(0,i.Wm)(C,{label:"Anna osoitteesi",modelValue:M.address,"onUpdate:modelValue":t[1]||(t[1]=e=>M.address=e),id:"autocomplite",size:"lg",wrapperClass:"mb-4"},null,8,["modelValue"])]),(0,i._)("div",f,[(0,i.wy)((0,i._)("select",{id:"listOfProfessionals","onUpdate:modelValue":t[2]||(t[2]=e=>M.prof=e)},[w,((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(M.prodata,(e=>((0,i.wg)(),(0,i.iD)(i.HY,null,[e.group?((0,i.wg)(),(0,i.iD)("optgroup",{label:e.group,key:e.group},[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(e.options,(e=>((0,i.wg)(),(0,i.iD)("option",{value:e.label,key:e.label},(0,l.zw)(e.label),9,k)))),128))],8,v)):((0,i.wg)(),(0,i.iD)("option",{value:e,key:e.value},(0,l.zw)(e.label),9,_))],64)))),256))],512),[[a.bM,M.prof]])]),(0,i._)("div",{class:(0,l.C_)({hideDistSelectPanel:!M.isDistSelection})},[(0,i.wy)((0,i._)("select",{id:"distance","onUpdate:modelValue":t[3]||(t[3]=e=>M.distBtw=e),onClick:t[4]||(t[4]=(...t)=>e.filterByDistance&&e.filterByDistance(...t))},S,512),[[a.bM,M.distBtw]])],2),(0,i._)("h3",{class:(0,l.C_)({activeClients:!M.isActiveProffs})},(0,l.zw)(M.countOfSelectedProfessional+" "+M.professional)+" tarjoaa palvelua ",3),M.prof?((0,i.wg)(),(0,i.iD)("h3",{key:0,class:(0,l.C_)({noClients:M.isActiveProffs})}," Ei ammattilaisia vielä! ",2)):(0,i.kq)("",!0)])):((0,i.wg)(),(0,i.iD)("div",O,[(0,i._)("div",A,[(0,i.Wm)(D,{color:"dark",size:"lg",block:"",onClick:P.receive,style:{position:"relative","z-index":"1",opacity:"1.2"}},{default:(0,i.w5)((()=>[(0,i.Uk)(" Uusi tilaus ")])),_:1},8,["onClick"]),U,E,(0,i.Wm)(D,{color:"secondary",size:"lg",block:"",onClick:t[5]||(t[5]=e=>M.isMainPanel=!0),style:{position:"relative","z-index":"1",opacity:"1.2"}},{default:(0,i.w5)((()=>[(0,i.Uk)(" Paneeli ")])),_:1})])])),M.isMainPanel?((0,i.wg)(),(0,i.j4)(D,{key:3,color:"dark",size:"lg",block:"",onClick:P.receive,style:{position:"relative","z-index":"1",opacity:"1.2"}},{default:(0,i.w5)((()=>[(0,i.Uk)(" Tee uusi tilaus ")])),_:1},8,["onClick"])):(0,i.kq)("",!0),M.isMainPanel?((0,i.wg)(),(0,i.j4)(D,{key:4,color:"danger",size:"lg",block:"",onClick:t[6]||(t[6]=t=>e.$router.go(-1)),style:{position:"relative","z-index":"1",opacity:"1.0"}},{default:(0,i.w5)((()=>[(0,i.Uk)(" Poistu ")])),_:1})):(0,i.kq)("",!0)])),_:1}),F,j,W])}o(7658);var V=o(4161),R=(o(5800),o(9398)),H=o(4313),K=(o(1840),o(2283),o(3998)),Y={name:"recipient-public",props:{userIsProvider:Object,isProviderLoggedIn:Boolean},components:{MDBContainer:H.L5,MDBInput:H.u2,MDBBtn:H.$v,MDBBtnClose:H.Ok},data(){return{target:{},isTargetSelected:!1,isMainPanel:!0,prof:"",userId:null,providerId:null,address:null,myLat:null,mylng:null,countOfSelectedProfessional:0,isActiveProffs:!1,isDistSelection:!1,professional:"",currentProfession:"",distBtw:1,prodata:K.Z}},mounted(){const e=window.localStorage.getItem("loggedAppUser");if(e){const t=JSON.parse(e);this.userId=t.id}this.resizeMap();new google.maps.Marker({icon:"http://maps.google.com/mapfiles/ms/icons/green-dot.png"});this.userCurrentLocation();const t=document.getElementById("listOfProfessionals");t.addEventListener("change",(e=>{this.isDistSelection=!0,this.currentProfession=e.target.value,this.showClientLocationOnTheMap(e.target.value,this.distBtw)}));const o=document.getElementById("distance");o.addEventListener("change",(e=>{this.distBtw=parseFloat(e.target.value),this.isMainPanel=!1,this.showClientLocationOnTheMap(this.currentProfession,this.distBtw)}));const i=document.getElementById("autocomplite"),l={lat:50.064192,lng:-130.605469},a={north:l.lat+.1,south:l.lat-.1,east:l.lng+.1,west:l.lng-.1},n={bounds:a,componentRestrictions:{country:"fi"},fields:["address_components","geometry","icon","name","formatted_address"],strictBounds:!1},s=new google.maps.places.Autocomplete(i,n);s.addListener("place_changed",(()=>{let e=s.getPlace();this.myLat=e.geometry.location.lat(),this.myLng=e.geometry.location.lng(),this.getAddressFrom(e.geometry.location.lat(),e.geometry.location.lng()),this.address=e.formatted_address,console.log(e)}))},methods:{resizeMap(){var e=document.getElementById("map");e.style.height="100%",e.style.width="100%"},receive(){this.$router.push("/rf")},userCurrentLocation(){navigator.geolocation&&navigator.geolocation.getCurrentPosition((e=>{const{latitude:t,longitude:o}=e.coords;this.myLat=t,this.myLng=o,this.showUserLocationOnTheMap(t,o)}))},pinSymbol(e){return{path:"M 0,0 C -2,-20 -10,-22 -10,-30 A 10,10 0 1,1 10,-30 C 10,-22 2,-20 0,0 z",fillColor:e,fillOpacity:1,strokeColor:"#000",strokeWeight:2,scale:1}},showUserLocationOnTheMap(e,t){new google.maps.Map(document.getElementById("map"),{zoom:13,center:new google.maps.LatLng(e,t),mapTypeId:google.maps.MapTypeId.ROADMAP,accuracy:50})},getAddressFrom(e,t){V.Z.get("https://maps.googleapis.com/maps/api/geocode/json?latlng="+e+","+t+"&key=AIzaSyAQPLmTMlmSTp4spxPwvaJLnzYnkLmZ9zc").then((o=>{if(o.data.error_message)this.error=o.data.error_message,console.log(o.data.error_message);else{new google.maps.Map(document.getElementById("map"),{zoom:13,center:new google.maps.LatLng(e,t),mapTypeId:google.maps.MapTypeId.ROADMAP});console.log(o.data.results.results[0].formatted_address)}})).catch((e=>{this.error=e.message,console.log(e.message)}))},distanceBtw(e,t,o,i){var l=new google.maps.LatLng(e,t),a=new google.maps.LatLng(o,i);return(google.maps.geometry.spherical.computeDistanceBetween(l,a)/1e3).toFixed(2)},otherUserLocations(e,t,o){let i=new google.maps.Map(document.getElementById("map"),{zoom:9,center:new google.maps.LatLng(this.myLat,this.myLng),mapTypeId:google.maps.MapTypeId.ROADMAP});console.log("Users count: "+e.length),console.log("Current distance "+o);let l=0;if(e.length>0){for(let a=0;a<e.length;a++){this.myLat,this.myLng;e[a].profession.forEach((n=>{if(n===t){console.log("Pro "+n.yritys);e[a].latitude,e[a].longitude;if(console.log("Distance btw "+this.distanceBtw(this.myLat,this.myLng,e[a].latitude,e[a].longitude)),this.isActiveProffs=!0,this.distanceBtw(this.myLat,this.myLng,e[a].latitude,e[a].longitude)<=o){let t;l++,t=this.isTargetSelected?new google.maps.Marker({position:new google.maps.LatLng(e[a].latitude,e[a].longitude),accuracy:50,map:i,icon:this.pinSymbol("orange"),label:{color:"#f75959",fontWeight:"bold",fontSize:"14px",text:"TMI "+e[a].yritys}}):new google.maps.Marker({position:new google.maps.LatLng(e[a].latitude,e[a].longitude),accuracy:50,map:i}),this.target=e[a],window.myGlobalFunction=this.openMarker;const o=new google.maps.InfoWindow({content:""});google.maps.event.addListener(t,"click",(function(){o.open(i,t),o.setContent("<p>"+e[a].yritys+'</p><p style="color: red; " onclick="myGlobalFunction()">Tiedot</p>')}))}}}))}this.isActiveProffs=l>0,this.countOfSelectedProfessional=l,console.log("countxx "+l),this.identifyProfText()}},async openMarker(){console.log(this.target.user.firstName+" Marker is opened!!"),this.isTargetSelected=!0;const e=await R.Z.getProviders();null!==e&&this.otherUserLocations(e,this.currentProfession,this.distBtw)},async outFromMarkerPanel(){this.isTargetSelected=!1;const e=await R.Z.getProviders();null!==e&&this.otherUserLocations(e,this.currentProfession,this.distBtw)},closeMainPanel(){this.isMainPanel=!1,console.log("Close main panel")},renderClients(e){console.log("Event value "+e.target.value),e.target.value&&this.showClientLocationOnTheMap(e.target.value),this.prof=e.target.value,e.target.value=""},async showClientLocationOnTheMap(e,t){console.log("Current distance herexx  "+t);const o=await R.Z.getProviders();null!==o&&this.otherUserLocations(o,e,t)},identifyProfText(){this.countOfSelectedProfessional>1?this.professional="ammattilaista":this.professional="ammattilainen"}}},q=o(89);const G=(0,q.Z)(Y,[["render",Z]]);var N=G}}]);
//# sourceMappingURL=644.4acc9d55.js.map