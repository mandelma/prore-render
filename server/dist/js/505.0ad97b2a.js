"use strict";(self["webpackChunkprore_mongo"]=self["webpackChunkprore_mongo"]||[]).push([[505],{505:function(t,e,a){a.r(e),a.d(e,{default:function(){return M}});var i=a(6768),n=a(4232);const s={style:{display:"flex","justify-content":"right",padding:"13px"}},o={class:"container mt-5"},r={class:"text-center mb-4"},l={class:"starContainer"},g=["onClick"],u=["disabled"];function d(t,e,a,d,c,h){const m=(0,i.g2)("MDBBtnClose"),p=(0,i.g2)("warning-message"),v=(0,i.g2)("error-message"),k=(0,i.g2)("MDBTextarea"),b=(0,i.g2)("MDBCardBody"),f=(0,i.g2)("MDBCard"),C=(0,i.g2)("MDBContainer");return(0,i.uX)(),(0,i.Wv)(C,{style:{"padding-top":"50px"}},{default:(0,i.k6)((()=>[(0,i.Lk)("div",s,[(0,i.bF)(m,{white:"",onClick:h.backFromFeedbackClient},null,8,["onClick"])]),(0,i.bF)(p,{message:c.rateWarning},null,8,["message"]),(0,i.bF)(v,{message:c.ratingError},null,8,["message"]),(0,i.Lk)("div",o,[(0,i.bF)(f,{text:"white",bg:"dark",class:"p-4"},{default:(0,i.k6)((()=>[(0,i.bF)(b,null,{default:(0,i.k6)((()=>[(0,i.Lk)("h3",r,(0,n.v_)(a.customer.company)+" odottaa palautetta tarjoamastaan palvelusta!",1),(0,i.Lk)("div",l,[((0,i.uX)(),(0,i.CE)(i.FK,null,(0,i.pI)(5,(t=>(0,i.Lk)("span",{key:t,onClick:e=>c.rating=t,style:{"font-size":"33px",cursor:"pointer"},class:(0,n.C4)(t<=c.rating?"text-yellow":"text-gray")},"★",10,g))),64))]),c.rating>0?((0,i.uX)(),(0,i.Wv)(k,{key:0,white:"",modelValue:c.feedbackContent,"onUpdate:modelValue":e[0]||(e[0]=t=>c.feedbackContent=t),type:"textarea",label:"Anna haluttaessa arvostelua!",rows:"3",class:"mb-3"},null,8,["modelValue"])):(0,i.Q3)("",!0),(0,i.Lk)("button",{class:"mt-4 w-full bg-blue-500 text-white py-2 rounded-md disabled:opacity-50",onClick:e[1]||(e[1]=(...t)=>h.confirmFeedback&&h.confirmFeedback(...t)),disabled:""===c.feedbackContent&&0===c.rating}," Lähettää palaute ",8,u)])),_:1})])),_:1}),e[3]||(e[3]=(0,i.Lk)("br",null,null,-1)),(0,i.Lk)("p",{style:{float:"right",color:"#e4548e",cursor:"pointer"},onClick:e[2]||(e[2]=(...t)=>h.noRatingToConfirm&&h.noRatingToConfirm(...t))},"En halua antaa palautetta"),e[4]||(e[4]=(0,i.Lk)("br",null,null,-1)),e[5]||(e[5]=(0,i.Lk)("br",null,null,-1))])])),_:1})}a(4114),a(8111),a(116);var c=a(5846),h=a(6765);const m=({message:t})=>null===t?null:(0,i.bF)("div",{className:"warning"},[t]);var p=m,v=a(4482),k=(a(407),a(1769)),b=a(3198),f=a(2815),C={name:"Feedback",props:{customer:Object},components:{monthConverter:h.A,warningMessage:p,errorMessage:v.A,MDBContainer:c.Dj,MDBBtn:c.al,MDBRow:c.gU,MDBCol:c.m6,MDBIcon:c.$u,MDBBadge:c.nf,MDBTextarea:c.QP,MDBTable:c.EU,MDBBtnClose:c.uR,MDBCard:c.kv,MDBCardBody:c.ee,MDBInput:c.gk,MDBRadio:c.Zq},data(){return{author:null,fbc:{},isRatingGiven:!1,isReview:!1,ratedTimes:0,isRatedPos:!1,isRatedMinus:!1,positiveRating:0,negativeRating:0,rateWarning:null,ratingError:null,feedbackContent:"",rating:0}},methods:{reload(){location.reload()},async getClient(t){const e=await b.A.getClientHistory(),a=e.find((t=>"no rated"===t.status));this.positiveRating=a.rating.positive,this.negativeRating=a.rating.negative,this.fbc=a},ratePlus(){this.isRated=!0,console.log("Pos rating before "+this.positiveRating),this.isRatedMinus?(console.log("Not, only one time is allowed!"),this.rateWarning="Arvostella saa vain kerran!",setTimeout((()=>{this.rateWarning=null}),3e3)):(this.ratedTimes+=1,1===this.ratedTimes?(this.positiveRating=this.positiveRating+1,console.log("Pos rating after "+this.positiveRating),this.isRatingGiven=!0):(console.log("Not, only one time is allowed!"),this.rateWarning="Arvostella saa vain kerran!",setTimeout((()=>{this.rateWarning=null}),3e3)),this.isRatedPlus=!0,this.isRatedMinus=!1)},rateMinus(){this.isRated=!0,this.isRatedPlus?(this.rateWarning="Arvostella saa vain kerran, negatiivisen tai positiivisen!",setTimeout((()=>{this.rateWarning=null}),3e3)):(this.ratedTimes+=1,1===this.ratedTimes?(this.negativeRating=this.negativeRating+1,this.isRatingGiven=!0):(this.rateWarning="Arvostella saa vain kerran, negatiivisen tai positiivisen!",setTimeout((()=>{this.rateWarning=null}),3e3)),this.isRatedPlus=!1,this.isRatedMinus=!0)},async confirmFeedback(){const t=this.customer.proID,e=new Date,a=(0,f.Ay)(e,"dd-mm-yyyy,  HH:MM"),i={pos:a+": ( "+this.author.username+" ) "+this.feedbackContent},n=(this.author.username,this.feedbackContent,{positive:this.rating,negative:this.negativeRating});this.feedbackContent.length>0&&(await k.A.addPositiveFeedback(t,i),this.feedbackContent=""),await k.A.setPositiveRating(t,{star:this.rating}),this.$emit("isRated",this.customer.proID,"rated",this.customer.company,n),this.$router.go(-1)},noRatingToConfirm(){this.$emit("isRated",this.customer.proID,"no-rating",this.customer.company),this.$router.go(-1)},backFromFeedbackClient(){this.$router.go(-1)}},mounted(){const t=window.localStorage.getItem("loggedAppUser");if(t){const e=JSON.parse(t);this.author=e,this.positiveRating=this.customer.rating.positive,this.negativeRating=this.customer.rating.negative}else this.$router.push("/")}},R=a(1241);const y=(0,R.A)(C,[["render",d]]);var M=y},1644:function(t,e,a){t.exports=a.p+"img/error.9510853e.png"},4482:function(t,e,a){var i=a(6768);const n=({message:t})=>null===t?null:(0,i.bF)("div",{className:"error"},[t,(0,i.bF)("img",{className:"errorImg",alt:"error",src:a(1644)},null)]);e.A=n}}]);
//# sourceMappingURL=505.0ad97b2a.js.map